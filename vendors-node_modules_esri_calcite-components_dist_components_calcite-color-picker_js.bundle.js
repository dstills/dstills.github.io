"use strict";
(self["webpackChunksynview"] = self["webpackChunksynview"] || []).push([["vendors-node_modules_esri_calcite-components_dist_components_calcite-color-picker_js"],{

/***/ "./node_modules/@esri/calcite-components/dist/components/calcite-color-picker.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/components/calcite-color-picker.js ***!
  \***************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   CalciteColorPicker: () => (/* binding */ CalciteColorPicker),
/* harmony export */   defineCustomElement: () => (/* binding */ defineCustomElement)
/* harmony export */ });
/* harmony import */ var _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! @stencil/core/internal/client/index.js */ "./node_modules/@stencil/core/internal/client/index.js");
/* harmony import */ var _index2_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index2.js */ "./node_modules/@esri/calcite-components/dist/components/index2.js");
/* harmony import */ var _dom_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./dom.js */ "./node_modules/@esri/calcite-components/dist/components/dom.js");
/* harmony import */ var _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./color-picker-hex-input.js */ "./node_modules/@esri/calcite-components/dist/components/color-picker-hex-input.js");
/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils.js */ "./node_modules/@esri/calcite-components/dist/components/utils.js");
/* harmony import */ var _interactive_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./interactive.js */ "./node_modules/@esri/calcite-components/dist/components/interactive.js");
/* harmony import */ var _key_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./key.js */ "./node_modules/@esri/calcite-components/dist/components/key.js");
/* harmony import */ var _loadable_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./loadable.js */ "./node_modules/@esri/calcite-components/dist/components/loadable.js");
/* harmony import */ var _locale_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./locale.js */ "./node_modules/@esri/calcite-components/dist/components/locale.js");
/* harmony import */ var _math_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./math.js */ "./node_modules/@esri/calcite-components/dist/components/math.js");
/* harmony import */ var _t9n_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./t9n.js */ "./node_modules/@esri/calcite-components/dist/components/t9n.js");
/* harmony import */ var _button_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./button.js */ "./node_modules/@esri/calcite-components/dist/components/button.js");
/* harmony import */ var _color_picker_swatch_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./color-picker-swatch.js */ "./node_modules/@esri/calcite-components/dist/components/color-picker-swatch.js");
/* harmony import */ var _icon_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./icon.js */ "./node_modules/@esri/calcite-components/dist/components/icon.js");
/* harmony import */ var _input_number_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./input-number.js */ "./node_modules/@esri/calcite-components/dist/components/input-number.js");
/* harmony import */ var _input_text_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./input-text.js */ "./node_modules/@esri/calcite-components/dist/components/input-text.js");
/* harmony import */ var _loader_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./loader.js */ "./node_modules/@esri/calcite-components/dist/components/loader.js");
/* harmony import */ var _progress_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./progress.js */ "./node_modules/@esri/calcite-components/dist/components/progress.js");
/* harmony import */ var _tab_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./tab.js */ "./node_modules/@esri/calcite-components/dist/components/tab.js");
/* harmony import */ var _tab_nav_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./tab-nav.js */ "./node_modules/@esri/calcite-components/dist/components/tab-nav.js");
/* harmony import */ var _tab_title_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./tab-title.js */ "./node_modules/@esri/calcite-components/dist/components/tab-title.js");
/* harmony import */ var _tabs_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./tabs.js */ "./node_modules/@esri/calcite-components/dist/components/tabs.js");
/* harmony import */ var _throttle_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./throttle.js */ "./node_modules/@esri/calcite-components/dist/components/throttle.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v1.7.0
 */
























const colorPickerCss = ":host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-ui-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:inline-block;font-size:var(--calcite-font-size--2);line-height:1rem;font-weight:var(--calcite-font-weight-normal)}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}:host([scale=s]){--calcite-color-picker-spacing:8px}:host([scale=s]) .container{inline-size:160px}:host([scale=s]) .saved-colors{gap:0.25rem;grid-template-columns:repeat(auto-fill, 20px)}:host([scale=m]){--calcite-color-picker-spacing:12px}:host([scale=m]) .container{inline-size:272px}:host([scale=l]){--calcite-color-picker-spacing:16px;font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=l]) .container{inline-size:464px}:host([scale=l]) .section:first-of-type{padding-block-start:var(--calcite-color-picker-spacing)}:host([scale=l]) .saved-colors{grid-template-columns:repeat(auto-fill, 32px)}:host([scale=l]) .control-section{flex-wrap:nowrap;align-items:baseline;flex-wrap:wrap}:host([scale=l]) .color-hex-options{display:flex;flex-shrink:1;flex-direction:column;justify-content:space-around}:host([scale=l]) .color-mode-container{flex-shrink:3}.container{background-color:var(--calcite-ui-foreground-1);display:inline-block;border:1px solid var(--calcite-ui-border-1)}.control-and-scope{position:relative;display:flex;cursor:pointer;touch-action:none}.scope{pointer-events:none;position:absolute;z-index:var(--calcite-app-z-index);block-size:1px;inline-size:1px;border-radius:9999px;background-color:transparent;font-size:var(--calcite-font-size--1);outline-color:transparent}.scope:focus{outline:2px solid var(--calcite-ui-focus-color, var(--calcite-ui-brand));outline-offset:calc(\n            2px *\n            calc(\n              1 -\n              2 * clamp(\n                0,\n                var(--calcite-ui-focus-offset-invert),\n                1\n              )\n            )\n          );outline-offset:11px}.hex-and-channels-group{inline-size:100%}.hex-and-channels-group,.control-section{display:flex;flex-direction:row;flex-wrap:wrap}.section{padding-block:0 var(--calcite-color-picker-spacing);padding-inline:var(--calcite-color-picker-spacing)}.section:first-of-type{padding-block-start:var(--calcite-color-picker-spacing)}.sliders{display:flex;flex-direction:column;justify-content:space-between;margin-inline-start:var(--calcite-color-picker-spacing)}.preview-and-sliders{display:flex;align-items:center;padding:var(--calcite-color-picker-spacing)}.color-hex-options,.section--split{flex-grow:1}.header{display:flex;align-items:center;justify-content:space-between;color:var(--calcite-ui-text-1)}.color-mode-container{padding-block-start:var(--calcite-color-picker-spacing)}.channels{display:flex;row-gap:0.125rem}.channel[data-channel-index=\"3\"]{inline-size:159px}:host([scale=s]) .channels{flex-wrap:wrap}:host([scale=s]) .channel{flex-basis:30%;flex-grow:1}:host([scale=s]) .channel[data-channel-index=\"3\"]{inline-size:unset;margin-inline-start:unset}:host([scale=l]) .channel[data-channel-index=\"3\"]{inline-size:131px}.saved-colors{display:grid;gap:0.5rem;padding-block-start:var(--calcite-color-picker-spacing);grid-template-columns:repeat(auto-fill, 24px)}.saved-colors-buttons{display:flex}.saved-color{outline-offset:0;outline-color:transparent;cursor:pointer}.saved-color:focus{outline:2px solid var(--calcite-ui-brand);outline-offset:2px}.saved-color:hover{transition:outline-color var(--calcite-internal-animation-timing-fast) ease-in-out;outline:2px solid var(--calcite-ui-border-2);outline-offset:2px}:host([hidden]){display:none}[hidden]{display:none}";

const throttleFor60FpsInMs = 16;
const ColorPicker = /*@__PURE__*/ (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.proxyCustomElement)(class extends _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.HTMLElement {
  constructor() {
    super();
    this.__registerHost();
    this.__attachShadow();
    this.calciteColorPickerChange = (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.createEvent)(this, "calciteColorPickerChange", 6);
    this.calciteColorPickerInput = (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.createEvent)(this, "calciteColorPickerInput", 6);
    this.internalColorUpdateContext = null;
    this.mode = _utils_js__WEBPACK_IMPORTED_MODULE_3__.C.HEX;
    this.shiftKeyChannelAdjustment = 0;
    this.handleTabActivate = (event) => {
      this.channelMode = event.currentTarget.getAttribute("data-color-mode");
      this.updateChannelsFromColor(this.color);
    };
    this.handleColorFieldScopeKeyDown = (event) => {
      const { key } = event;
      const arrowKeyToXYOffset = {
        ArrowUp: { x: 0, y: -10 },
        ArrowRight: { x: 10, y: 0 },
        ArrowDown: { x: 0, y: 10 },
        ArrowLeft: { x: -10, y: 0 },
      };
      if (arrowKeyToXYOffset[key]) {
        event.preventDefault();
        this.scopeOrientation = key === "ArrowDown" || key === "ArrowUp" ? "vertical" : "horizontal";
        this.captureColorFieldColor(this.colorFieldScopeLeft + arrowKeyToXYOffset[key].x || 0, this.colorFieldScopeTop + arrowKeyToXYOffset[key].y || 0, false);
      }
    };
    this.handleHueScopeKeyDown = (event) => {
      const modifier = event.shiftKey ? 10 : 1;
      const { key } = event;
      const arrowKeyToXOffset = {
        ArrowUp: 1,
        ArrowRight: 1,
        ArrowDown: -1,
        ArrowLeft: -1,
      };
      if (arrowKeyToXOffset[key]) {
        event.preventDefault();
        const delta = arrowKeyToXOffset[key] * modifier;
        const hue = this.baseColorFieldColor.hue();
        const color = this.baseColorFieldColor.hue(hue + delta);
        this.internalColorSet(color, false);
      }
    };
    this.handleHexInputChange = (event) => {
      event.stopPropagation();
      const { allowEmpty, color: color$1 } = this;
      const input = event.target;
      const hex = input.value;
      if (allowEmpty && !hex) {
        this.internalColorSet(null);
        return;
      }
      const normalizedHex = color$1 && (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.n)((0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.h)(color$1, (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.a)(this.mode)));
      if (hex !== normalizedHex) {
        this.internalColorSet((0,_index2_js__WEBPACK_IMPORTED_MODULE_0__.c)(hex));
      }
    };
    this.handleSavedColorSelect = (event) => {
      const swatch = event.currentTarget;
      this.internalColorSet((0,_index2_js__WEBPACK_IMPORTED_MODULE_0__.c)(swatch.color));
    };
    this.handleChannelInput = (event) => {
      const input = event.currentTarget;
      const channelIndex = Number(input.getAttribute("data-channel-index"));
      const isAlphaChannel = channelIndex === 3;
      const limit = isAlphaChannel
        ? _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.O.max
        : this.channelMode === "rgb"
          ? _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.R[Object.keys(_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.R)[channelIndex]]
          : _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.H[Object.keys(_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.H)[channelIndex]];
      let inputValue;
      if (this.allowEmpty && !input.value) {
        inputValue = "";
      }
      else {
        const value = Number(input.value);
        const adjustedValue = value + this.shiftKeyChannelAdjustment;
        const clamped = (0,_math_js__WEBPACK_IMPORTED_MODULE_8__.c)(adjustedValue, 0, limit);
        inputValue = clamped.toString();
      }
      input.value = inputValue;
    };
    this.handleChannelChange = (event) => {
      const input = event.currentTarget;
      const channelIndex = Number(input.getAttribute("data-channel-index"));
      const channels = [...this.channels];
      const shouldClearChannels = this.allowEmpty && !input.value;
      if (shouldClearChannels) {
        this.channels = [null, null, null, null];
        this.internalColorSet(null);
        return;
      }
      const isAlphaChannel = channelIndex === 3;
      const value = Number(input.value);
      channels[channelIndex] = isAlphaChannel ? (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.o)(value) : value;
      this.updateColorFromChannels(channels);
    };
    this.handleSavedColorKeyDown = (event) => {
      if ((0,_key_js__WEBPACK_IMPORTED_MODULE_5__.i)(event.key)) {
        event.preventDefault();
        this.handleSavedColorSelect(event);
      }
    };
    this.handleColorFieldPointerDown = (event) => {
      if (!(0,_dom_js__WEBPACK_IMPORTED_MODULE_1__.j)(event)) {
        return;
      }
      const { offsetX, offsetY } = event;
      document.addEventListener("pointermove", this.globalPointerMoveHandler);
      document.addEventListener("pointerup", this.globalPointerUpHandler, { once: true });
      this.activeCanvasInfo = {
        context: this.colorFieldRenderingContext,
        bounds: this.colorFieldRenderingContext.canvas.getBoundingClientRect(),
      };
      this.captureColorFieldColor(offsetX, offsetY);
      this.colorFieldScopeNode.focus();
    };
    this.handleHueSliderPointerDown = (event) => {
      if (!(0,_dom_js__WEBPACK_IMPORTED_MODULE_1__.j)(event)) {
        return;
      }
      const { offsetX } = event;
      document.addEventListener("pointermove", this.globalPointerMoveHandler);
      document.addEventListener("pointerup", this.globalPointerUpHandler, { once: true });
      this.activeCanvasInfo = {
        context: this.hueSliderRenderingContext,
        bounds: this.hueSliderRenderingContext.canvas.getBoundingClientRect(),
      };
      this.captureHueSliderColor(offsetX);
      this.hueScopeNode.focus();
    };
    this.handleOpacitySliderPointerDown = (event) => {
      if (!(0,_dom_js__WEBPACK_IMPORTED_MODULE_1__.j)(event)) {
        return;
      }
      const { offsetX } = event;
      document.addEventListener("pointermove", this.globalPointerMoveHandler);
      document.addEventListener("pointerup", this.globalPointerUpHandler, { once: true });
      this.activeCanvasInfo = {
        context: this.opacitySliderRenderingContext,
        bounds: this.opacitySliderRenderingContext.canvas.getBoundingClientRect(),
      };
      this.captureOpacitySliderValue(offsetX);
      this.opacityScopeNode.focus();
    };
    this.globalPointerUpHandler = (event) => {
      if (!(0,_dom_js__WEBPACK_IMPORTED_MODULE_1__.j)(event)) {
        return;
      }
      const previouslyDragging = this.activeCanvasInfo;
      this.activeCanvasInfo = null;
      this.drawColorControls();
      if (previouslyDragging) {
        this.calciteColorPickerChange.emit();
      }
    };
    this.globalPointerMoveHandler = (event) => {
      const { activeCanvasInfo, el } = this;
      if (!el.isConnected || !activeCanvasInfo) {
        return;
      }
      const { context, bounds } = activeCanvasInfo;
      let samplingX;
      let samplingY;
      const { clientX, clientY } = event;
      if (context.canvas.matches(":hover")) {
        samplingX = clientX - bounds.x;
        samplingY = clientY - bounds.y;
      }
      else {
        // snap x and y to the closest edge
        if (clientX < bounds.x + bounds.width && clientX > bounds.x) {
          samplingX = clientX - bounds.x;
        }
        else if (clientX < bounds.x) {
          samplingX = 0;
        }
        else {
          samplingX = bounds.width;
        }
        if (clientY < bounds.y + bounds.height && clientY > bounds.y) {
          samplingY = clientY - bounds.y;
        }
        else if (clientY < bounds.y) {
          samplingY = 0;
        }
        else {
          samplingY = bounds.height;
        }
      }
      if (context === this.colorFieldRenderingContext) {
        this.captureColorFieldColor(samplingX, samplingY, false);
      }
      else if (context === this.hueSliderRenderingContext) {
        this.captureHueSliderColor(samplingX);
      }
      else if (context === this.opacitySliderRenderingContext) {
        this.captureOpacitySliderValue(samplingX);
      }
    };
    this.storeColorFieldScope = (node) => {
      this.colorFieldScopeNode = node;
    };
    this.storeHueScope = (node) => {
      this.hueScopeNode = node;
    };
    this.renderChannelsTabTitle = (channelMode) => {
      const { channelMode: activeChannelMode, messages } = this;
      const selected = channelMode === activeChannelMode;
      const label = channelMode === "rgb" ? messages.rgb : messages.hsv;
      return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("calcite-tab-title", { class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.colorMode, "data-color-mode": channelMode, key: channelMode, onCalciteTabsActivate: this.handleTabActivate, selected: selected }, label));
    };
    this.renderChannelsTab = (channelMode) => {
      const { allowEmpty, channelMode: activeChannelMode, channels, messages, alphaChannel } = this;
      const selected = channelMode === activeChannelMode;
      const isRgb = channelMode === "rgb";
      const channelAriaLabels = isRgb
        ? [messages.red, messages.green, messages.blue]
        : [messages.hue, messages.saturation, messages.value];
      const direction = (0,_dom_js__WEBPACK_IMPORTED_MODULE_1__.b)(this.el);
      const channelsToRender = alphaChannel ? channels : channels.slice(0, 3);
      return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("calcite-tab", { class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.control, key: channelMode, selected: selected }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("div", { class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.channels, dir: "ltr" }, channelsToRender.map((channelValue, index) => {
        const isAlphaChannel = index === 3;
        if (isAlphaChannel) {
          channelValue =
            allowEmpty && !channelValue ? channelValue : (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.b)(channelValue);
        }
        /* the channel container is ltr, so we apply the host's direction */
        return this.renderChannel(channelValue, index, channelAriaLabels[index], direction, isAlphaChannel ? "%" : "");
      }))));
    };
    this.renderChannel = (value, index, ariaLabel, direction, suffix) => {
      return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("calcite-input-number", { class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.channel, "data-channel-index": index, dir: direction, key: index, label: ariaLabel, lang: this.effectiveLocale, numberButtonType: "none", numberingSystem: this.numberingSystem, onCalciteInputNumberChange: this.handleChannelChange, onCalciteInputNumberInput: this.handleChannelInput, onKeyDown: this.handleKeyDown, scale: this.scale === "l" ? "m" : "s",
        // workaround to ensure input borders overlap as desired
        // this is because the build transforms margin-left to its
        // logical-prop, which is undesired as channels are always ltr
        style: {
          marginLeft: index > 0 && !(this.scale === "s" && this.alphaChannel && index === 3) ? "-1px" : "",
        }, suffixText: suffix, value: value?.toString() }));
    };
    this.deleteColor = () => {
      const colorToDelete = (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.h)(this.color, this.alphaChannel);
      const inStorage = this.savedColors.indexOf(colorToDelete) > -1;
      if (!inStorage) {
        return;
      }
      const savedColors = this.savedColors.filter((color) => color !== colorToDelete);
      this.savedColors = savedColors;
      const storageKey = `${_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.c}${this.storageId}`;
      if (this.storageId) {
        localStorage.setItem(storageKey, JSON.stringify(savedColors));
      }
    };
    this.saveColor = () => {
      const colorToSave = (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.h)(this.color, this.alphaChannel);
      const alreadySaved = this.savedColors.indexOf(colorToSave) > -1;
      if (alreadySaved) {
        return;
      }
      const savedColors = [...this.savedColors, colorToSave];
      this.savedColors = savedColors;
      const storageKey = `${_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.c}${this.storageId}`;
      if (this.storageId) {
        localStorage.setItem(storageKey, JSON.stringify(savedColors));
      }
    };
    this.drawColorControls = (0,_throttle_js__WEBPACK_IMPORTED_MODULE_21__.t)((type = "all") => {
      if ((type === "all" || type === "color-field") && this.colorFieldRenderingContext) {
        this.drawColorField();
      }
      if ((type === "all" || type === "hue-slider") && this.hueSliderRenderingContext) {
        this.drawHueSlider();
      }
      if (this.alphaChannel &&
        (type === "all" || type === "opacity-slider") &&
        this.opacitySliderRenderingContext) {
        this.drawOpacitySlider();
      }
    }, throttleFor60FpsInMs);
    this.captureColorFieldColor = (x, y, skipEqual = true) => {
      const { dimensions: { colorField: { height, width }, }, } = this;
      const saturation = Math.round((_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.H.s / width) * x);
      const value = Math.round((_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.H.v / height) * (height - y));
      this.internalColorSet(this.baseColorFieldColor.hsv().saturationv(saturation).value(value), skipEqual);
    };
    this.initColorField = (canvas) => {
      this.colorFieldRenderingContext = canvas.getContext("2d");
      this.updateCanvasSize("color-field");
      this.drawColorControls();
    };
    this.initHueSlider = (canvas) => {
      this.hueSliderRenderingContext = canvas.getContext("2d");
      this.updateCanvasSize("hue-slider");
      this.drawHueSlider();
    };
    this.initOpacitySlider = (canvas) => {
      if (!canvas) {
        return;
      }
      this.opacitySliderRenderingContext = canvas.getContext("2d");
      this.updateCanvasSize("opacity-slider");
      this.drawOpacitySlider();
    };
    this.storeOpacityScope = (node) => {
      this.opacityScopeNode = node;
    };
    this.handleOpacityScopeKeyDown = (event) => {
      const modifier = event.shiftKey ? 10 : 1;
      const { key } = event;
      const arrowKeyToXOffset = {
        ArrowUp: 0.01,
        ArrowRight: 0.01,
        ArrowDown: -0.01,
        ArrowLeft: -0.01,
      };
      if (arrowKeyToXOffset[key]) {
        event.preventDefault();
        const delta = arrowKeyToXOffset[key] * modifier;
        const alpha = this.baseColorFieldColor.alpha();
        const color = this.baseColorFieldColor.alpha(alpha + delta);
        this.internalColorSet(color, false);
      }
    };
    this.allowEmpty = false;
    this.alphaChannel = false;
    this.channelsDisabled = false;
    this.color = _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.D;
    this.disabled = false;
    this.format = "auto";
    this.hideChannels = false;
    this.hexDisabled = false;
    this.hideHex = false;
    this.hideSaved = false;
    this.savedDisabled = false;
    this.scale = "m";
    this.storageId = undefined;
    this.messageOverrides = undefined;
    this.numberingSystem = undefined;
    this.value = (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.n)((0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.h)(_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.D, this.alphaChannel));
    this.defaultMessages = undefined;
    this.channelMode = "rgb";
    this.channels = this.toChannels(_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.D);
    this.dimensions = _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.a.m;
    this.effectiveLocale = "";
    this.messages = undefined;
    this.savedColors = [];
    this.colorFieldScopeTop = undefined;
    this.colorFieldScopeLeft = undefined;
    this.hueScopeLeft = undefined;
    this.opacityScopeLeft = undefined;
    this.scopeOrientation = undefined;
  }
  handleAlphaChannelChange(alphaChannel) {
    const { format } = this;
    if (alphaChannel && format !== "auto" && !(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.a)(format)) {
      console.warn(`ignoring alphaChannel as the current format (${format}) does not support alpha`);
      this.alphaChannel = false;
    }
  }
  handleColorChange(color, oldColor) {
    this.drawColorControls();
    this.updateChannelsFromColor(color);
    this.previousColor = oldColor;
  }
  handleFormatOrAlphaChannelChange() {
    this.setMode(this.format);
    this.internalColorSet(this.color, false, "internal");
  }
  handleScaleChange(scale = "m") {
    this.updateDimensions(scale);
    this.updateCanvasSize("all");
    this.drawColorControls();
  }
  onMessagesChange() {
    /* wired up by t9n util */
  }
  handleValueChange(value, oldValue) {
    const { allowEmpty, format } = this;
    const checkMode = !allowEmpty || value;
    let modeChanged = false;
    if (checkMode) {
      const nextMode = (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.p)(value);
      if (!nextMode || (format !== "auto" && nextMode !== format)) {
        this.showIncompatibleColorWarning(value, format);
        this.value = oldValue;
        return;
      }
      modeChanged = this.mode !== nextMode;
      this.setMode(nextMode, this.internalColorUpdateContext === null);
    }
    const dragging = this.activeCanvasInfo;
    if (this.internalColorUpdateContext === "initial") {
      return;
    }
    if (this.internalColorUpdateContext === "user-interaction") {
      this.calciteColorPickerInput.emit();
      if (!dragging) {
        this.calciteColorPickerChange.emit();
      }
      return;
    }
    const color$1 = allowEmpty && !value
      ? null
      : (0,_index2_js__WEBPACK_IMPORTED_MODULE_0__.c)(value != null && typeof value === "object" && (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.a)(this.mode)
        ? (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.e)(value)
        : value);
    const colorChanged = !(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.c)(color$1, this.color);
    if (modeChanged || colorChanged) {
      this.internalColorSet(color$1, this.alphaChannel && !(this.mode.endsWith("a") || this.mode.endsWith("a-css")), "internal");
    }
  }
  get baseColorFieldColor() {
    return this.color || this.previousColor || _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.D;
  }
  effectiveLocaleChange() {
    (0,_t9n_js__WEBPACK_IMPORTED_MODULE_9__.u)(this, this.effectiveLocale);
  }
  // using @Listen as a workaround for VDOM listener not firing
  handleChannelKeyUpOrDown(event) {
    this.shiftKeyChannelAdjustment = 0;
    const { key } = event;
    if ((key !== "ArrowUp" && key !== "ArrowDown") ||
      !event.composedPath().some((node) => node.classList?.contains(_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.channel))) {
      return;
    }
    const { shiftKey } = event;
    event.preventDefault();
    if (!this.color) {
      this.internalColorSet(this.previousColor);
      event.stopPropagation();
      return;
    }
    // this gets applied to the input's up/down arrow increment/decrement
    const complementaryBump = 9;
    this.shiftKeyChannelAdjustment =
      key === "ArrowUp" && shiftKey
        ? complementaryBump
        : key === "ArrowDown" && shiftKey
          ? -complementaryBump
          : 0;
  }
  //--------------------------------------------------------------------------
  //
  //  Public Methods
  //
  //--------------------------------------------------------------------------
  /** Sets focus on the component's first focusable element. */
  async setFocus() {
    await (0,_loadable_js__WEBPACK_IMPORTED_MODULE_6__.c)(this);
    this.el.focus();
  }
  //--------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  //--------------------------------------------------------------------------
  async componentWillLoad() {
    (0,_loadable_js__WEBPACK_IMPORTED_MODULE_6__.a)(this);
    const { allowEmpty, color: color$1, format, value } = this;
    const willSetNoColor = allowEmpty && !value;
    const parsedMode = (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.p)(value);
    const valueIsCompatible = willSetNoColor || (format === "auto" && parsedMode) || format === parsedMode;
    const initialColor = willSetNoColor ? null : valueIsCompatible ? (0,_index2_js__WEBPACK_IMPORTED_MODULE_0__.c)(value) : color$1;
    if (!valueIsCompatible) {
      this.showIncompatibleColorWarning(value, format);
    }
    this.setMode(format, false);
    this.internalColorSet(initialColor, false, "initial");
    this.updateDimensions(this.scale);
    const storageKey = `${_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.c}${this.storageId}`;
    if (this.storageId && localStorage.getItem(storageKey)) {
      this.savedColors = JSON.parse(localStorage.getItem(storageKey));
    }
    await (0,_t9n_js__WEBPACK_IMPORTED_MODULE_9__.s)(this);
  }
  connectedCallback() {
    (0,_interactive_js__WEBPACK_IMPORTED_MODULE_4__.c)(this);
    (0,_locale_js__WEBPACK_IMPORTED_MODULE_7__.c)(this);
    (0,_t9n_js__WEBPACK_IMPORTED_MODULE_9__.c)(this);
  }
  componentDidLoad() {
    (0,_loadable_js__WEBPACK_IMPORTED_MODULE_6__.s)(this);
  }
  disconnectedCallback() {
    document.removeEventListener("pointermove", this.globalPointerMoveHandler);
    document.removeEventListener("pointerup", this.globalPointerUpHandler);
    (0,_interactive_js__WEBPACK_IMPORTED_MODULE_4__.d)(this);
    (0,_locale_js__WEBPACK_IMPORTED_MODULE_7__.d)(this);
    (0,_t9n_js__WEBPACK_IMPORTED_MODULE_9__.d)(this);
  }
  componentDidRender() {
    (0,_interactive_js__WEBPACK_IMPORTED_MODULE_4__.u)(this);
  }
  //--------------------------------------------------------------------------
  //
  //  Render Methods
  //
  //--------------------------------------------------------------------------
  render() {
    const { allowEmpty, channelsDisabled, color, colorFieldScopeLeft, colorFieldScopeTop, dimensions: { slider: { width: sliderWidth }, thumb: { radius: thumbRadius }, }, hexDisabled, hideChannels, hideHex, hideSaved, hueScopeLeft, messages, alphaChannel, opacityScopeLeft, savedColors, savedDisabled, scale, scopeOrientation, } = this;
    const selectedColorInHex = color ? (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.h)(color, alphaChannel) : null;
    const hueTop = thumbRadius;
    const hueLeft = hueScopeLeft ?? (sliderWidth * _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.D.hue()) / _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.H.h;
    const opacityTop = thumbRadius;
    const opacityLeft = opacityScopeLeft ??
      (sliderWidth * (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.b)(_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.D.alpha())) / _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.O.max;
    const noColor = color === null;
    const vertical = scopeOrientation === "vertical";
    const noHex = hexDisabled || hideHex;
    const noChannels = channelsDisabled || hideChannels;
    const noSaved = savedDisabled || hideSaved;
    const [adjustedColorFieldScopeLeft, adjustedColorFieldScopeTop] = this.getAdjustedScopePosition(colorFieldScopeLeft, colorFieldScopeTop);
    const [adjustedHueScopeLeft, adjustedHueScopeTop] = this.getAdjustedScopePosition(hueLeft, hueTop);
    const [adjustedOpacityScopeLeft, adjustedOpacityScopeTop] = this.getAdjustedScopePosition(opacityLeft, opacityTop);
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("div", { class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.container }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("div", { class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.controlAndScope }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("canvas", { class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.colorField, onPointerDown: this.handleColorFieldPointerDown,
      // eslint-disable-next-line react/jsx-sort-props -- ref should be last so node attrs/props are in sync (see https://github.com/Esri/calcite-design-system/pull/6530)
      ref: this.initColorField }), (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("div", { "aria-label": vertical ? messages.value : messages.saturation, "aria-valuemax": vertical ? _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.H.v : _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.H.s, "aria-valuemin": "0", "aria-valuenow": (vertical ? color?.saturationv() : color?.value()) || "0", class: { [_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.scope]: true, [_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.colorFieldScope]: true }, onKeyDown: this.handleColorFieldScopeKeyDown, role: "slider", style: {
        top: `${adjustedColorFieldScopeTop || 0}px`,
        left: `${adjustedColorFieldScopeLeft || 0}px`,
      }, tabindex: "0",
      // eslint-disable-next-line react/jsx-sort-props -- ref should be last so node attrs/props are in sync (see https://github.com/Esri/calcite-design-system/pull/6530)
      ref: this.storeColorFieldScope })), (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("div", { class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.previewAndSliders }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("calcite-color-picker-swatch", { class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.preview, color: selectedColorInHex, scale: "l" }), (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("div", { class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.sliders }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("div", { class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.controlAndScope }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("canvas", { class: { [_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.slider]: true, [_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.hueSlider]: true }, onPointerDown: this.handleHueSliderPointerDown,
      // eslint-disable-next-line react/jsx-sort-props -- ref should be last so node attrs/props are in sync (see https://github.com/Esri/calcite-design-system/pull/6530)
      ref: this.initHueSlider }), (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("div", { "aria-label": messages.hue, "aria-valuemax": _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.H.h, "aria-valuemin": "0", "aria-valuenow": color?.round().hue() || _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.D.round().hue(), class: { [_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.scope]: true, [_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.hueScope]: true }, onKeyDown: this.handleHueScopeKeyDown, role: "slider", style: {
        top: `${adjustedHueScopeTop}px`,
        left: `${adjustedHueScopeLeft}px`,
      }, tabindex: "0",
      // eslint-disable-next-line react/jsx-sort-props -- ref should be last so node attrs/props are in sync (see https://github.com/Esri/calcite-design-system/pull/6530)
      ref: this.storeHueScope })), alphaChannel ? ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("div", { class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.controlAndScope }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("canvas", { class: { [_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.slider]: true, [_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.opacitySlider]: true }, onPointerDown: this.handleOpacitySliderPointerDown,
      // eslint-disable-next-line react/jsx-sort-props -- ref should be last so node attrs/props are in sync (see https://github.com/Esri/calcite-design-system/pull/6530)
      ref: this.initOpacitySlider }), (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("div", { "aria-label": messages.opacity, "aria-valuemax": _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.O.max, "aria-valuemin": _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.O.min, "aria-valuenow": (color || _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.D).round().alpha(), class: { [_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.scope]: true, [_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.opacityScope]: true }, onKeyDown: this.handleOpacityScopeKeyDown, role: "slider", style: {
        top: `${adjustedOpacityScopeTop}px`,
        left: `${adjustedOpacityScopeLeft}px`,
      }, tabindex: "0",
      // eslint-disable-next-line react/jsx-sort-props -- ref should be last so node attrs/props are in sync (see https://github.com/Esri/calcite-design-system/pull/6530)
      ref: this.storeOpacityScope }))) : null)), noHex && noChannels ? null : ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("div", { class: {
        [_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.controlSection]: true,
        [_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.section]: true,
      } }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("div", { class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.hexAndChannelsGroup }, noHex ? null : ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("div", { class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.hexOptions }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("calcite-color-picker-hex-input", { allowEmpty: allowEmpty, alphaChannel: alphaChannel, class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.control, messages: messages, numberingSystem: this.numberingSystem, onCalciteColorPickerHexInputChange: this.handleHexInputChange, scale: scale, value: selectedColorInHex }))), noChannels ? null : ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("calcite-tabs", { class: {
        [_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.colorModeContainer]: true,
        [_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.splitSection]: true,
      }, scale: scale === "l" ? "m" : "s" }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("calcite-tab-nav", { slot: "title-group" }, this.renderChannelsTabTitle("rgb"), this.renderChannelsTabTitle("hsv")), this.renderChannelsTab("rgb"), this.renderChannelsTab("hsv")))))), noSaved ? null : ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("div", { class: { [_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.savedColorsSection]: true, [_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.section]: true } }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("div", { class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.header }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("label", null, messages.saved), (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("div", { class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.savedColorsButtons }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("calcite-button", { appearance: "transparent", class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.deleteColor, disabled: noColor, iconStart: "minus", kind: "neutral", label: messages.deleteColor, onClick: this.deleteColor, scale: scale, type: "button" }), (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("calcite-button", { appearance: "transparent", class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.saveColor, disabled: noColor, iconStart: "plus", kind: "neutral", label: messages.saveColor, onClick: this.saveColor, scale: scale, type: "button" }))), savedColors.length > 0 ? ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("div", { class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.savedColors }, [
      ...savedColors.map((color) => ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_22__.h)("calcite-color-picker-swatch", { class: _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.C.savedColor, color: color, key: color, onClick: this.handleSavedColorSelect, onKeyDown: this.handleSavedColorKeyDown, scale: scale, tabIndex: 0 }))),
    ])) : null))));
  }
  // --------------------------------------------------------------------------
  //
  //  Private Methods
  //
  //--------------------------------------------------------------------------
  handleKeyDown(event) {
    if (event.key === "Enter") {
      event.preventDefault();
    }
  }
  showIncompatibleColorWarning(value, format) {
    console.warn(`ignoring color value (${value}) as it is not compatible with the current format (${format})`);
  }
  setMode(format, warn = true) {
    const mode = format === "auto" ? this.mode : format;
    this.mode = this.ensureCompatibleMode(mode, warn);
  }
  ensureCompatibleMode(mode, warn) {
    const { alphaChannel } = this;
    const isAlphaCompatible = (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.a)(mode);
    if (alphaChannel && !isAlphaCompatible) {
      const alphaMode = (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.f)(mode);
      if (warn) {
        console.warn(`setting format to (${alphaMode}) as the provided one (${mode}) does not support alpha`);
      }
      return alphaMode;
    }
    if (!alphaChannel && isAlphaCompatible) {
      const nonAlphaMode = (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.t)(mode);
      if (warn) {
        console.warn(`setting format to (${nonAlphaMode}) as the provided one (${mode}) does not support alpha`);
      }
      return nonAlphaMode;
    }
    return mode;
  }
  captureHueSliderColor(x) {
    const { dimensions: { slider: { width }, }, } = this;
    const hue = (_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.b / width) * x;
    this.internalColorSet(this.baseColorFieldColor.hue(hue), false);
  }
  captureOpacitySliderValue(x) {
    const { dimensions: { slider: { width }, }, } = this;
    const alpha = (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.o)((_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.O.max / width) * x);
    this.internalColorSet(this.baseColorFieldColor.alpha(alpha), false);
  }
  internalColorSet(color, skipEqual = true, context = "user-interaction") {
    if (skipEqual && (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.c)(color, this.color)) {
      return;
    }
    this.internalColorUpdateContext = context;
    this.color = color;
    this.value = this.toValue(color);
    this.internalColorUpdateContext = null;
  }
  toValue(color, format = this.mode) {
    if (!color) {
      return null;
    }
    const hexMode = "hex";
    if (format.includes(hexMode)) {
      const hasAlpha = format === _utils_js__WEBPACK_IMPORTED_MODULE_3__.C.HEXA;
      return (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.n)((0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.h)(color.round(), hasAlpha), hasAlpha);
    }
    if (format.includes("-css")) {
      const value = color[format.replace("-css", "").replace("a", "")]().round().string();
      // Color omits alpha values when alpha is 1
      const needToInjectAlpha = (format.endsWith("a") || format.endsWith("a-css")) && color.alpha() === 1;
      if (needToInjectAlpha) {
        const model = value.slice(0, 3);
        const values = value.slice(4, -1);
        return `${model}a(${values}, ${color.alpha()})`;
      }
      return value;
    }
    const colorObject = 
    /* Color() does not support hsva, hsla nor rgba, so we use the non-alpha mode */
    color[(0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.t)(format)]().round().object();
    if (format.endsWith("a")) {
      return (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.d)(colorObject);
    }
    return colorObject;
  }
  getSliderCapSpacing() {
    const { dimensions: { slider: { height }, thumb: { radius }, }, } = this;
    return radius * 2 - height;
  }
  updateDimensions(scale = "m") {
    this.dimensions = _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.a[scale];
  }
  drawColorField() {
    const context = this.colorFieldRenderingContext;
    const { dimensions: { colorField: { height, width }, }, } = this;
    context.fillStyle = this.baseColorFieldColor
      .hsv()
      .saturationv(100)
      .value(100)
      .alpha(1)
      .string();
    context.fillRect(0, 0, width, height);
    const whiteGradient = context.createLinearGradient(0, 0, width, 0);
    whiteGradient.addColorStop(0, "rgba(255,255,255,1)");
    whiteGradient.addColorStop(1, "rgba(255,255,255,0)");
    context.fillStyle = whiteGradient;
    context.fillRect(0, 0, width, height);
    const blackGradient = context.createLinearGradient(0, 0, 0, height);
    blackGradient.addColorStop(0, "rgba(0,0,0,0)");
    blackGradient.addColorStop(1, "rgba(0,0,0,1)");
    context.fillStyle = blackGradient;
    context.fillRect(0, 0, width, height);
    this.drawActiveColorFieldColor();
  }
  setCanvasContextSize(canvas, { height, width }) {
    if (!canvas) {
      return;
    }
    const devicePixelRatio = window.devicePixelRatio || 1;
    canvas.width = width * devicePixelRatio;
    canvas.height = height * devicePixelRatio;
    canvas.style.height = `${height}px`;
    canvas.style.width = `${width}px`;
    const context = canvas.getContext("2d");
    context.scale(devicePixelRatio, devicePixelRatio);
  }
  updateCanvasSize(context = "all") {
    const { dimensions } = this;
    if (context === "all" || context === "color-field") {
      this.setCanvasContextSize(this.colorFieldRenderingContext?.canvas, dimensions.colorField);
    }
    const adjustedSliderDimensions = {
      width: dimensions.slider.width,
      height: dimensions.slider.height + (dimensions.thumb.radius - dimensions.slider.height / 2) * 2,
    };
    if (context === "all" || context === "hue-slider") {
      this.setCanvasContextSize(this.hueSliderRenderingContext?.canvas, adjustedSliderDimensions);
    }
    if (context === "all" || context === "opacity-slider") {
      this.setCanvasContextSize(this.opacitySliderRenderingContext?.canvas, adjustedSliderDimensions);
    }
  }
  drawActiveColorFieldColor() {
    const { color } = this;
    if (!color) {
      return;
    }
    const hsvColor = color.hsv();
    const { dimensions: { colorField: { height, width }, thumb: { radius }, }, } = this;
    const x = hsvColor.saturationv() / (_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.H.s / width);
    const y = height - hsvColor.value() / (_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.H.v / height);
    requestAnimationFrame(() => {
      this.colorFieldScopeLeft = x;
      this.colorFieldScopeTop = y;
    });
    this.drawThumb(this.colorFieldRenderingContext, radius, x, y, hsvColor);
  }
  drawThumb(context, radius, x, y, color) {
    const startAngle = 0;
    const endAngle = 2 * Math.PI;
    const outlineWidth = 1;
    context.beginPath();
    context.arc(x, y, radius, startAngle, endAngle);
    context.fillStyle = "#fff";
    context.fill();
    context.strokeStyle = "rgba(0,0,0,0.3)";
    context.lineWidth = outlineWidth;
    context.stroke();
    context.beginPath();
    context.arc(x, y, radius - 3, startAngle, endAngle);
    context.fillStyle = color.rgb().alpha(1).string();
    context.fill();
  }
  drawActiveHueSliderColor() {
    const { color } = this;
    if (!color) {
      return;
    }
    const hsvColor = color.hsv().saturationv(100).value(100);
    const { dimensions: { slider: { width }, thumb: { radius }, }, } = this;
    const x = hsvColor.hue() / (_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.b / width);
    const y = radius;
    const sliderBoundX = this.getSliderBoundX(x, width, radius);
    requestAnimationFrame(() => {
      this.hueScopeLeft = sliderBoundX;
    });
    this.drawThumb(this.hueSliderRenderingContext, radius, sliderBoundX, y, hsvColor);
  }
  drawHueSlider() {
    const context = this.hueSliderRenderingContext;
    const { dimensions: { slider: { height, width }, thumb: { radius: thumbRadius }, }, } = this;
    const x = 0;
    const y = thumbRadius - height / 2;
    const gradient = context.createLinearGradient(0, 0, width, 0);
    const hueSliderColorStopKeywords = [
      "red",
      "yellow",
      "lime",
      "cyan",
      "blue",
      "magenta",
      "#ff0004" /* 1 unit less than #ff0 to avoid duplicate values within range */,
    ];
    const offset = 1 / (hueSliderColorStopKeywords.length - 1);
    let currentOffset = 0;
    hueSliderColorStopKeywords.forEach((keyword) => {
      gradient.addColorStop(currentOffset, (0,_index2_js__WEBPACK_IMPORTED_MODULE_0__.c)(keyword).string());
      currentOffset += offset;
    });
    context.clearRect(0, 0, width, height + this.getSliderCapSpacing() * 2);
    this.drawSliderPath(context, height, width, x, y);
    context.fillStyle = gradient;
    context.fill();
    context.strokeStyle = "rgba(0,0,0,0.3)";
    context.lineWidth = 1;
    context.stroke();
    this.drawActiveHueSliderColor();
  }
  drawOpacitySlider() {
    const context = this.opacitySliderRenderingContext;
    const { baseColorFieldColor: previousColor, dimensions: { slider: { height, width }, thumb: { radius: thumbRadius }, }, } = this;
    const x = 0;
    const y = thumbRadius - height / 2;
    context.clearRect(0, 0, width, height + this.getSliderCapSpacing() * 2);
    const gradient = context.createLinearGradient(0, y, width, 0);
    const startColor = previousColor.rgb().alpha(0);
    const midColor = previousColor.rgb().alpha(0.5);
    const endColor = previousColor.rgb().alpha(1);
    gradient.addColorStop(0, startColor.string());
    gradient.addColorStop(0.5, midColor.string());
    gradient.addColorStop(1, endColor.string());
    this.drawSliderPath(context, height, width, x, y);
    const pattern = context.createPattern(this.getCheckeredBackgroundPattern(), "repeat");
    context.fillStyle = pattern;
    context.fill();
    context.fillStyle = gradient;
    context.fill();
    context.strokeStyle = "rgba(0,0,0,0.3)";
    context.lineWidth = 1;
    context.stroke();
    this.drawActiveOpacitySliderColor();
  }
  drawSliderPath(context, height, width, x, y) {
    const radius = height / 2 + 1;
    context.beginPath();
    context.moveTo(x + radius, y);
    context.lineTo(x + width - radius, y);
    context.quadraticCurveTo(x + width, y, x + width, y + radius);
    context.lineTo(x + width, y + height - radius);
    context.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
    context.lineTo(x + radius, y + height);
    context.quadraticCurveTo(x, y + height, x, y + height - radius);
    context.lineTo(x, y + radius);
    context.quadraticCurveTo(x, y, x + radius, y);
    context.closePath();
  }
  getCheckeredBackgroundPattern() {
    if (this.checkerPattern) {
      return this.checkerPattern;
    }
    const pattern = document.createElement("canvas");
    pattern.width = 10;
    pattern.height = 10;
    const patternContext = pattern.getContext("2d");
    patternContext.fillStyle = "#ccc";
    patternContext.fillRect(0, 0, 10, 10);
    patternContext.fillStyle = "#fff";
    patternContext.fillRect(0, 0, 5, 5);
    patternContext.fillRect(5, 5, 5, 5);
    this.checkerPattern = pattern;
    return pattern;
  }
  drawActiveOpacitySliderColor() {
    const { color } = this;
    if (!color) {
      return;
    }
    const hsvColor = color;
    const { dimensions: { slider: { width }, thumb: { radius }, }, } = this;
    const x = (0,_utils_js__WEBPACK_IMPORTED_MODULE_3__.b)(hsvColor.alpha()) / (_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.O.max / width);
    const y = radius;
    const sliderBoundX = this.getSliderBoundX(x, width, radius);
    requestAnimationFrame(() => {
      this.opacityScopeLeft = sliderBoundX;
    });
    this.drawThumb(this.opacitySliderRenderingContext, radius, sliderBoundX, y, hsvColor);
  }
  getSliderBoundX(x, width, radius) {
    const closeToEdge = (0,_math_js__WEBPACK_IMPORTED_MODULE_8__.a)(x, width, radius);
    return closeToEdge === 0
      ? x
      : closeToEdge === -1
        ? (0,_math_js__WEBPACK_IMPORTED_MODULE_8__.r)(x, 0, width, radius, radius * 2)
        : (0,_math_js__WEBPACK_IMPORTED_MODULE_8__.r)(x, 0, width, width - radius * 2, width - radius);
  }
  updateColorFromChannels(channels) {
    this.internalColorSet((0,_index2_js__WEBPACK_IMPORTED_MODULE_0__.c)(channels, this.channelMode));
  }
  updateChannelsFromColor(color) {
    this.channels = color ? this.toChannels(color) : [null, null, null, null];
  }
  toChannels(color) {
    const { channelMode } = this;
    const channels = color[channelMode]()
      .array()
      .map((value, index) => {
      const isAlpha = index === 3;
      return isAlpha ? value : Math.floor(value);
    });
    if (channels.length === 3) {
      channels.push(1); // Color omits alpha when 1
    }
    return channels;
  }
  getAdjustedScopePosition(left, top) {
    return [left - _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.S / 2, top - _color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.S / 2];
  }
  static get delegatesFocus() { return true; }
  static get assetsDirs() { return ["assets"]; }
  get el() { return this; }
  static get watchers() { return {
    "alphaChannel": ["handleAlphaChannelChange", "handleFormatOrAlphaChannelChange"],
    "color": ["handleColorChange"],
    "format": ["handleFormatOrAlphaChannelChange"],
    "scale": ["handleScaleChange"],
    "messageOverrides": ["onMessagesChange"],
    "value": ["handleValueChange"],
    "effectiveLocale": ["effectiveLocaleChange"]
  }; }
  static get style() { return colorPickerCss; }
}, [17, "calcite-color-picker", {
    "allowEmpty": [516, "allow-empty"],
    "alphaChannel": [4, "alpha-channel"],
    "channelsDisabled": [4, "channels-disabled"],
    "color": [1040],
    "disabled": [516],
    "format": [513],
    "hideChannels": [516, "hide-channels"],
    "hexDisabled": [4, "hex-disabled"],
    "hideHex": [516, "hide-hex"],
    "hideSaved": [516, "hide-saved"],
    "savedDisabled": [516, "saved-disabled"],
    "scale": [513],
    "storageId": [513, "storage-id"],
    "messageOverrides": [1040],
    "numberingSystem": [513, "numbering-system"],
    "value": [1025],
    "messages": [1040],
    "defaultMessages": [32],
    "channelMode": [32],
    "channels": [32],
    "dimensions": [32],
    "effectiveLocale": [32],
    "savedColors": [32],
    "colorFieldScopeTop": [32],
    "colorFieldScopeLeft": [32],
    "hueScopeLeft": [32],
    "opacityScopeLeft": [32],
    "scopeOrientation": [32],
    "setFocus": [64]
  }, [[2, "keydown", "handleChannelKeyUpOrDown"], [2, "keyup", "handleChannelKeyUpOrDown"]]]);
function defineCustomElement$1() {
  if (typeof customElements === "undefined") {
    return;
  }
  const components = ["calcite-color-picker", "calcite-button", "calcite-color-picker-hex-input", "calcite-color-picker-swatch", "calcite-icon", "calcite-input-number", "calcite-input-text", "calcite-loader", "calcite-progress", "calcite-tab", "calcite-tab-nav", "calcite-tab-title", "calcite-tabs"];
  components.forEach(tagName => { switch (tagName) {
    case "calcite-color-picker":
      if (!customElements.get(tagName)) {
        customElements.define(tagName, ColorPicker);
      }
      break;
    case "calcite-button":
      if (!customElements.get(tagName)) {
        (0,_button_js__WEBPACK_IMPORTED_MODULE_10__.d)();
      }
      break;
    case "calcite-color-picker-hex-input":
      if (!customElements.get(tagName)) {
        (0,_color_picker_hex_input_js__WEBPACK_IMPORTED_MODULE_2__.d)();
      }
      break;
    case "calcite-color-picker-swatch":
      if (!customElements.get(tagName)) {
        (0,_color_picker_swatch_js__WEBPACK_IMPORTED_MODULE_11__.d)();
      }
      break;
    case "calcite-icon":
      if (!customElements.get(tagName)) {
        (0,_icon_js__WEBPACK_IMPORTED_MODULE_12__.d)();
      }
      break;
    case "calcite-input-number":
      if (!customElements.get(tagName)) {
        (0,_input_number_js__WEBPACK_IMPORTED_MODULE_13__.d)();
      }
      break;
    case "calcite-input-text":
      if (!customElements.get(tagName)) {
        (0,_input_text_js__WEBPACK_IMPORTED_MODULE_14__.d)();
      }
      break;
    case "calcite-loader":
      if (!customElements.get(tagName)) {
        (0,_loader_js__WEBPACK_IMPORTED_MODULE_15__.d)();
      }
      break;
    case "calcite-progress":
      if (!customElements.get(tagName)) {
        (0,_progress_js__WEBPACK_IMPORTED_MODULE_16__.d)();
      }
      break;
    case "calcite-tab":
      if (!customElements.get(tagName)) {
        (0,_tab_js__WEBPACK_IMPORTED_MODULE_17__.d)();
      }
      break;
    case "calcite-tab-nav":
      if (!customElements.get(tagName)) {
        (0,_tab_nav_js__WEBPACK_IMPORTED_MODULE_18__.d)();
      }
      break;
    case "calcite-tab-title":
      if (!customElements.get(tagName)) {
        (0,_tab_title_js__WEBPACK_IMPORTED_MODULE_19__.d)();
      }
      break;
    case "calcite-tabs":
      if (!customElements.get(tagName)) {
        (0,_tabs_js__WEBPACK_IMPORTED_MODULE_20__.d)();
      }
      break;
  } });
}
defineCustomElement$1();

const CalciteColorPicker = ColorPicker;
const defineCustomElement = defineCustomElement$1;




/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/components/color-picker-swatch.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/components/color-picker-swatch.js ***!
  \**************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   C: () => (/* binding */ ColorPickerSwatch),
/* harmony export */   d: () => (/* binding */ defineCustomElement)
/* harmony export */ });
/* harmony import */ var _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @stencil/core/internal/client/index.js */ "./node_modules/@stencil/core/internal/client/index.js");
/* harmony import */ var _index2_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index2.js */ "./node_modules/@esri/calcite-components/dist/components/index2.js");
/* harmony import */ var _dom_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./dom.js */ "./node_modules/@esri/calcite-components/dist/components/dom.js");
/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils.js */ "./node_modules/@esri/calcite-components/dist/components/utils.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v1.7.0
 */





const CSS = {
  swatch: "swatch",
  noColorSwatch: "swatch--no-color",
  checker: "checker",
};
const COLORS = {
  borderLight: "rgba(0, 0, 0, 0.3)",
  borderDark: "rgba(255, 255, 255, 0.15)",
};
const checkerSquareSize = 4;
const CHECKER_DIMENSIONS = {
  squareSize: checkerSquareSize,
  size: checkerSquareSize * 2,
};

const colorPickerSwatchCss = ":host{position:relative;display:inline-flex}:host([scale=s]){block-size:1.25rem;inline-size:1.25rem}:host([scale=m]){block-size:1.5rem;inline-size:1.5rem}:host([scale=l]){block-size:2rem;inline-size:2rem}.swatch{overflow:hidden;block-size:inherit;inline-size:inherit}.swatch rect{transition-property:all;transition-duration:150ms;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1)}.swatch--no-color rect{fill:var(--calcite-ui-foreground-1)}.swatch--no-color line{stroke:var(--calcite-ui-danger)}.checker{fill:#cacaca}:host([hidden]){display:none}[hidden]{display:none}";

const ColorPickerSwatch = /*@__PURE__*/ (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.proxyCustomElement)(class extends _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.HTMLElement {
  constructor() {
    super();
    this.__registerHost();
    this.__attachShadow();
    this.active = false;
    this.color = undefined;
    this.scale = "m";
  }
  handleColorChange(color$1) {
    this.internalColor = color$1 ? (0,_index2_js__WEBPACK_IMPORTED_MODULE_0__.c)(color$1) : null;
  }
  //--------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  //--------------------------------------------------------------------------
  componentWillLoad() {
    this.handleColorChange(this.color);
  }
  render() {
    const isEmpty = !this.internalColor;
    const classes = {
      [CSS.swatch]: true,
      [CSS.noColorSwatch]: isEmpty,
    };
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.h)("svg", { class: classes, xmlns: "http://www.w3.org/2000/svg" }, this.renderSwatch()));
  }
  renderSwatch() {
    const { active, el, internalColor } = this;
    const borderRadius = active ? "100%" : "0";
    const theme = (0,_dom_js__WEBPACK_IMPORTED_MODULE_1__.r)(el);
    const borderColor = theme === "light" ? COLORS.borderLight : COLORS.borderDark;
    const commonSwatchProps = {
      height: "100%",
      rx: borderRadius,
      stroke: borderColor,
      // stroke-width and clip-path are needed to hide overflowing portion of stroke
      // see https://stackoverflow.com/a/7273346/194216
      // using attribute to work around Stencil using the prop name vs the attribute when rendering
      ["stroke-width"]: "2",
      width: "100%",
    };
    const isEmpty = !internalColor;
    if (isEmpty) {
      return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.h)(_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.Fragment, null, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.h)("clipPath", { id: "shape" }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.h)("rect", { height: "100%", rx: borderRadius, width: "100%" })), (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.h)("rect", { "clip-path": `inset(0 round ${borderRadius})`, rx: borderRadius, ...commonSwatchProps }), (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.h)("line", { "clip-path": "url(#shape)", "stroke-width": "3", x1: "100%", x2: "0", y1: "0", y2: "100%" })));
    }
    const alpha = internalColor.alpha();
    const hex = (0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.h)(internalColor);
    const hexa = (0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.h)(internalColor, alpha < 1);
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.h)(_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.Fragment, null, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.h)("title", null, hexa), (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.h)("defs", null, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.h)("pattern", { height: CHECKER_DIMENSIONS.size, id: "checker", patternUnits: "userSpaceOnUse", width: CHECKER_DIMENSIONS.size, x: "0", y: "0" }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.h)("rect", { class: CSS.checker, height: CHECKER_DIMENSIONS.squareSize, width: CHECKER_DIMENSIONS.squareSize, x: "0", y: "0" }), (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.h)("rect", { class: CSS.checker, height: CHECKER_DIMENSIONS.squareSize, width: CHECKER_DIMENSIONS.squareSize, x: CHECKER_DIMENSIONS.squareSize, y: CHECKER_DIMENSIONS.squareSize }))), (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.h)("rect", { fill: "url(#checker)", height: "100%", rx: borderRadius, width: "100%" }), (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.h)("rect", { fill: hex, style: {
        "clip-path": alpha < 1 ? "polygon(100% 0, 0 0, 0 100%)" : `inset(0 round ${borderRadius})`,
      }, ...commonSwatchProps }), alpha < 1 ? ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.h)("rect", { fill: hexa, key: "opacity-fill", style: { "clip-path": "polygon(100% 0, 100% 100%, 0 100%)" }, ...commonSwatchProps })) : null));
  }
  get el() { return this; }
  static get watchers() { return {
    "color": ["handleColorChange"]
  }; }
  static get style() { return colorPickerSwatchCss; }
}, [1, "calcite-color-picker-swatch", {
    "active": [516],
    "color": [1],
    "scale": [513]
  }]);
function defineCustomElement() {
  if (typeof customElements === "undefined") {
    return;
  }
  const components = ["calcite-color-picker-swatch"];
  components.forEach(tagName => { switch (tagName) {
    case "calcite-color-picker-swatch":
      if (!customElements.get(tagName)) {
        customElements.define(tagName, ColorPickerSwatch);
      }
      break;
  } });
}
defineCustomElement();




/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/components/tab.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/components/tab.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   T: () => (/* binding */ Tab),
/* harmony export */   d: () => (/* binding */ defineCustomElement)
/* harmony export */ });
/* harmony import */ var _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @stencil/core/internal/client/index.js */ "./node_modules/@stencil/core/internal/client/index.js");
/* harmony import */ var _dom_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dom.js */ "./node_modules/@esri/calcite-components/dist/components/dom.js");
/* harmony import */ var _guid_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./guid.js */ "./node_modules/@esri/calcite-components/dist/components/guid.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v1.7.0
 */




const tabCss = ":host([selected]) section,:host([selected]) .container{display:block}:host{display:none;block-size:100%;inline-size:100%}:host([selected]){display:block;block-size:100%;inline-size:100%;overflow:auto}section,.container{display:none;block-size:100%;inline-size:100%}:host([scale=s]){padding-block:0.25rem;font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=m]){padding-block:0.5rem;font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=l]){font-size:var(--calcite-font-size-0);line-height:1.25rem;padding-block:13px}:host([hidden]){display:none}[hidden]{display:none}";

const Tab = /*@__PURE__*/ (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_2__.proxyCustomElement)(class extends _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_2__.HTMLElement {
  constructor() {
    super();
    this.__registerHost();
    this.__attachShadow();
    this.calciteInternalTabRegister = (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_2__.createEvent)(this, "calciteInternalTabRegister", 6);
    this.guid = `calcite-tab-title-${(0,_guid_js__WEBPACK_IMPORTED_MODULE_1__.g)()}`;
    this.tab = undefined;
    this.selected = false;
    this.scale = "m";
    this.labeledBy = undefined;
  }
  //--------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  //--------------------------------------------------------------------------
  render() {
    const id = this.el.id || this.guid;
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_2__.h)(_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_2__.Host, { "aria-labelledby": this.labeledBy, id: id }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_2__.h)("div", { class: "container", role: "tabpanel", tabIndex: this.selected ? 0 : -1 }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_2__.h)("section", null, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_2__.h)("slot", null)))));
  }
  connectedCallback() {
    this.parentTabsEl = this.el.closest("calcite-tabs");
  }
  componentDidLoad() {
    this.calciteInternalTabRegister.emit();
  }
  componentWillRender() {
    this.scale = this.parentTabsEl?.scale;
  }
  disconnectedCallback() {
    // Dispatching to body in order to be listened by other elements that are still connected to the DOM.
    document.body?.dispatchEvent(new CustomEvent("calciteTabUnregister", {
      detail: this.el,
    }));
  }
  //--------------------------------------------------------------------------
  //
  //  Event Listeners
  //
  //--------------------------------------------------------------------------
  internalTabChangeHandler(event) {
    const targetTabsEl = event
      .composedPath()
      .find((el) => el.tagName === "CALCITE-TABS");
    // to allow `<calcite-tabs>` to be nested we need to make sure this
    // `calciteTabChange` event was actually fired from a within the same
    // `<calcite-tabs>` that is the a parent of this tab.
    if (targetTabsEl !== this.parentTabsEl) {
      return;
    }
    if (this.tab) {
      this.selected = this.tab === event.detail.tab;
    }
    else {
      this.getTabIndex().then((index) => {
        this.selected = index === event.detail.tab;
      });
    }
    event.stopPropagation();
  }
  //--------------------------------------------------------------------------
  //
  //  Public Methods
  //
  //--------------------------------------------------------------------------
  /**
   * Returns the index of the component item within the tab array.
   */
  async getTabIndex() {
    return Array.prototype.indexOf.call((0,_dom_js__WEBPACK_IMPORTED_MODULE_0__.o)(this.el.parentElement.children).filter((el) => el.matches("calcite-tab")), this.el);
  }
  //--------------------------------------------------------------------------
  //
  //  Private Methods
  //
  //--------------------------------------------------------------------------
  /**
   * @param tabIds
   * @param titleIds
   * @internal
   */
  async updateAriaInfo(tabIds = [], titleIds = []) {
    this.labeledBy = titleIds[tabIds.indexOf(this.el.id)] || null;
  }
  get el() { return this; }
  static get style() { return tabCss; }
}, [1, "calcite-tab", {
    "tab": [513],
    "selected": [1540],
    "scale": [1537],
    "labeledBy": [32],
    "getTabIndex": [64],
    "updateAriaInfo": [64]
  }, [[16, "calciteInternalTabChange", "internalTabChangeHandler"]]]);
function defineCustomElement() {
  if (typeof customElements === "undefined") {
    return;
  }
  const components = ["calcite-tab"];
  components.forEach(tagName => { switch (tagName) {
    case "calcite-tab":
      if (!customElements.get(tagName)) {
        customElements.define(tagName, Tab);
      }
      break;
  } });
}
defineCustomElement();




/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/components/tabs.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/components/tabs.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   T: () => (/* binding */ Tabs),
/* harmony export */   d: () => (/* binding */ defineCustomElement)
/* harmony export */ });
/* harmony import */ var _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @stencil/core/internal/client/index.js */ "./node_modules/@stencil/core/internal/client/index.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v1.7.0
 */


const SLOTS = {
  titleGroup: "title-group",
};

const tabsCss = ":host{display:flex;flex-direction:column}:host([bordered]){box-shadow:inset 0 1px 0 var(--calcite-ui-border-1);background-color:var(--calcite-ui-foreground-1)}:host([bordered]:not([position=bottom])) ::slotted(calcite-tab-nav){margin-block-end:-1px}:host([bordered][position=bottom]){box-shadow:inset 0 1px 0 var(--calcite-ui-border-1), inset 0 -1px 0 var(--calcite-ui-border-1)}:host([bordered]) section{border-width:1px;border-style:solid;border-color:var(--calcite-ui-border-1)}:host([bordered][scale=s]) section{padding:0.75rem}:host([bordered][scale=m]) section{padding:0.5rem}:host([bordered][scale=l]) section{padding:1rem}:host([position=bottom]){flex-direction:column-reverse}section{display:flex;flex-grow:1;overflow:hidden;border-block-start-width:1px;border-block-start-color:var(--calcite-ui-border-1);border-block-start-style:solid}:host([position=bottom]) section{flex-direction:column-reverse;border-block-start-width:0px;border-block-end-width:1px;border-block-end-color:var(--calcite-ui-border-1)}:host([position=bottom]:not([bordered])) section{border-block-end-style:solid}@media (forced-colors: active){:host([bordered]) section{border-block-start-width:0px;border-block-end-width:1px}:host([position=bottom][bordered]) section{border-block-start-width:1px;border-block-end-width:0px}}:host([hidden]){display:none}[hidden]{display:none}";

const Tabs = /*@__PURE__*/ (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_0__.proxyCustomElement)(class extends _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_0__.HTMLElement {
  constructor() {
    super();
    this.__registerHost();
    this.__attachShadow();
    this.layout = "inline";
    this.position = "top";
    this.scale = "m";
    this.bordered = false;
    this.titles = [];
    this.tabs = [];
  }
  //--------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  //--------------------------------------------------------------------------
  render() {
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_0__.h)(_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_0__.Fragment, null, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: SLOTS.titleGroup }), (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_0__.h)("section", null, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", null))));
  }
  //--------------------------------------------------------------------------
  //
  //  Event Listeners
  //
  //--------------------------------------------------------------------------
  /**
   * @param event
   * @internal
   */
  calciteInternalTabTitleRegister(event) {
    this.titles = [...this.titles, event.target];
    this.registryHandler();
    event.stopPropagation();
  }
  /**
   * @param event
   * @internal
   */
  calciteTabTitleUnregister(event) {
    this.titles = this.titles.filter((el) => el !== event.detail);
    this.registryHandler();
    event.stopPropagation();
  }
  /**
   * @param event
   * @internal
   */
  calciteInternalTabRegister(event) {
    this.tabs = [...this.tabs, event.target];
    this.registryHandler();
    event.stopPropagation();
  }
  /**
   * @param event
   * @internal
   */
  calciteTabUnregister(event) {
    this.tabs = this.tabs.filter((el) => el !== event.detail);
    this.registryHandler();
    event.stopPropagation();
  }
  //--------------------------------------------------------------------------
  //
  //  Private Methods
  //
  //--------------------------------------------------------------------------
  /**
   *
   * Matches up elements from the internal `tabs` and `titles` to automatically
   * update the ARIA attributes and link `<calcite-tab>` and
   * `<calcite-tab-title>` components.
   */
  async registryHandler() {
    let tabIds;
    let titleIds;
    // determine if we are using `tab` based or `index` based tab identifiers.
    if (this.tabs.some((el) => el.tab) || this.titles.some((el) => el.tab)) {
      // if we are using `tab` based identifiers sort by `tab` to account for
      // possible out of order tabs and get the id of each tab
      tabIds = this.tabs.sort((a, b) => a.tab.localeCompare(b.tab)).map((el) => el.id);
      titleIds = this.titles.sort((a, b) => a.tab.localeCompare(b.tab)).map((el) => el.id);
    }
    else {
      // if we are using index based tabs then the `<calcite-tab>` and
      // `<calcite-tab-title>` might have been rendered out of order so the
      // order of `this.tabs` and `this.titles` might not reflect the DOM state,
      // and might not match each other so we need to get the index of all the
      // tabs and titles in the DOM order to match them up as a source of truth
      const tabDomIndexes = await Promise.all(this.tabs.map((el) => el.getTabIndex()));
      const titleDomIndexes = await Promise.all(this.titles.map((el) => el.getTabIndex()));
      // once we have the DOM order as a source of truth we can build the
      // matching tabIds and titleIds arrays
      tabIds = tabDomIndexes.reduce((ids, indexInDOM, registryIndex) => {
        ids[indexInDOM] = this.tabs[registryIndex].id;
        return ids;
      }, []);
      titleIds = titleDomIndexes.reduce((ids, indexInDOM, registryIndex) => {
        ids[indexInDOM] = this.titles[registryIndex].id;
        return ids;
      }, []);
    }
    // pass all our new aria information to each `<calcite-tab>` and
    // `<calcite-tab-title>` which will check if they can update their internal
    // `controlled` or `labeledBy` states and re-render if necessary
    this.tabs.forEach((el) => el.updateAriaInfo(tabIds, titleIds));
    this.titles.forEach((el) => el.updateAriaInfo(tabIds, titleIds));
  }
  get el() { return this; }
  static get style() { return tabsCss; }
}, [1, "calcite-tabs", {
    "layout": [513],
    "position": [513],
    "scale": [513],
    "bordered": [4],
    "titles": [32],
    "tabs": [32]
  }, [[0, "calciteInternalTabTitleRegister", "calciteInternalTabTitleRegister"], [16, "calciteTabTitleUnregister", "calciteTabTitleUnregister"], [0, "calciteInternalTabRegister", "calciteInternalTabRegister"], [16, "calciteTabUnregister", "calciteTabUnregister"]]]);
function defineCustomElement() {
  if (typeof customElements === "undefined") {
    return;
  }
  const components = ["calcite-tabs"];
  components.forEach(tagName => { switch (tagName) {
    case "calcite-tabs":
      if (!customElements.get(tagName)) {
        customElements.define(tagName, Tabs);
      }
      break;
  } });
}
defineCustomElement();




/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/components/throttle.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/components/throttle.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   t: () => (/* binding */ throttle)
/* harmony export */ });
/* harmony import */ var _debounce_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./debounce.js */ "./node_modules/@esri/calcite-components/dist/components/debounce.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v1.7.0
 */


/** Error message constants. */
var FUNC_ERROR_TEXT = 'Expected a function';

/**
 * Creates a throttled function that only invokes `func` at most once per
 * every `wait` milliseconds. The throttled function comes with a `cancel`
 * method to cancel delayed `func` invocations and a `flush` method to
 * immediately invoke them. Provide `options` to indicate whether `func`
 * should be invoked on the leading and/or trailing edge of the `wait`
 * timeout. The `func` is invoked with the last arguments provided to the
 * throttled function. Subsequent calls to the throttled function return the
 * result of the last `func` invocation.
 *
 * **Note:** If `leading` and `trailing` options are `true`, `func` is
 * invoked on the trailing edge of the timeout only if the throttled function
 * is invoked more than once during the `wait` timeout.
 *
 * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred
 * until to the next tick, similar to `setTimeout` with a timeout of `0`.
 *
 * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)
 * for details over the differences between `_.throttle` and `_.debounce`.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Function
 * @param {Function} func The function to throttle.
 * @param {number} [wait=0] The number of milliseconds to throttle invocations to.
 * @param {Object} [options={}] The options object.
 * @param {boolean} [options.leading=true]
 *  Specify invoking on the leading edge of the timeout.
 * @param {boolean} [options.trailing=true]
 *  Specify invoking on the trailing edge of the timeout.
 * @returns {Function} Returns the new throttled function.
 * @example
 *
 * // Avoid excessively updating the position while scrolling.
 * jQuery(window).on('scroll', _.throttle(updatePosition, 100));
 *
 * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.
 * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });
 * jQuery(element).on('click', throttled);
 *
 * // Cancel the trailing throttled invocation.
 * jQuery(window).on('popstate', throttled.cancel);
 */
function throttle(func, wait, options) {
  var leading = true,
      trailing = true;

  if (typeof func != 'function') {
    throw new TypeError(FUNC_ERROR_TEXT);
  }
  if ((0,_debounce_js__WEBPACK_IMPORTED_MODULE_0__.i)(options)) {
    leading = 'leading' in options ? !!options.leading : leading;
    trailing = 'trailing' in options ? !!options.trailing : trailing;
  }
  return (0,_debounce_js__WEBPACK_IMPORTED_MODULE_0__.d)(func, wait, {
    'leading': leading,
    'maxWait': wait,
    'trailing': trailing
  });
}




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfZXNyaV9jYWxjaXRlLWNvbXBvbmVudHNfZGlzdF9jb21wb25lbnRzX2NhbGNpdGUtY29sb3ItcGlja2VyX2pzLmJ1bmRsZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUN5RztBQUNoRTtBQUNrQztBQUNrTDtBQUNJO0FBQzlJO0FBQ25FO0FBQzhEO0FBQ2hDO0FBQ0o7QUFDd0M7QUFDekQ7QUFDYTtBQUNmO0FBQ1E7QUFDRjtBQUNKO0FBQ0U7QUFDTDtBQUNJO0FBQ0U7QUFDTDtBQUNUOztBQUU5QywwQ0FBMEMsZUFBZSx5QkFBeUIsaUJBQWlCLDJDQUEyQyxtREFBbUQsb0JBQW9CLE1BQU0scUJBQXFCLHNDQUFzQyxpQkFBaUIsOENBQThDLHlHQUF5RyxVQUFVLGlCQUFpQixtQ0FBbUMsNEJBQTRCLGtCQUFrQiwrQkFBK0IsWUFBWSw4Q0FBOEMsaUJBQWlCLG9DQUFvQyw0QkFBNEIsa0JBQWtCLGlCQUFpQixvQ0FBb0Msc0NBQXNDLGlCQUFpQiw0QkFBNEIsa0JBQWtCLHdDQUF3Qyx3REFBd0QsK0JBQStCLDhDQUE4QyxrQ0FBa0MsaUJBQWlCLHFCQUFxQixlQUFlLG9DQUFvQyxhQUFhLGNBQWMsc0JBQXNCLDZCQUE2Qix1Q0FBdUMsY0FBYyxXQUFXLGdEQUFnRCxxQkFBcUIsNENBQTRDLG1CQUFtQixrQkFBa0IsYUFBYSxlQUFlLGtCQUFrQixPQUFPLG9CQUFvQixrQkFBa0IsbUNBQW1DLGVBQWUsZ0JBQWdCLHFCQUFxQiw2QkFBNkIsc0NBQXNDLDBCQUEwQixhQUFhLHlFQUF5RSxvUEFBb1Asb0JBQW9CLHdCQUF3QixpQkFBaUIseUNBQXlDLGFBQWEsbUJBQW1CLGVBQWUsU0FBUyxvREFBb0QsbURBQW1ELHVCQUF1Qix3REFBd0QsU0FBUyxhQUFhLHNCQUFzQiw4QkFBOEIsd0RBQXdELHFCQUFxQixhQUFhLG1CQUFtQiw0Q0FBNEMsbUNBQW1DLFlBQVksUUFBUSxhQUFhLG1CQUFtQiw4QkFBOEIsK0JBQStCLHNCQUFzQix3REFBd0QsVUFBVSxhQUFhLGlCQUFpQixtQ0FBbUMsa0JBQWtCLDJCQUEyQixlQUFlLDBCQUEwQixlQUFlLFlBQVksb0RBQW9ELGtCQUFrQiwwQkFBMEIsb0RBQW9ELGtCQUFrQixjQUFjLGFBQWEsV0FBVyx3REFBd0QsOENBQThDLHNCQUFzQixhQUFhLGFBQWEsaUJBQWlCLDBCQUEwQixlQUFlLG1CQUFtQiwwQ0FBMEMsbUJBQW1CLG1CQUFtQixtRkFBbUYsNkNBQTZDLG1CQUFtQixnQkFBZ0IsYUFBYSxTQUFTLGFBQWE7O0FBRS9ySDtBQUNBLGtDQUFrQywyRkFBa0IsZUFBZSxnRkFBVztBQUM5RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxvRkFBVztBQUMvQyxtQ0FBbUMsb0ZBQVc7QUFDOUM7QUFDQSxnQkFBZ0Isd0NBQVk7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxNQUFNO0FBQ3BCO0FBQ0EsbUJBQW1CLGNBQWM7QUFDakMsc0JBQXNCLGFBQWE7QUFDbkMscUJBQXFCLGFBQWE7QUFDbEMscUJBQXFCLGNBQWM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxNQUFNO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyw2QkFBNkI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLDRDQUFZLENBQUMsNENBQU0sVUFBVSw0Q0FBZTtBQUNuRjtBQUNBLDhCQUE4Qiw2Q0FBSztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qiw2Q0FBSztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLHlEQUFjO0FBQ3hCO0FBQ0EsWUFBWSx5REFBVSxhQUFhLHlEQUFVO0FBQzdDLFlBQVkseURBQVUsYUFBYSx5REFBVTtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwyQ0FBSztBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCw0Q0FBYztBQUM5RDtBQUNBO0FBQ0E7QUFDQSxVQUFVLDBDQUFlO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLDBDQUFzQjtBQUNqQztBQUNBO0FBQ0EsY0FBYyxtQkFBbUI7QUFDakM7QUFDQSw0RUFBNEUsWUFBWTtBQUN4RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVywwQ0FBc0I7QUFDakM7QUFDQTtBQUNBLGNBQWMsVUFBVTtBQUN4QjtBQUNBLDRFQUE0RSxZQUFZO0FBQ3hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLDBDQUFzQjtBQUNqQztBQUNBO0FBQ0EsY0FBYyxVQUFVO0FBQ3hCO0FBQ0EsNEVBQTRFLFlBQVk7QUFDeEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsMENBQXNCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyx1QkFBdUI7QUFDckM7QUFDQTtBQUNBO0FBQ0EsY0FBYyxrQkFBa0I7QUFDaEM7QUFDQTtBQUNBLGNBQWMsbUJBQW1CO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsMkNBQTJDO0FBQ3pEO0FBQ0E7QUFDQSxjQUFjLDBFQUFDLHdCQUF3QixPQUFPLHlEQUFHLGlJQUFpSTtBQUNsTDtBQUNBO0FBQ0EsY0FBYywrRUFBK0U7QUFDN0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwQ0FBYTtBQUNyQztBQUNBLGNBQWMsMEVBQUMsa0JBQWtCLE9BQU8seURBQUcsZ0RBQWdELEVBQUUsMEVBQUMsVUFBVSxPQUFPLHlEQUFHLHVCQUF1QjtBQUN6STtBQUNBO0FBQ0E7QUFDQSx5REFBeUQsNENBQWM7QUFDdkU7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxjQUFjLDBFQUFDLDJCQUEyQixPQUFPLHlEQUFHO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLGdEQUFnRDtBQUN6RDtBQUNBO0FBQ0EsNEJBQTRCLDRDQUFNO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qix5REFBMEIsQ0FBQyxFQUFFLGVBQWU7QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQiw0Q0FBTTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIseURBQTBCLENBQUMsRUFBRSxlQUFlO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLGdEQUFRO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxjQUFjLGNBQWMsY0FBYyxlQUFlLEdBQUcsSUFBSTtBQUNoRSxxQ0FBcUMseURBQVU7QUFDL0MsZ0NBQWdDLHlEQUFVO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxNQUFNO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIseURBQWE7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiw0Q0FBWSxDQUFDLDRDQUFNLENBQUMseURBQWE7QUFDbEQ7QUFDQTtBQUNBLG9DQUFvQyx5REFBYTtBQUNqRCxzQkFBc0IseURBQVU7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLFNBQVM7QUFDckIsOENBQThDLDRDQUFlO0FBQzdELG1FQUFtRSxPQUFPO0FBQzFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkscUJBQXFCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qiw0Q0FBUztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDZDQUFLLCtDQUErQyw0Q0FBZTtBQUMzRSxVQUFVLDRDQUFjO0FBQ3hCO0FBQ0EsMEJBQTBCLDRDQUFVO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MseURBQWE7QUFDNUQ7QUFDQTtBQUNBLElBQUksMENBQWM7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLE1BQU07QUFDbEI7QUFDQSxvRUFBb0UseURBQUc7QUFDdkU7QUFDQTtBQUNBLFlBQVksV0FBVztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsK0NBQWtCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLCtDQUFzQjtBQUMxQixZQUFZLDRDQUE0QztBQUN4RDtBQUNBLHVCQUF1Qiw0Q0FBUztBQUNoQztBQUNBLHFFQUFxRSw2Q0FBSztBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIseURBQTBCLENBQUMsRUFBRSxlQUFlO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBLFVBQVUsMENBQWE7QUFDdkI7QUFDQTtBQUNBLElBQUksa0RBQWtCO0FBQ3RCLElBQUksNkNBQWdCO0FBQ3BCLElBQUksMENBQWU7QUFDbkI7QUFDQTtBQUNBLElBQUksK0NBQWtCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxrREFBcUI7QUFDekIsSUFBSSw2Q0FBbUI7QUFDdkIsSUFBSSwwQ0FBa0I7QUFDdEI7QUFDQTtBQUNBLElBQUksa0RBQXFCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSw0RkFBNEYsVUFBVSxvQkFBb0IsV0FBVyxxQkFBcUIsR0FBRyxnS0FBZ0s7QUFDelUsdUNBQXVDLDRDQUFNO0FBQzdDO0FBQ0EsbURBQW1ELHlEQUFhLFVBQVUseURBQVU7QUFDcEY7QUFDQTtBQUNBLHFCQUFxQiw0Q0FBYyxDQUFDLHlEQUFhLGFBQWEseURBQWM7QUFDNUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksMEVBQUMsVUFBVSxPQUFPLHlEQUFHLFlBQVksRUFBRSwwRUFBQyxVQUFVLE9BQU8seURBQUcsa0JBQWtCLEVBQUUsMEVBQUMsYUFBYSxPQUFPLHlEQUFHO0FBQ2hIO0FBQ0EsZ0NBQWdDLEdBQUcsMEVBQUMsVUFBVSwyRkFBMkYseURBQVUsS0FBSyx5REFBVSwrR0FBK0csQ0FBQyx5REFBRyxnQkFBZ0IseURBQUcseUJBQXlCO0FBQ2pVLGdCQUFnQixnQ0FBZ0M7QUFDaEQsaUJBQWlCLGlDQUFpQztBQUNsRCxPQUFPO0FBQ1A7QUFDQSxzQ0FBc0MsSUFBSSwwRUFBQyxVQUFVLE9BQU8seURBQUcsb0JBQW9CLEVBQUUsMEVBQUMsa0NBQWtDLE9BQU8seURBQUcsaURBQWlELEdBQUcsMEVBQUMsVUFBVSxPQUFPLHlEQUFHLFVBQVUsRUFBRSwwRUFBQyxVQUFVLE9BQU8seURBQUcsa0JBQWtCLEVBQUUsMEVBQUMsYUFBYSxTQUFTLENBQUMseURBQUcsaUJBQWlCLHlEQUFHLG1CQUFtQjtBQUNsVTtBQUNBLCtCQUErQixHQUFHLDBFQUFDLFVBQVUsNkNBQTZDLHlEQUFVLG1FQUFtRSx5REFBYSx5QkFBeUIsQ0FBQyx5REFBRyxnQkFBZ0IseURBQUcsa0JBQWtCO0FBQ3RQLGdCQUFnQixvQkFBb0I7QUFDcEMsaUJBQWlCLHFCQUFxQjtBQUN0QyxPQUFPO0FBQ1A7QUFDQSwrQkFBK0Isb0JBQW9CLDBFQUFDLFVBQVUsT0FBTyx5REFBRyxrQkFBa0IsRUFBRSwwRUFBQyxhQUFhLFNBQVMsQ0FBQyx5REFBRyxpQkFBaUIseURBQUcsdUJBQXVCO0FBQ2xLO0FBQ0EsbUNBQW1DLEdBQUcsMEVBQUMsVUFBVSxpREFBaUQseURBQWMsdUJBQXVCLHlEQUFjLGlDQUFpQyx5REFBYSw0QkFBNEIsQ0FBQyx5REFBRyxnQkFBZ0IseURBQUcsc0JBQXNCO0FBQzVRLGdCQUFnQix3QkFBd0I7QUFDeEMsaUJBQWlCLHlCQUF5QjtBQUMxQyxPQUFPO0FBQ1A7QUFDQSxtQ0FBbUMsNENBQTRDLDBFQUFDLFVBQVU7QUFDMUYsU0FBUyx5REFBRztBQUNaLFNBQVMseURBQUc7QUFDWixTQUFTLEVBQUUsMEVBQUMsVUFBVSxPQUFPLHlEQUFHLHNCQUFzQixrQkFBa0IsMEVBQUMsVUFBVSxPQUFPLHlEQUFHLGFBQWEsRUFBRSwwRUFBQyxxQ0FBcUMsMkRBQTJELHlEQUFHLDZLQUE2SywwQkFBMEIsMEVBQUMsbUJBQW1CO0FBQzNhLFNBQVMseURBQUc7QUFDWixTQUFTLHlEQUFHO0FBQ1osT0FBTyxvQ0FBb0MsRUFBRSwwRUFBQyxzQkFBc0IscUJBQXFCLGdLQUFnSywwRUFBQyxVQUFVLFNBQVMsQ0FBQyx5REFBRyw2QkFBNkIseURBQUcsbUJBQW1CLEVBQUUsMEVBQUMsVUFBVSxPQUFPLHlEQUFHLFNBQVMsRUFBRSwwRUFBQyxpQ0FBaUMsMEVBQUMsVUFBVSxPQUFPLHlEQUFHLHFCQUFxQixFQUFFLDBFQUFDLHFCQUFxQixrQ0FBa0MseURBQUcsNEpBQTRKLEdBQUcsMEVBQUMscUJBQXFCLGtDQUFrQyx5REFBRyxxSkFBcUosK0JBQStCLDBFQUFDLFVBQVUsT0FBTyx5REFBRyxjQUFjO0FBQ2g2QixxQ0FBcUMsMEVBQUMsa0NBQWtDLE9BQU8seURBQUcsaUpBQWlKO0FBQ25PO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLE1BQU0scURBQXFELE9BQU87QUFDNUc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxlQUFlO0FBQzNCLDhCQUE4Qiw0Q0FBZTtBQUM3QztBQUNBLHdCQUF3Qiw0Q0FBVztBQUNuQztBQUNBLDJDQUEyQyxVQUFVLHlCQUF5QixLQUFLO0FBQ25GO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLDRDQUFjO0FBQ3pDO0FBQ0EsMkNBQTJDLGFBQWEseUJBQXlCLEtBQUs7QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxjQUFjLFVBQVUsT0FBTyxHQUFHLElBQUk7QUFDbEQsaUJBQWlCLHlEQUFxQjtBQUN0QztBQUNBO0FBQ0E7QUFDQSxZQUFZLGNBQWMsVUFBVSxPQUFPLEdBQUcsSUFBSTtBQUNsRCxrQkFBa0IsNENBQWMsRUFBRSx5REFBYztBQUNoRDtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsNENBQVU7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0Msd0NBQVk7QUFDOUMsYUFBYSw0Q0FBWSxDQUFDLDRDQUFNO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsTUFBTSxJQUFJLE9BQU8sSUFBSSxjQUFjO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLDRDQUFjO0FBQ3hCO0FBQ0EsYUFBYSw0Q0FBYztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksY0FBYyxVQUFVLFFBQVEsV0FBVyxRQUFRLEdBQUcsSUFBSTtBQUN0RTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IseURBQVU7QUFDaEM7QUFDQTtBQUNBO0FBQ0EsWUFBWSxjQUFjLGNBQWMsZUFBZSxHQUFHLElBQUk7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsZUFBZTtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsT0FBTztBQUNwQyw0QkFBNEIsTUFBTTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksYUFBYTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLFFBQVE7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLGNBQWMsY0FBYyxlQUFlLFdBQVcsUUFBUSxHQUFHLElBQUk7QUFDakYsd0NBQXdDLHlEQUFVO0FBQ2xELDJDQUEyQyx5REFBVTtBQUNyRDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLFFBQVE7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLGNBQWMsVUFBVSxPQUFPLFdBQVcsUUFBUSxHQUFHLElBQUk7QUFDckUsZ0NBQWdDLHlEQUFxQjtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksY0FBYyxVQUFVLGVBQWUsV0FBVyxxQkFBcUIsR0FBRyxJQUFJO0FBQzFGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyw2Q0FBSztBQUNoRDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxrREFBa0QsVUFBVSxlQUFlLFdBQVcscUJBQXFCLEdBQUcsSUFBSTtBQUM5SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksUUFBUTtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksY0FBYyxVQUFVLE9BQU8sV0FBVyxRQUFRLEdBQUcsSUFBSTtBQUNyRSxjQUFjLDRDQUFjLHNCQUFzQix5REFBYztBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsMkNBQWdCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBLFVBQVUsMkNBQUs7QUFDZixVQUFVLDJDQUFLO0FBQ2Y7QUFDQTtBQUNBLDBCQUEwQiw2Q0FBSztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxjQUFjO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIseURBQVUsWUFBWSx5REFBVTtBQUNuRDtBQUNBLGdDQUFnQztBQUNoQyw0QkFBNEI7QUFDNUIsYUFBYTtBQUNiLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDhDQUFxQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsNkRBQXFCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSwyREFBcUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDRDQUFxQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsb0RBQXFCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxrREFBcUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDhDQUFxQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsZ0RBQXFCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSwyQ0FBcUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLCtDQUFxQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaURBQXFCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSw0Q0FBcUI7QUFDN0I7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7O0FBRW1EOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3gvQm5EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDc0c7QUFDN0Q7QUFDRztBQUNIOztBQUV6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLG9DQUFvQyxrQkFBa0Isb0JBQW9CLGlCQUFpQixtQkFBbUIsb0JBQW9CLGlCQUFpQixrQkFBa0IsbUJBQW1CLGlCQUFpQixnQkFBZ0IsaUJBQWlCLFFBQVEsZ0JBQWdCLG1CQUFtQixvQkFBb0IsYUFBYSx3QkFBd0IsMEJBQTBCLHdEQUF3RCx1QkFBdUIsb0NBQW9DLHVCQUF1QixnQ0FBZ0MsU0FBUyxhQUFhLGdCQUFnQixhQUFhLFNBQVMsYUFBYTs7QUFFM2xCLHdDQUF3QywwRkFBa0IsZUFBZSwrRUFBVztBQUNwRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsNkNBQUs7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx5RUFBQyxVQUFVLHFEQUFxRDtBQUM1RTtBQUNBO0FBQ0EsWUFBWSw0QkFBNEI7QUFDeEM7QUFDQSxrQkFBa0IsMENBQVc7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLHlFQUFDLENBQUMsNEVBQVEsUUFBUSx5RUFBQyxlQUFlLGFBQWEsRUFBRSx5RUFBQyxXQUFXLGlEQUFpRCxJQUFJLHlFQUFDLFdBQVcsOEJBQThCLGFBQWEsNENBQTRDLEdBQUcseUVBQUMsV0FBVywyRkFBMkY7QUFDN1U7QUFDQTtBQUNBLGdCQUFnQiw0Q0FBTTtBQUN0QixpQkFBaUIsNENBQU07QUFDdkIsWUFBWSx5RUFBQyxDQUFDLDRFQUFRLFFBQVEseUVBQUMsdUJBQXVCLHlFQUFDLGVBQWUseUVBQUMsY0FBYyxnSUFBZ0ksRUFBRSx5RUFBQyxXQUFXLGlIQUFpSCxHQUFHLHlFQUFDLFdBQVcscUtBQXFLLEtBQUsseUVBQUMsV0FBVyx3RUFBd0UsR0FBRyx5RUFBQyxXQUFXO0FBQ2huQixtRkFBbUYsYUFBYTtBQUNoRyxPQUFPLHdCQUF3QixnQkFBZ0IseUVBQUMsV0FBVywwQ0FBMEMsbURBQW1ELHdCQUF3QjtBQUNoTDtBQUNBLGFBQWE7QUFDYiwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUU0RDs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzFHNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUMrRztBQUMvRDtBQUNWOztBQUV0Qyx1RUFBdUUsY0FBYyxNQUFNLGFBQWEsZ0JBQWdCLGlCQUFpQixrQkFBa0IsY0FBYyxnQkFBZ0IsaUJBQWlCLGNBQWMsbUJBQW1CLGFBQWEsZ0JBQWdCLGlCQUFpQixpQkFBaUIsc0JBQXNCLHNDQUFzQyxpQkFBaUIsaUJBQWlCLHFCQUFxQixzQ0FBc0MsaUJBQWlCLGlCQUFpQixxQ0FBcUMsb0JBQW9CLG1CQUFtQixnQkFBZ0IsYUFBYSxTQUFTLGFBQWE7O0FBRXBtQiwwQkFBMEIsMEZBQWtCLGVBQWUsK0VBQVc7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MsbUZBQVc7QUFDakQscUNBQXFDLDJDQUFJLEdBQUc7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx5RUFBQyxDQUFDLHdFQUFJLElBQUksMkNBQTJDLEVBQUUseUVBQUMsVUFBVSx3RUFBd0UsRUFBRSx5RUFBQyxrQkFBa0IseUVBQUM7QUFDNUs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsMENBQWU7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYix1QkFBdUI7QUFDdkIsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFOEM7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDekg5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ3NHOztBQUV0RztBQUNBO0FBQ0E7O0FBRUEsdUJBQXVCLGFBQWEsc0JBQXNCLGtCQUFrQixvREFBb0QsZ0RBQWdELG9FQUFvRSxzQkFBc0IsbUNBQW1DLCtGQUErRiwwQkFBMEIsaUJBQWlCLG1CQUFtQix3Q0FBd0MsbUNBQW1DLGdCQUFnQixtQ0FBbUMsZUFBZSxtQ0FBbUMsYUFBYSx5QkFBeUIsOEJBQThCLFFBQVEsYUFBYSxZQUFZLGdCQUFnQiw2QkFBNkIsb0RBQW9ELCtCQUErQixpQ0FBaUMsOEJBQThCLDZCQUE2QiwyQkFBMkIsa0RBQWtELGlEQUFpRCw2QkFBNkIsK0JBQStCLDBCQUEwQiw2QkFBNkIsMkJBQTJCLDJDQUEyQyw2QkFBNkIsNEJBQTRCLGdCQUFnQixhQUFhLFNBQVMsYUFBYTs7QUFFOTFDLDJCQUEyQiwwRkFBa0IsZUFBZSwrRUFBVztBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx5RUFBQyxDQUFDLDRFQUFRLFFBQVEseUVBQUMsV0FBVyx3QkFBd0IsR0FBRyx5RUFBQyxrQkFBa0IseUVBQUM7QUFDekY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLHVCQUF1QjtBQUN2QixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUUrQzs7Ozs7Ozs7Ozs7Ozs7OztBQ2pKL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUM2RDs7QUFFN0Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFVBQVU7QUFDckIsV0FBVyxRQUFRO0FBQ25CLFdBQVcsUUFBUSxXQUFXO0FBQzlCLFdBQVcsU0FBUztBQUNwQjtBQUNBLFdBQVcsU0FBUztBQUNwQjtBQUNBLGFBQWEsVUFBVTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0QsbUJBQW1CO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTSwrQ0FBUTtBQUNkO0FBQ0E7QUFDQTtBQUNBLFNBQVMsK0NBQVE7QUFDakI7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUV5QiIsInNvdXJjZXMiOlsid2VicGFjazovL3N5bnZpZXcvLi9ub2RlX21vZHVsZXMvQGVzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Rpc3QvY29tcG9uZW50cy9jYWxjaXRlLWNvbG9yLXBpY2tlci5qcyIsIndlYnBhY2s6Ly9zeW52aWV3Ly4vbm9kZV9tb2R1bGVzL0Blc3JpL2NhbGNpdGUtY29tcG9uZW50cy9kaXN0L2NvbXBvbmVudHMvY29sb3ItcGlja2VyLXN3YXRjaC5qcyIsIndlYnBhY2s6Ly9zeW52aWV3Ly4vbm9kZV9tb2R1bGVzL0Blc3JpL2NhbGNpdGUtY29tcG9uZW50cy9kaXN0L2NvbXBvbmVudHMvdGFiLmpzIiwid2VicGFjazovL3N5bnZpZXcvLi9ub2RlX21vZHVsZXMvQGVzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Rpc3QvY29tcG9uZW50cy90YWJzLmpzIiwid2VicGFjazovL3N5bnZpZXcvLi9ub2RlX21vZHVsZXMvQGVzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Rpc3QvY29tcG9uZW50cy90aHJvdHRsZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1kZXNpZ24tc3lzdGVtL2Jsb2IvbWFpbi9MSUNFTlNFLm1kIGZvciBkZXRhaWxzLlxuICogdjEuNy4wXG4gKi9cbmltcG9ydCB7IHByb3h5Q3VzdG9tRWxlbWVudCwgSFRNTEVsZW1lbnQsIGNyZWF0ZUV2ZW50LCBoIH0gZnJvbSAnQHN0ZW5jaWwvY29yZS9pbnRlcm5hbC9jbGllbnQvaW5kZXguanMnO1xuaW1wb3J0IHsgYyBhcyBjb2xvciB9IGZyb20gJy4vaW5kZXgyLmpzJztcbmltcG9ydCB7IGogYXMgaXNQcmltYXJ5UG9pbnRlckJ1dHRvbiwgYiBhcyBnZXRFbGVtZW50RGlyIH0gZnJvbSAnLi9kb20uanMnO1xuaW1wb3J0IHsgQyBhcyBDU1MsIEQgYXMgREVGQVVMVF9DT0xPUiwgYSBhcyBESU1FTlNJT05TLCBIIGFzIEhTVl9MSU1JVFMsIE8gYXMgT1BBQ0lUWV9MSU1JVFMsIGIgYXMgSFVFX0xJTUlUX0NPTlNUUkFJTkVELCBTIGFzIFNDT1BFX1NJWkUsIGQgYXMgZGVmaW5lQ3VzdG9tRWxlbWVudCRjLCBjIGFzIERFRkFVTFRfU1RPUkFHRV9LRVlfUFJFRklYLCBSIGFzIFJHQl9MSU1JVFMgfSBmcm9tICcuL2NvbG9yLXBpY2tlci1oZXgtaW5wdXQuanMnO1xuaW1wb3J0IHsgQyBhcyBDU1NDb2xvck1vZGUsIG4gYXMgbm9ybWFsaXplSGV4LCBoIGFzIGhleGlmeSwgYSBhcyBhbHBoYUNvbXBhdGlibGUsIG8gYXMgb3BhY2l0eVRvQWxwaGEsIGIgYXMgYWxwaGFUb09wYWNpdHksIHAgYXMgcGFyc2VNb2RlLCBjIGFzIGNvbG9yRXF1YWwsIHQgYXMgdG9Ob25BbHBoYU1vZGUsIGQgYXMgbm9ybWFsaXplQWxwaGEsIGUgYXMgbm9ybWFsaXplQ29sb3IsIGYgYXMgdG9BbHBoYU1vZGUgfSBmcm9tICcuL3V0aWxzLmpzJztcbmltcG9ydCB7IGMgYXMgY29ubmVjdEludGVyYWN0aXZlLCBkIGFzIGRpc2Nvbm5lY3RJbnRlcmFjdGl2ZSwgdSBhcyB1cGRhdGVIb3N0SW50ZXJhY3Rpb24gfSBmcm9tICcuL2ludGVyYWN0aXZlLmpzJztcbmltcG9ydCB7IGkgYXMgaXNBY3RpdmF0aW9uS2V5IH0gZnJvbSAnLi9rZXkuanMnO1xuaW1wb3J0IHsgYyBhcyBjb21wb25lbnRGb2N1c2FibGUsIGEgYXMgc2V0VXBMb2FkYWJsZUNvbXBvbmVudCwgcyBhcyBzZXRDb21wb25lbnRMb2FkZWQgfSBmcm9tICcuL2xvYWRhYmxlLmpzJztcbmltcG9ydCB7IGMgYXMgY29ubmVjdExvY2FsaXplZCwgZCBhcyBkaXNjb25uZWN0TG9jYWxpemVkIH0gZnJvbSAnLi9sb2NhbGUuanMnO1xuaW1wb3J0IHsgciBhcyByZW1hcCwgYyBhcyBjbGFtcCwgYSBhcyBjbG9zZVRvUmFuZ2VFZGdlIH0gZnJvbSAnLi9tYXRoLmpzJztcbmltcG9ydCB7IHUgYXMgdXBkYXRlTWVzc2FnZXMsIHMgYXMgc2V0VXBNZXNzYWdlcywgYyBhcyBjb25uZWN0TWVzc2FnZXMsIGQgYXMgZGlzY29ubmVjdE1lc3NhZ2VzIH0gZnJvbSAnLi90OW4uanMnO1xuaW1wb3J0IHsgZCBhcyBkZWZpbmVDdXN0b21FbGVtZW50JGQgfSBmcm9tICcuL2J1dHRvbi5qcyc7XG5pbXBvcnQgeyBkIGFzIGRlZmluZUN1c3RvbUVsZW1lbnQkYiB9IGZyb20gJy4vY29sb3ItcGlja2VyLXN3YXRjaC5qcyc7XG5pbXBvcnQgeyBkIGFzIGRlZmluZUN1c3RvbUVsZW1lbnQkYSB9IGZyb20gJy4vaWNvbi5qcyc7XG5pbXBvcnQgeyBkIGFzIGRlZmluZUN1c3RvbUVsZW1lbnQkOSB9IGZyb20gJy4vaW5wdXQtbnVtYmVyLmpzJztcbmltcG9ydCB7IGQgYXMgZGVmaW5lQ3VzdG9tRWxlbWVudCQ4IH0gZnJvbSAnLi9pbnB1dC10ZXh0LmpzJztcbmltcG9ydCB7IGQgYXMgZGVmaW5lQ3VzdG9tRWxlbWVudCQ3IH0gZnJvbSAnLi9sb2FkZXIuanMnO1xuaW1wb3J0IHsgZCBhcyBkZWZpbmVDdXN0b21FbGVtZW50JDYgfSBmcm9tICcuL3Byb2dyZXNzLmpzJztcbmltcG9ydCB7IGQgYXMgZGVmaW5lQ3VzdG9tRWxlbWVudCQ1IH0gZnJvbSAnLi90YWIuanMnO1xuaW1wb3J0IHsgZCBhcyBkZWZpbmVDdXN0b21FbGVtZW50JDQgfSBmcm9tICcuL3RhYi1uYXYuanMnO1xuaW1wb3J0IHsgZCBhcyBkZWZpbmVDdXN0b21FbGVtZW50JDMgfSBmcm9tICcuL3RhYi10aXRsZS5qcyc7XG5pbXBvcnQgeyBkIGFzIGRlZmluZUN1c3RvbUVsZW1lbnQkMiB9IGZyb20gJy4vdGFicy5qcyc7XG5pbXBvcnQgeyB0IGFzIHRocm90dGxlIH0gZnJvbSAnLi90aHJvdHRsZS5qcyc7XG5cbmNvbnN0IGNvbG9yUGlja2VyQ3NzID0gXCI6aG9zdChbZGlzYWJsZWRdKXtjdXJzb3I6ZGVmYXVsdDstd2Via2l0LXVzZXItc2VsZWN0Om5vbmU7dXNlci1zZWxlY3Q6bm9uZTtvcGFjaXR5OnZhcigtLWNhbGNpdGUtdWktb3BhY2l0eS1kaXNhYmxlZCl9Omhvc3QoW2Rpc2FibGVkXSkgKiw6aG9zdChbZGlzYWJsZWRdKSA6OnNsb3R0ZWQoKil7cG9pbnRlci1ldmVudHM6bm9uZX06aG9zdHtkaXNwbGF5OmlubGluZS1ibG9jaztmb250LXNpemU6dmFyKC0tY2FsY2l0ZS1mb250LXNpemUtLTIpO2xpbmUtaGVpZ2h0OjFyZW07Zm9udC13ZWlnaHQ6dmFyKC0tY2FsY2l0ZS1mb250LXdlaWdodC1ub3JtYWwpfTpob3N0KFtkaXNhYmxlZF0pIDo6c2xvdHRlZChbY2FsY2l0ZS1oeWRyYXRlZF1bZGlzYWJsZWRdKSw6aG9zdChbZGlzYWJsZWRdKSBbY2FsY2l0ZS1oeWRyYXRlZF1bZGlzYWJsZWRde29wYWNpdHk6MX06aG9zdChbc2NhbGU9c10pey0tY2FsY2l0ZS1jb2xvci1waWNrZXItc3BhY2luZzo4cHh9Omhvc3QoW3NjYWxlPXNdKSAuY29udGFpbmVye2lubGluZS1zaXplOjE2MHB4fTpob3N0KFtzY2FsZT1zXSkgLnNhdmVkLWNvbG9yc3tnYXA6MC4yNXJlbTtncmlkLXRlbXBsYXRlLWNvbHVtbnM6cmVwZWF0KGF1dG8tZmlsbCwgMjBweCl9Omhvc3QoW3NjYWxlPW1dKXstLWNhbGNpdGUtY29sb3ItcGlja2VyLXNwYWNpbmc6MTJweH06aG9zdChbc2NhbGU9bV0pIC5jb250YWluZXJ7aW5saW5lLXNpemU6MjcycHh9Omhvc3QoW3NjYWxlPWxdKXstLWNhbGNpdGUtY29sb3ItcGlja2VyLXNwYWNpbmc6MTZweDtmb250LXNpemU6dmFyKC0tY2FsY2l0ZS1mb250LXNpemUtLTEpO2xpbmUtaGVpZ2h0OjFyZW19Omhvc3QoW3NjYWxlPWxdKSAuY29udGFpbmVye2lubGluZS1zaXplOjQ2NHB4fTpob3N0KFtzY2FsZT1sXSkgLnNlY3Rpb246Zmlyc3Qtb2YtdHlwZXtwYWRkaW5nLWJsb2NrLXN0YXJ0OnZhcigtLWNhbGNpdGUtY29sb3ItcGlja2VyLXNwYWNpbmcpfTpob3N0KFtzY2FsZT1sXSkgLnNhdmVkLWNvbG9yc3tncmlkLXRlbXBsYXRlLWNvbHVtbnM6cmVwZWF0KGF1dG8tZmlsbCwgMzJweCl9Omhvc3QoW3NjYWxlPWxdKSAuY29udHJvbC1zZWN0aW9ue2ZsZXgtd3JhcDpub3dyYXA7YWxpZ24taXRlbXM6YmFzZWxpbmU7ZmxleC13cmFwOndyYXB9Omhvc3QoW3NjYWxlPWxdKSAuY29sb3ItaGV4LW9wdGlvbnN7ZGlzcGxheTpmbGV4O2ZsZXgtc2hyaW5rOjE7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2p1c3RpZnktY29udGVudDpzcGFjZS1hcm91bmR9Omhvc3QoW3NjYWxlPWxdKSAuY29sb3ItbW9kZS1jb250YWluZXJ7ZmxleC1zaHJpbms6M30uY29udGFpbmVye2JhY2tncm91bmQtY29sb3I6dmFyKC0tY2FsY2l0ZS11aS1mb3JlZ3JvdW5kLTEpO2Rpc3BsYXk6aW5saW5lLWJsb2NrO2JvcmRlcjoxcHggc29saWQgdmFyKC0tY2FsY2l0ZS11aS1ib3JkZXItMSl9LmNvbnRyb2wtYW5kLXNjb3Ble3Bvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6ZmxleDtjdXJzb3I6cG9pbnRlcjt0b3VjaC1hY3Rpb246bm9uZX0uc2NvcGV7cG9pbnRlci1ldmVudHM6bm9uZTtwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4OnZhcigtLWNhbGNpdGUtYXBwLXotaW5kZXgpO2Jsb2NrLXNpemU6MXB4O2lubGluZS1zaXplOjFweDtib3JkZXItcmFkaXVzOjk5OTlweDtiYWNrZ3JvdW5kLWNvbG9yOnRyYW5zcGFyZW50O2ZvbnQtc2l6ZTp2YXIoLS1jYWxjaXRlLWZvbnQtc2l6ZS0tMSk7b3V0bGluZS1jb2xvcjp0cmFuc3BhcmVudH0uc2NvcGU6Zm9jdXN7b3V0bGluZToycHggc29saWQgdmFyKC0tY2FsY2l0ZS11aS1mb2N1cy1jb2xvciwgdmFyKC0tY2FsY2l0ZS11aS1icmFuZCkpO291dGxpbmUtb2Zmc2V0OmNhbGMoXFxuICAgICAgICAgICAgMnB4ICpcXG4gICAgICAgICAgICBjYWxjKFxcbiAgICAgICAgICAgICAgMSAtXFxuICAgICAgICAgICAgICAyICogY2xhbXAoXFxuICAgICAgICAgICAgICAgIDAsXFxuICAgICAgICAgICAgICAgIHZhcigtLWNhbGNpdGUtdWktZm9jdXMtb2Zmc2V0LWludmVydCksXFxuICAgICAgICAgICAgICAgIDFcXG4gICAgICAgICAgICAgIClcXG4gICAgICAgICAgICApXFxuICAgICAgICAgICk7b3V0bGluZS1vZmZzZXQ6MTFweH0uaGV4LWFuZC1jaGFubmVscy1ncm91cHtpbmxpbmUtc2l6ZToxMDAlfS5oZXgtYW5kLWNoYW5uZWxzLWdyb3VwLC5jb250cm9sLXNlY3Rpb257ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOnJvdztmbGV4LXdyYXA6d3JhcH0uc2VjdGlvbntwYWRkaW5nLWJsb2NrOjAgdmFyKC0tY2FsY2l0ZS1jb2xvci1waWNrZXItc3BhY2luZyk7cGFkZGluZy1pbmxpbmU6dmFyKC0tY2FsY2l0ZS1jb2xvci1waWNrZXItc3BhY2luZyl9LnNlY3Rpb246Zmlyc3Qtb2YtdHlwZXtwYWRkaW5nLWJsb2NrLXN0YXJ0OnZhcigtLWNhbGNpdGUtY29sb3ItcGlja2VyLXNwYWNpbmcpfS5zbGlkZXJze2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW47anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47bWFyZ2luLWlubGluZS1zdGFydDp2YXIoLS1jYWxjaXRlLWNvbG9yLXBpY2tlci1zcGFjaW5nKX0ucHJldmlldy1hbmQtc2xpZGVyc3tkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO3BhZGRpbmc6dmFyKC0tY2FsY2l0ZS1jb2xvci1waWNrZXItc3BhY2luZyl9LmNvbG9yLWhleC1vcHRpb25zLC5zZWN0aW9uLS1zcGxpdHtmbGV4LWdyb3c6MX0uaGVhZGVye2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47Y29sb3I6dmFyKC0tY2FsY2l0ZS11aS10ZXh0LTEpfS5jb2xvci1tb2RlLWNvbnRhaW5lcntwYWRkaW5nLWJsb2NrLXN0YXJ0OnZhcigtLWNhbGNpdGUtY29sb3ItcGlja2VyLXNwYWNpbmcpfS5jaGFubmVsc3tkaXNwbGF5OmZsZXg7cm93LWdhcDowLjEyNXJlbX0uY2hhbm5lbFtkYXRhLWNoYW5uZWwtaW5kZXg9XFxcIjNcXFwiXXtpbmxpbmUtc2l6ZToxNTlweH06aG9zdChbc2NhbGU9c10pIC5jaGFubmVsc3tmbGV4LXdyYXA6d3JhcH06aG9zdChbc2NhbGU9c10pIC5jaGFubmVse2ZsZXgtYmFzaXM6MzAlO2ZsZXgtZ3JvdzoxfTpob3N0KFtzY2FsZT1zXSkgLmNoYW5uZWxbZGF0YS1jaGFubmVsLWluZGV4PVxcXCIzXFxcIl17aW5saW5lLXNpemU6dW5zZXQ7bWFyZ2luLWlubGluZS1zdGFydDp1bnNldH06aG9zdChbc2NhbGU9bF0pIC5jaGFubmVsW2RhdGEtY2hhbm5lbC1pbmRleD1cXFwiM1xcXCJde2lubGluZS1zaXplOjEzMXB4fS5zYXZlZC1jb2xvcnN7ZGlzcGxheTpncmlkO2dhcDowLjVyZW07cGFkZGluZy1ibG9jay1zdGFydDp2YXIoLS1jYWxjaXRlLWNvbG9yLXBpY2tlci1zcGFjaW5nKTtncmlkLXRlbXBsYXRlLWNvbHVtbnM6cmVwZWF0KGF1dG8tZmlsbCwgMjRweCl9LnNhdmVkLWNvbG9ycy1idXR0b25ze2Rpc3BsYXk6ZmxleH0uc2F2ZWQtY29sb3J7b3V0bGluZS1vZmZzZXQ6MDtvdXRsaW5lLWNvbG9yOnRyYW5zcGFyZW50O2N1cnNvcjpwb2ludGVyfS5zYXZlZC1jb2xvcjpmb2N1c3tvdXRsaW5lOjJweCBzb2xpZCB2YXIoLS1jYWxjaXRlLXVpLWJyYW5kKTtvdXRsaW5lLW9mZnNldDoycHh9LnNhdmVkLWNvbG9yOmhvdmVye3RyYW5zaXRpb246b3V0bGluZS1jb2xvciB2YXIoLS1jYWxjaXRlLWludGVybmFsLWFuaW1hdGlvbi10aW1pbmctZmFzdCkgZWFzZS1pbi1vdXQ7b3V0bGluZToycHggc29saWQgdmFyKC0tY2FsY2l0ZS11aS1ib3JkZXItMik7b3V0bGluZS1vZmZzZXQ6MnB4fTpob3N0KFtoaWRkZW5dKXtkaXNwbGF5Om5vbmV9W2hpZGRlbl17ZGlzcGxheTpub25lfVwiO1xuXG5jb25zdCB0aHJvdHRsZUZvcjYwRnBzSW5NcyA9IDE2O1xuY29uc3QgQ29sb3JQaWNrZXIgPSAvKkBfX1BVUkVfXyovIHByb3h5Q3VzdG9tRWxlbWVudChjbGFzcyBleHRlbmRzIEhUTUxFbGVtZW50IHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLl9fcmVnaXN0ZXJIb3N0KCk7XG4gICAgdGhpcy5fX2F0dGFjaFNoYWRvdygpO1xuICAgIHRoaXMuY2FsY2l0ZUNvbG9yUGlja2VyQ2hhbmdlID0gY3JlYXRlRXZlbnQodGhpcywgXCJjYWxjaXRlQ29sb3JQaWNrZXJDaGFuZ2VcIiwgNik7XG4gICAgdGhpcy5jYWxjaXRlQ29sb3JQaWNrZXJJbnB1dCA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiY2FsY2l0ZUNvbG9yUGlja2VySW5wdXRcIiwgNik7XG4gICAgdGhpcy5pbnRlcm5hbENvbG9yVXBkYXRlQ29udGV4dCA9IG51bGw7XG4gICAgdGhpcy5tb2RlID0gQ1NTQ29sb3JNb2RlLkhFWDtcbiAgICB0aGlzLnNoaWZ0S2V5Q2hhbm5lbEFkanVzdG1lbnQgPSAwO1xuICAgIHRoaXMuaGFuZGxlVGFiQWN0aXZhdGUgPSAoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMuY2hhbm5lbE1vZGUgPSBldmVudC5jdXJyZW50VGFyZ2V0LmdldEF0dHJpYnV0ZShcImRhdGEtY29sb3ItbW9kZVwiKTtcbiAgICAgIHRoaXMudXBkYXRlQ2hhbm5lbHNGcm9tQ29sb3IodGhpcy5jb2xvcik7XG4gICAgfTtcbiAgICB0aGlzLmhhbmRsZUNvbG9yRmllbGRTY29wZUtleURvd24gPSAoZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IHsga2V5IH0gPSBldmVudDtcbiAgICAgIGNvbnN0IGFycm93S2V5VG9YWU9mZnNldCA9IHtcbiAgICAgICAgQXJyb3dVcDogeyB4OiAwLCB5OiAtMTAgfSxcbiAgICAgICAgQXJyb3dSaWdodDogeyB4OiAxMCwgeTogMCB9LFxuICAgICAgICBBcnJvd0Rvd246IHsgeDogMCwgeTogMTAgfSxcbiAgICAgICAgQXJyb3dMZWZ0OiB7IHg6IC0xMCwgeTogMCB9LFxuICAgICAgfTtcbiAgICAgIGlmIChhcnJvd0tleVRvWFlPZmZzZXRba2V5XSkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB0aGlzLnNjb3BlT3JpZW50YXRpb24gPSBrZXkgPT09IFwiQXJyb3dEb3duXCIgfHwga2V5ID09PSBcIkFycm93VXBcIiA/IFwidmVydGljYWxcIiA6IFwiaG9yaXpvbnRhbFwiO1xuICAgICAgICB0aGlzLmNhcHR1cmVDb2xvckZpZWxkQ29sb3IodGhpcy5jb2xvckZpZWxkU2NvcGVMZWZ0ICsgYXJyb3dLZXlUb1hZT2Zmc2V0W2tleV0ueCB8fCAwLCB0aGlzLmNvbG9yRmllbGRTY29wZVRvcCArIGFycm93S2V5VG9YWU9mZnNldFtrZXldLnkgfHwgMCwgZmFsc2UpO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5oYW5kbGVIdWVTY29wZUtleURvd24gPSAoZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IG1vZGlmaWVyID0gZXZlbnQuc2hpZnRLZXkgPyAxMCA6IDE7XG4gICAgICBjb25zdCB7IGtleSB9ID0gZXZlbnQ7XG4gICAgICBjb25zdCBhcnJvd0tleVRvWE9mZnNldCA9IHtcbiAgICAgICAgQXJyb3dVcDogMSxcbiAgICAgICAgQXJyb3dSaWdodDogMSxcbiAgICAgICAgQXJyb3dEb3duOiAtMSxcbiAgICAgICAgQXJyb3dMZWZ0OiAtMSxcbiAgICAgIH07XG4gICAgICBpZiAoYXJyb3dLZXlUb1hPZmZzZXRba2V5XSkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zdCBkZWx0YSA9IGFycm93S2V5VG9YT2Zmc2V0W2tleV0gKiBtb2RpZmllcjtcbiAgICAgICAgY29uc3QgaHVlID0gdGhpcy5iYXNlQ29sb3JGaWVsZENvbG9yLmh1ZSgpO1xuICAgICAgICBjb25zdCBjb2xvciA9IHRoaXMuYmFzZUNvbG9yRmllbGRDb2xvci5odWUoaHVlICsgZGVsdGEpO1xuICAgICAgICB0aGlzLmludGVybmFsQ29sb3JTZXQoY29sb3IsIGZhbHNlKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMuaGFuZGxlSGV4SW5wdXRDaGFuZ2UgPSAoZXZlbnQpID0+IHtcbiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgY29uc3QgeyBhbGxvd0VtcHR5LCBjb2xvcjogY29sb3IkMSB9ID0gdGhpcztcbiAgICAgIGNvbnN0IGlucHV0ID0gZXZlbnQudGFyZ2V0O1xuICAgICAgY29uc3QgaGV4ID0gaW5wdXQudmFsdWU7XG4gICAgICBpZiAoYWxsb3dFbXB0eSAmJiAhaGV4KSB7XG4gICAgICAgIHRoaXMuaW50ZXJuYWxDb2xvclNldChudWxsKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3Qgbm9ybWFsaXplZEhleCA9IGNvbG9yJDEgJiYgbm9ybWFsaXplSGV4KGhleGlmeShjb2xvciQxLCBhbHBoYUNvbXBhdGlibGUodGhpcy5tb2RlKSkpO1xuICAgICAgaWYgKGhleCAhPT0gbm9ybWFsaXplZEhleCkge1xuICAgICAgICB0aGlzLmludGVybmFsQ29sb3JTZXQoY29sb3IoaGV4KSk7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLmhhbmRsZVNhdmVkQ29sb3JTZWxlY3QgPSAoZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IHN3YXRjaCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQ7XG4gICAgICB0aGlzLmludGVybmFsQ29sb3JTZXQoY29sb3Ioc3dhdGNoLmNvbG9yKSk7XG4gICAgfTtcbiAgICB0aGlzLmhhbmRsZUNoYW5uZWxJbnB1dCA9IChldmVudCkgPT4ge1xuICAgICAgY29uc3QgaW5wdXQgPSBldmVudC5jdXJyZW50VGFyZ2V0O1xuICAgICAgY29uc3QgY2hhbm5lbEluZGV4ID0gTnVtYmVyKGlucHV0LmdldEF0dHJpYnV0ZShcImRhdGEtY2hhbm5lbC1pbmRleFwiKSk7XG4gICAgICBjb25zdCBpc0FscGhhQ2hhbm5lbCA9IGNoYW5uZWxJbmRleCA9PT0gMztcbiAgICAgIGNvbnN0IGxpbWl0ID0gaXNBbHBoYUNoYW5uZWxcbiAgICAgICAgPyBPUEFDSVRZX0xJTUlUUy5tYXhcbiAgICAgICAgOiB0aGlzLmNoYW5uZWxNb2RlID09PSBcInJnYlwiXG4gICAgICAgICAgPyBSR0JfTElNSVRTW09iamVjdC5rZXlzKFJHQl9MSU1JVFMpW2NoYW5uZWxJbmRleF1dXG4gICAgICAgICAgOiBIU1ZfTElNSVRTW09iamVjdC5rZXlzKEhTVl9MSU1JVFMpW2NoYW5uZWxJbmRleF1dO1xuICAgICAgbGV0IGlucHV0VmFsdWU7XG4gICAgICBpZiAodGhpcy5hbGxvd0VtcHR5ICYmICFpbnB1dC52YWx1ZSkge1xuICAgICAgICBpbnB1dFZhbHVlID0gXCJcIjtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IE51bWJlcihpbnB1dC52YWx1ZSk7XG4gICAgICAgIGNvbnN0IGFkanVzdGVkVmFsdWUgPSB2YWx1ZSArIHRoaXMuc2hpZnRLZXlDaGFubmVsQWRqdXN0bWVudDtcbiAgICAgICAgY29uc3QgY2xhbXBlZCA9IGNsYW1wKGFkanVzdGVkVmFsdWUsIDAsIGxpbWl0KTtcbiAgICAgICAgaW5wdXRWYWx1ZSA9IGNsYW1wZWQudG9TdHJpbmcoKTtcbiAgICAgIH1cbiAgICAgIGlucHV0LnZhbHVlID0gaW5wdXRWYWx1ZTtcbiAgICB9O1xuICAgIHRoaXMuaGFuZGxlQ2hhbm5lbENoYW5nZSA9IChldmVudCkgPT4ge1xuICAgICAgY29uc3QgaW5wdXQgPSBldmVudC5jdXJyZW50VGFyZ2V0O1xuICAgICAgY29uc3QgY2hhbm5lbEluZGV4ID0gTnVtYmVyKGlucHV0LmdldEF0dHJpYnV0ZShcImRhdGEtY2hhbm5lbC1pbmRleFwiKSk7XG4gICAgICBjb25zdCBjaGFubmVscyA9IFsuLi50aGlzLmNoYW5uZWxzXTtcbiAgICAgIGNvbnN0IHNob3VsZENsZWFyQ2hhbm5lbHMgPSB0aGlzLmFsbG93RW1wdHkgJiYgIWlucHV0LnZhbHVlO1xuICAgICAgaWYgKHNob3VsZENsZWFyQ2hhbm5lbHMpIHtcbiAgICAgICAgdGhpcy5jaGFubmVscyA9IFtudWxsLCBudWxsLCBudWxsLCBudWxsXTtcbiAgICAgICAgdGhpcy5pbnRlcm5hbENvbG9yU2V0KG51bGwpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBpc0FscGhhQ2hhbm5lbCA9IGNoYW5uZWxJbmRleCA9PT0gMztcbiAgICAgIGNvbnN0IHZhbHVlID0gTnVtYmVyKGlucHV0LnZhbHVlKTtcbiAgICAgIGNoYW5uZWxzW2NoYW5uZWxJbmRleF0gPSBpc0FscGhhQ2hhbm5lbCA/IG9wYWNpdHlUb0FscGhhKHZhbHVlKSA6IHZhbHVlO1xuICAgICAgdGhpcy51cGRhdGVDb2xvckZyb21DaGFubmVscyhjaGFubmVscyk7XG4gICAgfTtcbiAgICB0aGlzLmhhbmRsZVNhdmVkQ29sb3JLZXlEb3duID0gKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoaXNBY3RpdmF0aW9uS2V5KGV2ZW50LmtleSkpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5oYW5kbGVTYXZlZENvbG9yU2VsZWN0KGV2ZW50KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMuaGFuZGxlQ29sb3JGaWVsZFBvaW50ZXJEb3duID0gKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoIWlzUHJpbWFyeVBvaW50ZXJCdXR0b24oZXZlbnQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgb2Zmc2V0WCwgb2Zmc2V0WSB9ID0gZXZlbnQ7XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcm1vdmVcIiwgdGhpcy5nbG9iYWxQb2ludGVyTW92ZUhhbmRsZXIpO1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJ1cFwiLCB0aGlzLmdsb2JhbFBvaW50ZXJVcEhhbmRsZXIsIHsgb25jZTogdHJ1ZSB9KTtcbiAgICAgIHRoaXMuYWN0aXZlQ2FudmFzSW5mbyA9IHtcbiAgICAgICAgY29udGV4dDogdGhpcy5jb2xvckZpZWxkUmVuZGVyaW5nQ29udGV4dCxcbiAgICAgICAgYm91bmRzOiB0aGlzLmNvbG9yRmllbGRSZW5kZXJpbmdDb250ZXh0LmNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgIH07XG4gICAgICB0aGlzLmNhcHR1cmVDb2xvckZpZWxkQ29sb3Iob2Zmc2V0WCwgb2Zmc2V0WSk7XG4gICAgICB0aGlzLmNvbG9yRmllbGRTY29wZU5vZGUuZm9jdXMoKTtcbiAgICB9O1xuICAgIHRoaXMuaGFuZGxlSHVlU2xpZGVyUG9pbnRlckRvd24gPSAoZXZlbnQpID0+IHtcbiAgICAgIGlmICghaXNQcmltYXJ5UG9pbnRlckJ1dHRvbihldmVudCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBvZmZzZXRYIH0gPSBldmVudDtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVybW92ZVwiLCB0aGlzLmdsb2JhbFBvaW50ZXJNb3ZlSGFuZGxlcik7XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcnVwXCIsIHRoaXMuZ2xvYmFsUG9pbnRlclVwSGFuZGxlciwgeyBvbmNlOiB0cnVlIH0pO1xuICAgICAgdGhpcy5hY3RpdmVDYW52YXNJbmZvID0ge1xuICAgICAgICBjb250ZXh0OiB0aGlzLmh1ZVNsaWRlclJlbmRlcmluZ0NvbnRleHQsXG4gICAgICAgIGJvdW5kczogdGhpcy5odWVTbGlkZXJSZW5kZXJpbmdDb250ZXh0LmNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgIH07XG4gICAgICB0aGlzLmNhcHR1cmVIdWVTbGlkZXJDb2xvcihvZmZzZXRYKTtcbiAgICAgIHRoaXMuaHVlU2NvcGVOb2RlLmZvY3VzKCk7XG4gICAgfTtcbiAgICB0aGlzLmhhbmRsZU9wYWNpdHlTbGlkZXJQb2ludGVyRG93biA9IChldmVudCkgPT4ge1xuICAgICAgaWYgKCFpc1ByaW1hcnlQb2ludGVyQnV0dG9uKGV2ZW50KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCB7IG9mZnNldFggfSA9IGV2ZW50O1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJtb3ZlXCIsIHRoaXMuZ2xvYmFsUG9pbnRlck1vdmVIYW5kbGVyKTtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVydXBcIiwgdGhpcy5nbG9iYWxQb2ludGVyVXBIYW5kbGVyLCB7IG9uY2U6IHRydWUgfSk7XG4gICAgICB0aGlzLmFjdGl2ZUNhbnZhc0luZm8gPSB7XG4gICAgICAgIGNvbnRleHQ6IHRoaXMub3BhY2l0eVNsaWRlclJlbmRlcmluZ0NvbnRleHQsXG4gICAgICAgIGJvdW5kczogdGhpcy5vcGFjaXR5U2xpZGVyUmVuZGVyaW5nQ29udGV4dC5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICB9O1xuICAgICAgdGhpcy5jYXB0dXJlT3BhY2l0eVNsaWRlclZhbHVlKG9mZnNldFgpO1xuICAgICAgdGhpcy5vcGFjaXR5U2NvcGVOb2RlLmZvY3VzKCk7XG4gICAgfTtcbiAgICB0aGlzLmdsb2JhbFBvaW50ZXJVcEhhbmRsZXIgPSAoZXZlbnQpID0+IHtcbiAgICAgIGlmICghaXNQcmltYXJ5UG9pbnRlckJ1dHRvbihldmVudCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3QgcHJldmlvdXNseURyYWdnaW5nID0gdGhpcy5hY3RpdmVDYW52YXNJbmZvO1xuICAgICAgdGhpcy5hY3RpdmVDYW52YXNJbmZvID0gbnVsbDtcbiAgICAgIHRoaXMuZHJhd0NvbG9yQ29udHJvbHMoKTtcbiAgICAgIGlmIChwcmV2aW91c2x5RHJhZ2dpbmcpIHtcbiAgICAgICAgdGhpcy5jYWxjaXRlQ29sb3JQaWNrZXJDaGFuZ2UuZW1pdCgpO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5nbG9iYWxQb2ludGVyTW92ZUhhbmRsZXIgPSAoZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IHsgYWN0aXZlQ2FudmFzSW5mbywgZWwgfSA9IHRoaXM7XG4gICAgICBpZiAoIWVsLmlzQ29ubmVjdGVkIHx8ICFhY3RpdmVDYW52YXNJbmZvKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgY29udGV4dCwgYm91bmRzIH0gPSBhY3RpdmVDYW52YXNJbmZvO1xuICAgICAgbGV0IHNhbXBsaW5nWDtcbiAgICAgIGxldCBzYW1wbGluZ1k7XG4gICAgICBjb25zdCB7IGNsaWVudFgsIGNsaWVudFkgfSA9IGV2ZW50O1xuICAgICAgaWYgKGNvbnRleHQuY2FudmFzLm1hdGNoZXMoXCI6aG92ZXJcIikpIHtcbiAgICAgICAgc2FtcGxpbmdYID0gY2xpZW50WCAtIGJvdW5kcy54O1xuICAgICAgICBzYW1wbGluZ1kgPSBjbGllbnRZIC0gYm91bmRzLnk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgLy8gc25hcCB4IGFuZCB5IHRvIHRoZSBjbG9zZXN0IGVkZ2VcbiAgICAgICAgaWYgKGNsaWVudFggPCBib3VuZHMueCArIGJvdW5kcy53aWR0aCAmJiBjbGllbnRYID4gYm91bmRzLngpIHtcbiAgICAgICAgICBzYW1wbGluZ1ggPSBjbGllbnRYIC0gYm91bmRzLng7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY2xpZW50WCA8IGJvdW5kcy54KSB7XG4gICAgICAgICAgc2FtcGxpbmdYID0gMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBzYW1wbGluZ1ggPSBib3VuZHMud2lkdGg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNsaWVudFkgPCBib3VuZHMueSArIGJvdW5kcy5oZWlnaHQgJiYgY2xpZW50WSA+IGJvdW5kcy55KSB7XG4gICAgICAgICAgc2FtcGxpbmdZID0gY2xpZW50WSAtIGJvdW5kcy55O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNsaWVudFkgPCBib3VuZHMueSkge1xuICAgICAgICAgIHNhbXBsaW5nWSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgc2FtcGxpbmdZID0gYm91bmRzLmhlaWdodDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGNvbnRleHQgPT09IHRoaXMuY29sb3JGaWVsZFJlbmRlcmluZ0NvbnRleHQpIHtcbiAgICAgICAgdGhpcy5jYXB0dXJlQ29sb3JGaWVsZENvbG9yKHNhbXBsaW5nWCwgc2FtcGxpbmdZLCBmYWxzZSk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChjb250ZXh0ID09PSB0aGlzLmh1ZVNsaWRlclJlbmRlcmluZ0NvbnRleHQpIHtcbiAgICAgICAgdGhpcy5jYXB0dXJlSHVlU2xpZGVyQ29sb3Ioc2FtcGxpbmdYKTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKGNvbnRleHQgPT09IHRoaXMub3BhY2l0eVNsaWRlclJlbmRlcmluZ0NvbnRleHQpIHtcbiAgICAgICAgdGhpcy5jYXB0dXJlT3BhY2l0eVNsaWRlclZhbHVlKHNhbXBsaW5nWCk7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLnN0b3JlQ29sb3JGaWVsZFNjb3BlID0gKG5vZGUpID0+IHtcbiAgICAgIHRoaXMuY29sb3JGaWVsZFNjb3BlTm9kZSA9IG5vZGU7XG4gICAgfTtcbiAgICB0aGlzLnN0b3JlSHVlU2NvcGUgPSAobm9kZSkgPT4ge1xuICAgICAgdGhpcy5odWVTY29wZU5vZGUgPSBub2RlO1xuICAgIH07XG4gICAgdGhpcy5yZW5kZXJDaGFubmVsc1RhYlRpdGxlID0gKGNoYW5uZWxNb2RlKSA9PiB7XG4gICAgICBjb25zdCB7IGNoYW5uZWxNb2RlOiBhY3RpdmVDaGFubmVsTW9kZSwgbWVzc2FnZXMgfSA9IHRoaXM7XG4gICAgICBjb25zdCBzZWxlY3RlZCA9IGNoYW5uZWxNb2RlID09PSBhY3RpdmVDaGFubmVsTW9kZTtcbiAgICAgIGNvbnN0IGxhYmVsID0gY2hhbm5lbE1vZGUgPT09IFwicmdiXCIgPyBtZXNzYWdlcy5yZ2IgOiBtZXNzYWdlcy5oc3Y7XG4gICAgICByZXR1cm4gKGgoXCJjYWxjaXRlLXRhYi10aXRsZVwiLCB7IGNsYXNzOiBDU1MuY29sb3JNb2RlLCBcImRhdGEtY29sb3ItbW9kZVwiOiBjaGFubmVsTW9kZSwga2V5OiBjaGFubmVsTW9kZSwgb25DYWxjaXRlVGFic0FjdGl2YXRlOiB0aGlzLmhhbmRsZVRhYkFjdGl2YXRlLCBzZWxlY3RlZDogc2VsZWN0ZWQgfSwgbGFiZWwpKTtcbiAgICB9O1xuICAgIHRoaXMucmVuZGVyQ2hhbm5lbHNUYWIgPSAoY2hhbm5lbE1vZGUpID0+IHtcbiAgICAgIGNvbnN0IHsgYWxsb3dFbXB0eSwgY2hhbm5lbE1vZGU6IGFjdGl2ZUNoYW5uZWxNb2RlLCBjaGFubmVscywgbWVzc2FnZXMsIGFscGhhQ2hhbm5lbCB9ID0gdGhpcztcbiAgICAgIGNvbnN0IHNlbGVjdGVkID0gY2hhbm5lbE1vZGUgPT09IGFjdGl2ZUNoYW5uZWxNb2RlO1xuICAgICAgY29uc3QgaXNSZ2IgPSBjaGFubmVsTW9kZSA9PT0gXCJyZ2JcIjtcbiAgICAgIGNvbnN0IGNoYW5uZWxBcmlhTGFiZWxzID0gaXNSZ2JcbiAgICAgICAgPyBbbWVzc2FnZXMucmVkLCBtZXNzYWdlcy5ncmVlbiwgbWVzc2FnZXMuYmx1ZV1cbiAgICAgICAgOiBbbWVzc2FnZXMuaHVlLCBtZXNzYWdlcy5zYXR1cmF0aW9uLCBtZXNzYWdlcy52YWx1ZV07XG4gICAgICBjb25zdCBkaXJlY3Rpb24gPSBnZXRFbGVtZW50RGlyKHRoaXMuZWwpO1xuICAgICAgY29uc3QgY2hhbm5lbHNUb1JlbmRlciA9IGFscGhhQ2hhbm5lbCA/IGNoYW5uZWxzIDogY2hhbm5lbHMuc2xpY2UoMCwgMyk7XG4gICAgICByZXR1cm4gKGgoXCJjYWxjaXRlLXRhYlwiLCB7IGNsYXNzOiBDU1MuY29udHJvbCwga2V5OiBjaGFubmVsTW9kZSwgc2VsZWN0ZWQ6IHNlbGVjdGVkIH0sIGgoXCJkaXZcIiwgeyBjbGFzczogQ1NTLmNoYW5uZWxzLCBkaXI6IFwibHRyXCIgfSwgY2hhbm5lbHNUb1JlbmRlci5tYXAoKGNoYW5uZWxWYWx1ZSwgaW5kZXgpID0+IHtcbiAgICAgICAgY29uc3QgaXNBbHBoYUNoYW5uZWwgPSBpbmRleCA9PT0gMztcbiAgICAgICAgaWYgKGlzQWxwaGFDaGFubmVsKSB7XG4gICAgICAgICAgY2hhbm5lbFZhbHVlID1cbiAgICAgICAgICAgIGFsbG93RW1wdHkgJiYgIWNoYW5uZWxWYWx1ZSA/IGNoYW5uZWxWYWx1ZSA6IGFscGhhVG9PcGFjaXR5KGNoYW5uZWxWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgLyogdGhlIGNoYW5uZWwgY29udGFpbmVyIGlzIGx0ciwgc28gd2UgYXBwbHkgdGhlIGhvc3QncyBkaXJlY3Rpb24gKi9cbiAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyQ2hhbm5lbChjaGFubmVsVmFsdWUsIGluZGV4LCBjaGFubmVsQXJpYUxhYmVsc1tpbmRleF0sIGRpcmVjdGlvbiwgaXNBbHBoYUNoYW5uZWwgPyBcIiVcIiA6IFwiXCIpO1xuICAgICAgfSkpKSk7XG4gICAgfTtcbiAgICB0aGlzLnJlbmRlckNoYW5uZWwgPSAodmFsdWUsIGluZGV4LCBhcmlhTGFiZWwsIGRpcmVjdGlvbiwgc3VmZml4KSA9PiB7XG4gICAgICByZXR1cm4gKGgoXCJjYWxjaXRlLWlucHV0LW51bWJlclwiLCB7IGNsYXNzOiBDU1MuY2hhbm5lbCwgXCJkYXRhLWNoYW5uZWwtaW5kZXhcIjogaW5kZXgsIGRpcjogZGlyZWN0aW9uLCBrZXk6IGluZGV4LCBsYWJlbDogYXJpYUxhYmVsLCBsYW5nOiB0aGlzLmVmZmVjdGl2ZUxvY2FsZSwgbnVtYmVyQnV0dG9uVHlwZTogXCJub25lXCIsIG51bWJlcmluZ1N5c3RlbTogdGhpcy5udW1iZXJpbmdTeXN0ZW0sIG9uQ2FsY2l0ZUlucHV0TnVtYmVyQ2hhbmdlOiB0aGlzLmhhbmRsZUNoYW5uZWxDaGFuZ2UsIG9uQ2FsY2l0ZUlucHV0TnVtYmVySW5wdXQ6IHRoaXMuaGFuZGxlQ2hhbm5lbElucHV0LCBvbktleURvd246IHRoaXMuaGFuZGxlS2V5RG93biwgc2NhbGU6IHRoaXMuc2NhbGUgPT09IFwibFwiID8gXCJtXCIgOiBcInNcIixcbiAgICAgICAgLy8gd29ya2Fyb3VuZCB0byBlbnN1cmUgaW5wdXQgYm9yZGVycyBvdmVybGFwIGFzIGRlc2lyZWRcbiAgICAgICAgLy8gdGhpcyBpcyBiZWNhdXNlIHRoZSBidWlsZCB0cmFuc2Zvcm1zIG1hcmdpbi1sZWZ0IHRvIGl0c1xuICAgICAgICAvLyBsb2dpY2FsLXByb3AsIHdoaWNoIGlzIHVuZGVzaXJlZCBhcyBjaGFubmVscyBhcmUgYWx3YXlzIGx0clxuICAgICAgICBzdHlsZToge1xuICAgICAgICAgIG1hcmdpbkxlZnQ6IGluZGV4ID4gMCAmJiAhKHRoaXMuc2NhbGUgPT09IFwic1wiICYmIHRoaXMuYWxwaGFDaGFubmVsICYmIGluZGV4ID09PSAzKSA/IFwiLTFweFwiIDogXCJcIixcbiAgICAgICAgfSwgc3VmZml4VGV4dDogc3VmZml4LCB2YWx1ZTogdmFsdWU/LnRvU3RyaW5nKCkgfSkpO1xuICAgIH07XG4gICAgdGhpcy5kZWxldGVDb2xvciA9ICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbG9yVG9EZWxldGUgPSBoZXhpZnkodGhpcy5jb2xvciwgdGhpcy5hbHBoYUNoYW5uZWwpO1xuICAgICAgY29uc3QgaW5TdG9yYWdlID0gdGhpcy5zYXZlZENvbG9ycy5pbmRleE9mKGNvbG9yVG9EZWxldGUpID4gLTE7XG4gICAgICBpZiAoIWluU3RvcmFnZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBzYXZlZENvbG9ycyA9IHRoaXMuc2F2ZWRDb2xvcnMuZmlsdGVyKChjb2xvcikgPT4gY29sb3IgIT09IGNvbG9yVG9EZWxldGUpO1xuICAgICAgdGhpcy5zYXZlZENvbG9ycyA9IHNhdmVkQ29sb3JzO1xuICAgICAgY29uc3Qgc3RvcmFnZUtleSA9IGAke0RFRkFVTFRfU1RPUkFHRV9LRVlfUFJFRklYfSR7dGhpcy5zdG9yYWdlSWR9YDtcbiAgICAgIGlmICh0aGlzLnN0b3JhZ2VJZCkge1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShzdG9yYWdlS2V5LCBKU09OLnN0cmluZ2lmeShzYXZlZENvbG9ycykpO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5zYXZlQ29sb3IgPSAoKSA9PiB7XG4gICAgICBjb25zdCBjb2xvclRvU2F2ZSA9IGhleGlmeSh0aGlzLmNvbG9yLCB0aGlzLmFscGhhQ2hhbm5lbCk7XG4gICAgICBjb25zdCBhbHJlYWR5U2F2ZWQgPSB0aGlzLnNhdmVkQ29sb3JzLmluZGV4T2YoY29sb3JUb1NhdmUpID4gLTE7XG4gICAgICBpZiAoYWxyZWFkeVNhdmVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHNhdmVkQ29sb3JzID0gWy4uLnRoaXMuc2F2ZWRDb2xvcnMsIGNvbG9yVG9TYXZlXTtcbiAgICAgIHRoaXMuc2F2ZWRDb2xvcnMgPSBzYXZlZENvbG9ycztcbiAgICAgIGNvbnN0IHN0b3JhZ2VLZXkgPSBgJHtERUZBVUxUX1NUT1JBR0VfS0VZX1BSRUZJWH0ke3RoaXMuc3RvcmFnZUlkfWA7XG4gICAgICBpZiAodGhpcy5zdG9yYWdlSWQpIHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oc3RvcmFnZUtleSwgSlNPTi5zdHJpbmdpZnkoc2F2ZWRDb2xvcnMpKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMuZHJhd0NvbG9yQ29udHJvbHMgPSB0aHJvdHRsZSgodHlwZSA9IFwiYWxsXCIpID0+IHtcbiAgICAgIGlmICgodHlwZSA9PT0gXCJhbGxcIiB8fCB0eXBlID09PSBcImNvbG9yLWZpZWxkXCIpICYmIHRoaXMuY29sb3JGaWVsZFJlbmRlcmluZ0NvbnRleHQpIHtcbiAgICAgICAgdGhpcy5kcmF3Q29sb3JGaWVsZCgpO1xuICAgICAgfVxuICAgICAgaWYgKCh0eXBlID09PSBcImFsbFwiIHx8IHR5cGUgPT09IFwiaHVlLXNsaWRlclwiKSAmJiB0aGlzLmh1ZVNsaWRlclJlbmRlcmluZ0NvbnRleHQpIHtcbiAgICAgICAgdGhpcy5kcmF3SHVlU2xpZGVyKCk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5hbHBoYUNoYW5uZWwgJiZcbiAgICAgICAgKHR5cGUgPT09IFwiYWxsXCIgfHwgdHlwZSA9PT0gXCJvcGFjaXR5LXNsaWRlclwiKSAmJlxuICAgICAgICB0aGlzLm9wYWNpdHlTbGlkZXJSZW5kZXJpbmdDb250ZXh0KSB7XG4gICAgICAgIHRoaXMuZHJhd09wYWNpdHlTbGlkZXIoKTtcbiAgICAgIH1cbiAgICB9LCB0aHJvdHRsZUZvcjYwRnBzSW5Ncyk7XG4gICAgdGhpcy5jYXB0dXJlQ29sb3JGaWVsZENvbG9yID0gKHgsIHksIHNraXBFcXVhbCA9IHRydWUpID0+IHtcbiAgICAgIGNvbnN0IHsgZGltZW5zaW9uczogeyBjb2xvckZpZWxkOiB7IGhlaWdodCwgd2lkdGggfSwgfSwgfSA9IHRoaXM7XG4gICAgICBjb25zdCBzYXR1cmF0aW9uID0gTWF0aC5yb3VuZCgoSFNWX0xJTUlUUy5zIC8gd2lkdGgpICogeCk7XG4gICAgICBjb25zdCB2YWx1ZSA9IE1hdGgucm91bmQoKEhTVl9MSU1JVFMudiAvIGhlaWdodCkgKiAoaGVpZ2h0IC0geSkpO1xuICAgICAgdGhpcy5pbnRlcm5hbENvbG9yU2V0KHRoaXMuYmFzZUNvbG9yRmllbGRDb2xvci5oc3YoKS5zYXR1cmF0aW9udihzYXR1cmF0aW9uKS52YWx1ZSh2YWx1ZSksIHNraXBFcXVhbCk7XG4gICAgfTtcbiAgICB0aGlzLmluaXRDb2xvckZpZWxkID0gKGNhbnZhcykgPT4ge1xuICAgICAgdGhpcy5jb2xvckZpZWxkUmVuZGVyaW5nQ29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG4gICAgICB0aGlzLnVwZGF0ZUNhbnZhc1NpemUoXCJjb2xvci1maWVsZFwiKTtcbiAgICAgIHRoaXMuZHJhd0NvbG9yQ29udHJvbHMoKTtcbiAgICB9O1xuICAgIHRoaXMuaW5pdEh1ZVNsaWRlciA9IChjYW52YXMpID0+IHtcbiAgICAgIHRoaXMuaHVlU2xpZGVyUmVuZGVyaW5nQ29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG4gICAgICB0aGlzLnVwZGF0ZUNhbnZhc1NpemUoXCJodWUtc2xpZGVyXCIpO1xuICAgICAgdGhpcy5kcmF3SHVlU2xpZGVyKCk7XG4gICAgfTtcbiAgICB0aGlzLmluaXRPcGFjaXR5U2xpZGVyID0gKGNhbnZhcykgPT4ge1xuICAgICAgaWYgKCFjYW52YXMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5vcGFjaXR5U2xpZGVyUmVuZGVyaW5nQ29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG4gICAgICB0aGlzLnVwZGF0ZUNhbnZhc1NpemUoXCJvcGFjaXR5LXNsaWRlclwiKTtcbiAgICAgIHRoaXMuZHJhd09wYWNpdHlTbGlkZXIoKTtcbiAgICB9O1xuICAgIHRoaXMuc3RvcmVPcGFjaXR5U2NvcGUgPSAobm9kZSkgPT4ge1xuICAgICAgdGhpcy5vcGFjaXR5U2NvcGVOb2RlID0gbm9kZTtcbiAgICB9O1xuICAgIHRoaXMuaGFuZGxlT3BhY2l0eVNjb3BlS2V5RG93biA9IChldmVudCkgPT4ge1xuICAgICAgY29uc3QgbW9kaWZpZXIgPSBldmVudC5zaGlmdEtleSA/IDEwIDogMTtcbiAgICAgIGNvbnN0IHsga2V5IH0gPSBldmVudDtcbiAgICAgIGNvbnN0IGFycm93S2V5VG9YT2Zmc2V0ID0ge1xuICAgICAgICBBcnJvd1VwOiAwLjAxLFxuICAgICAgICBBcnJvd1JpZ2h0OiAwLjAxLFxuICAgICAgICBBcnJvd0Rvd246IC0wLjAxLFxuICAgICAgICBBcnJvd0xlZnQ6IC0wLjAxLFxuICAgICAgfTtcbiAgICAgIGlmIChhcnJvd0tleVRvWE9mZnNldFtrZXldKSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnN0IGRlbHRhID0gYXJyb3dLZXlUb1hPZmZzZXRba2V5XSAqIG1vZGlmaWVyO1xuICAgICAgICBjb25zdCBhbHBoYSA9IHRoaXMuYmFzZUNvbG9yRmllbGRDb2xvci5hbHBoYSgpO1xuICAgICAgICBjb25zdCBjb2xvciA9IHRoaXMuYmFzZUNvbG9yRmllbGRDb2xvci5hbHBoYShhbHBoYSArIGRlbHRhKTtcbiAgICAgICAgdGhpcy5pbnRlcm5hbENvbG9yU2V0KGNvbG9yLCBmYWxzZSk7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLmFsbG93RW1wdHkgPSBmYWxzZTtcbiAgICB0aGlzLmFscGhhQ2hhbm5lbCA9IGZhbHNlO1xuICAgIHRoaXMuY2hhbm5lbHNEaXNhYmxlZCA9IGZhbHNlO1xuICAgIHRoaXMuY29sb3IgPSBERUZBVUxUX0NPTE9SO1xuICAgIHRoaXMuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB0aGlzLmZvcm1hdCA9IFwiYXV0b1wiO1xuICAgIHRoaXMuaGlkZUNoYW5uZWxzID0gZmFsc2U7XG4gICAgdGhpcy5oZXhEaXNhYmxlZCA9IGZhbHNlO1xuICAgIHRoaXMuaGlkZUhleCA9IGZhbHNlO1xuICAgIHRoaXMuaGlkZVNhdmVkID0gZmFsc2U7XG4gICAgdGhpcy5zYXZlZERpc2FibGVkID0gZmFsc2U7XG4gICAgdGhpcy5zY2FsZSA9IFwibVwiO1xuICAgIHRoaXMuc3RvcmFnZUlkID0gdW5kZWZpbmVkO1xuICAgIHRoaXMubWVzc2FnZU92ZXJyaWRlcyA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm51bWJlcmluZ1N5c3RlbSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnZhbHVlID0gbm9ybWFsaXplSGV4KGhleGlmeShERUZBVUxUX0NPTE9SLCB0aGlzLmFscGhhQ2hhbm5lbCkpO1xuICAgIHRoaXMuZGVmYXVsdE1lc3NhZ2VzID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuY2hhbm5lbE1vZGUgPSBcInJnYlwiO1xuICAgIHRoaXMuY2hhbm5lbHMgPSB0aGlzLnRvQ2hhbm5lbHMoREVGQVVMVF9DT0xPUik7XG4gICAgdGhpcy5kaW1lbnNpb25zID0gRElNRU5TSU9OUy5tO1xuICAgIHRoaXMuZWZmZWN0aXZlTG9jYWxlID0gXCJcIjtcbiAgICB0aGlzLm1lc3NhZ2VzID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuc2F2ZWRDb2xvcnMgPSBbXTtcbiAgICB0aGlzLmNvbG9yRmllbGRTY29wZVRvcCA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmNvbG9yRmllbGRTY29wZUxlZnQgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5odWVTY29wZUxlZnQgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5vcGFjaXR5U2NvcGVMZWZ0ID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuc2NvcGVPcmllbnRhdGlvbiA9IHVuZGVmaW5lZDtcbiAgfVxuICBoYW5kbGVBbHBoYUNoYW5uZWxDaGFuZ2UoYWxwaGFDaGFubmVsKSB7XG4gICAgY29uc3QgeyBmb3JtYXQgfSA9IHRoaXM7XG4gICAgaWYgKGFscGhhQ2hhbm5lbCAmJiBmb3JtYXQgIT09IFwiYXV0b1wiICYmICFhbHBoYUNvbXBhdGlibGUoZm9ybWF0KSkge1xuICAgICAgY29uc29sZS53YXJuKGBpZ25vcmluZyBhbHBoYUNoYW5uZWwgYXMgdGhlIGN1cnJlbnQgZm9ybWF0ICgke2Zvcm1hdH0pIGRvZXMgbm90IHN1cHBvcnQgYWxwaGFgKTtcbiAgICAgIHRoaXMuYWxwaGFDaGFubmVsID0gZmFsc2U7XG4gICAgfVxuICB9XG4gIGhhbmRsZUNvbG9yQ2hhbmdlKGNvbG9yLCBvbGRDb2xvcikge1xuICAgIHRoaXMuZHJhd0NvbG9yQ29udHJvbHMoKTtcbiAgICB0aGlzLnVwZGF0ZUNoYW5uZWxzRnJvbUNvbG9yKGNvbG9yKTtcbiAgICB0aGlzLnByZXZpb3VzQ29sb3IgPSBvbGRDb2xvcjtcbiAgfVxuICBoYW5kbGVGb3JtYXRPckFscGhhQ2hhbm5lbENoYW5nZSgpIHtcbiAgICB0aGlzLnNldE1vZGUodGhpcy5mb3JtYXQpO1xuICAgIHRoaXMuaW50ZXJuYWxDb2xvclNldCh0aGlzLmNvbG9yLCBmYWxzZSwgXCJpbnRlcm5hbFwiKTtcbiAgfVxuICBoYW5kbGVTY2FsZUNoYW5nZShzY2FsZSA9IFwibVwiKSB7XG4gICAgdGhpcy51cGRhdGVEaW1lbnNpb25zKHNjYWxlKTtcbiAgICB0aGlzLnVwZGF0ZUNhbnZhc1NpemUoXCJhbGxcIik7XG4gICAgdGhpcy5kcmF3Q29sb3JDb250cm9scygpO1xuICB9XG4gIG9uTWVzc2FnZXNDaGFuZ2UoKSB7XG4gICAgLyogd2lyZWQgdXAgYnkgdDluIHV0aWwgKi9cbiAgfVxuICBoYW5kbGVWYWx1ZUNoYW5nZSh2YWx1ZSwgb2xkVmFsdWUpIHtcbiAgICBjb25zdCB7IGFsbG93RW1wdHksIGZvcm1hdCB9ID0gdGhpcztcbiAgICBjb25zdCBjaGVja01vZGUgPSAhYWxsb3dFbXB0eSB8fCB2YWx1ZTtcbiAgICBsZXQgbW9kZUNoYW5nZWQgPSBmYWxzZTtcbiAgICBpZiAoY2hlY2tNb2RlKSB7XG4gICAgICBjb25zdCBuZXh0TW9kZSA9IHBhcnNlTW9kZSh2YWx1ZSk7XG4gICAgICBpZiAoIW5leHRNb2RlIHx8IChmb3JtYXQgIT09IFwiYXV0b1wiICYmIG5leHRNb2RlICE9PSBmb3JtYXQpKSB7XG4gICAgICAgIHRoaXMuc2hvd0luY29tcGF0aWJsZUNvbG9yV2FybmluZyh2YWx1ZSwgZm9ybWF0KTtcbiAgICAgICAgdGhpcy52YWx1ZSA9IG9sZFZhbHVlO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBtb2RlQ2hhbmdlZCA9IHRoaXMubW9kZSAhPT0gbmV4dE1vZGU7XG4gICAgICB0aGlzLnNldE1vZGUobmV4dE1vZGUsIHRoaXMuaW50ZXJuYWxDb2xvclVwZGF0ZUNvbnRleHQgPT09IG51bGwpO1xuICAgIH1cbiAgICBjb25zdCBkcmFnZ2luZyA9IHRoaXMuYWN0aXZlQ2FudmFzSW5mbztcbiAgICBpZiAodGhpcy5pbnRlcm5hbENvbG9yVXBkYXRlQ29udGV4dCA9PT0gXCJpbml0aWFsXCIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHRoaXMuaW50ZXJuYWxDb2xvclVwZGF0ZUNvbnRleHQgPT09IFwidXNlci1pbnRlcmFjdGlvblwiKSB7XG4gICAgICB0aGlzLmNhbGNpdGVDb2xvclBpY2tlcklucHV0LmVtaXQoKTtcbiAgICAgIGlmICghZHJhZ2dpbmcpIHtcbiAgICAgICAgdGhpcy5jYWxjaXRlQ29sb3JQaWNrZXJDaGFuZ2UuZW1pdCgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBjb2xvciQxID0gYWxsb3dFbXB0eSAmJiAhdmFsdWVcbiAgICAgID8gbnVsbFxuICAgICAgOiBjb2xvcih2YWx1ZSAhPSBudWxsICYmIHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIiAmJiBhbHBoYUNvbXBhdGlibGUodGhpcy5tb2RlKVxuICAgICAgICA/IG5vcm1hbGl6ZUNvbG9yKHZhbHVlKVxuICAgICAgICA6IHZhbHVlKTtcbiAgICBjb25zdCBjb2xvckNoYW5nZWQgPSAhY29sb3JFcXVhbChjb2xvciQxLCB0aGlzLmNvbG9yKTtcbiAgICBpZiAobW9kZUNoYW5nZWQgfHwgY29sb3JDaGFuZ2VkKSB7XG4gICAgICB0aGlzLmludGVybmFsQ29sb3JTZXQoY29sb3IkMSwgdGhpcy5hbHBoYUNoYW5uZWwgJiYgISh0aGlzLm1vZGUuZW5kc1dpdGgoXCJhXCIpIHx8IHRoaXMubW9kZS5lbmRzV2l0aChcImEtY3NzXCIpKSwgXCJpbnRlcm5hbFwiKTtcbiAgICB9XG4gIH1cbiAgZ2V0IGJhc2VDb2xvckZpZWxkQ29sb3IoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29sb3IgfHwgdGhpcy5wcmV2aW91c0NvbG9yIHx8IERFRkFVTFRfQ09MT1I7XG4gIH1cbiAgZWZmZWN0aXZlTG9jYWxlQ2hhbmdlKCkge1xuICAgIHVwZGF0ZU1lc3NhZ2VzKHRoaXMsIHRoaXMuZWZmZWN0aXZlTG9jYWxlKTtcbiAgfVxuICAvLyB1c2luZyBATGlzdGVuIGFzIGEgd29ya2Fyb3VuZCBmb3IgVkRPTSBsaXN0ZW5lciBub3QgZmlyaW5nXG4gIGhhbmRsZUNoYW5uZWxLZXlVcE9yRG93bihldmVudCkge1xuICAgIHRoaXMuc2hpZnRLZXlDaGFubmVsQWRqdXN0bWVudCA9IDA7XG4gICAgY29uc3QgeyBrZXkgfSA9IGV2ZW50O1xuICAgIGlmICgoa2V5ICE9PSBcIkFycm93VXBcIiAmJiBrZXkgIT09IFwiQXJyb3dEb3duXCIpIHx8XG4gICAgICAhZXZlbnQuY29tcG9zZWRQYXRoKCkuc29tZSgobm9kZSkgPT4gbm9kZS5jbGFzc0xpc3Q/LmNvbnRhaW5zKENTUy5jaGFubmVsKSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgeyBzaGlmdEtleSB9ID0gZXZlbnQ7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBpZiAoIXRoaXMuY29sb3IpIHtcbiAgICAgIHRoaXMuaW50ZXJuYWxDb2xvclNldCh0aGlzLnByZXZpb3VzQ29sb3IpO1xuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIC8vIHRoaXMgZ2V0cyBhcHBsaWVkIHRvIHRoZSBpbnB1dCdzIHVwL2Rvd24gYXJyb3cgaW5jcmVtZW50L2RlY3JlbWVudFxuICAgIGNvbnN0IGNvbXBsZW1lbnRhcnlCdW1wID0gOTtcbiAgICB0aGlzLnNoaWZ0S2V5Q2hhbm5lbEFkanVzdG1lbnQgPVxuICAgICAga2V5ID09PSBcIkFycm93VXBcIiAmJiBzaGlmdEtleVxuICAgICAgICA/IGNvbXBsZW1lbnRhcnlCdW1wXG4gICAgICAgIDoga2V5ID09PSBcIkFycm93RG93blwiICYmIHNoaWZ0S2V5XG4gICAgICAgICAgPyAtY29tcGxlbWVudGFyeUJ1bXBcbiAgICAgICAgICA6IDA7XG4gIH1cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgUHVibGljIE1ldGhvZHNcbiAgLy9cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvKiogU2V0cyBmb2N1cyBvbiB0aGUgY29tcG9uZW50J3MgZmlyc3QgZm9jdXNhYmxlIGVsZW1lbnQuICovXG4gIGFzeW5jIHNldEZvY3VzKCkge1xuICAgIGF3YWl0IGNvbXBvbmVudEZvY3VzYWJsZSh0aGlzKTtcbiAgICB0aGlzLmVsLmZvY3VzKCk7XG4gIH1cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgTGlmZWN5Y2xlXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgYXN5bmMgY29tcG9uZW50V2lsbExvYWQoKSB7XG4gICAgc2V0VXBMb2FkYWJsZUNvbXBvbmVudCh0aGlzKTtcbiAgICBjb25zdCB7IGFsbG93RW1wdHksIGNvbG9yOiBjb2xvciQxLCBmb3JtYXQsIHZhbHVlIH0gPSB0aGlzO1xuICAgIGNvbnN0IHdpbGxTZXROb0NvbG9yID0gYWxsb3dFbXB0eSAmJiAhdmFsdWU7XG4gICAgY29uc3QgcGFyc2VkTW9kZSA9IHBhcnNlTW9kZSh2YWx1ZSk7XG4gICAgY29uc3QgdmFsdWVJc0NvbXBhdGlibGUgPSB3aWxsU2V0Tm9Db2xvciB8fCAoZm9ybWF0ID09PSBcImF1dG9cIiAmJiBwYXJzZWRNb2RlKSB8fCBmb3JtYXQgPT09IHBhcnNlZE1vZGU7XG4gICAgY29uc3QgaW5pdGlhbENvbG9yID0gd2lsbFNldE5vQ29sb3IgPyBudWxsIDogdmFsdWVJc0NvbXBhdGlibGUgPyBjb2xvcih2YWx1ZSkgOiBjb2xvciQxO1xuICAgIGlmICghdmFsdWVJc0NvbXBhdGlibGUpIHtcbiAgICAgIHRoaXMuc2hvd0luY29tcGF0aWJsZUNvbG9yV2FybmluZyh2YWx1ZSwgZm9ybWF0KTtcbiAgICB9XG4gICAgdGhpcy5zZXRNb2RlKGZvcm1hdCwgZmFsc2UpO1xuICAgIHRoaXMuaW50ZXJuYWxDb2xvclNldChpbml0aWFsQ29sb3IsIGZhbHNlLCBcImluaXRpYWxcIik7XG4gICAgdGhpcy51cGRhdGVEaW1lbnNpb25zKHRoaXMuc2NhbGUpO1xuICAgIGNvbnN0IHN0b3JhZ2VLZXkgPSBgJHtERUZBVUxUX1NUT1JBR0VfS0VZX1BSRUZJWH0ke3RoaXMuc3RvcmFnZUlkfWA7XG4gICAgaWYgKHRoaXMuc3RvcmFnZUlkICYmIGxvY2FsU3RvcmFnZS5nZXRJdGVtKHN0b3JhZ2VLZXkpKSB7XG4gICAgICB0aGlzLnNhdmVkQ29sb3JzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShzdG9yYWdlS2V5KSk7XG4gICAgfVxuICAgIGF3YWl0IHNldFVwTWVzc2FnZXModGhpcyk7XG4gIH1cbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgY29ubmVjdEludGVyYWN0aXZlKHRoaXMpO1xuICAgIGNvbm5lY3RMb2NhbGl6ZWQodGhpcyk7XG4gICAgY29ubmVjdE1lc3NhZ2VzKHRoaXMpO1xuICB9XG4gIGNvbXBvbmVudERpZExvYWQoKSB7XG4gICAgc2V0Q29tcG9uZW50TG9hZGVkKHRoaXMpO1xuICB9XG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVybW92ZVwiLCB0aGlzLmdsb2JhbFBvaW50ZXJNb3ZlSGFuZGxlcik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJ1cFwiLCB0aGlzLmdsb2JhbFBvaW50ZXJVcEhhbmRsZXIpO1xuICAgIGRpc2Nvbm5lY3RJbnRlcmFjdGl2ZSh0aGlzKTtcbiAgICBkaXNjb25uZWN0TG9jYWxpemVkKHRoaXMpO1xuICAgIGRpc2Nvbm5lY3RNZXNzYWdlcyh0aGlzKTtcbiAgfVxuICBjb21wb25lbnREaWRSZW5kZXIoKSB7XG4gICAgdXBkYXRlSG9zdEludGVyYWN0aW9uKHRoaXMpO1xuICB9XG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gIFJlbmRlciBNZXRob2RzXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgYWxsb3dFbXB0eSwgY2hhbm5lbHNEaXNhYmxlZCwgY29sb3IsIGNvbG9yRmllbGRTY29wZUxlZnQsIGNvbG9yRmllbGRTY29wZVRvcCwgZGltZW5zaW9uczogeyBzbGlkZXI6IHsgd2lkdGg6IHNsaWRlcldpZHRoIH0sIHRodW1iOiB7IHJhZGl1czogdGh1bWJSYWRpdXMgfSwgfSwgaGV4RGlzYWJsZWQsIGhpZGVDaGFubmVscywgaGlkZUhleCwgaGlkZVNhdmVkLCBodWVTY29wZUxlZnQsIG1lc3NhZ2VzLCBhbHBoYUNoYW5uZWwsIG9wYWNpdHlTY29wZUxlZnQsIHNhdmVkQ29sb3JzLCBzYXZlZERpc2FibGVkLCBzY2FsZSwgc2NvcGVPcmllbnRhdGlvbiwgfSA9IHRoaXM7XG4gICAgY29uc3Qgc2VsZWN0ZWRDb2xvckluSGV4ID0gY29sb3IgPyBoZXhpZnkoY29sb3IsIGFscGhhQ2hhbm5lbCkgOiBudWxsO1xuICAgIGNvbnN0IGh1ZVRvcCA9IHRodW1iUmFkaXVzO1xuICAgIGNvbnN0IGh1ZUxlZnQgPSBodWVTY29wZUxlZnQgPz8gKHNsaWRlcldpZHRoICogREVGQVVMVF9DT0xPUi5odWUoKSkgLyBIU1ZfTElNSVRTLmg7XG4gICAgY29uc3Qgb3BhY2l0eVRvcCA9IHRodW1iUmFkaXVzO1xuICAgIGNvbnN0IG9wYWNpdHlMZWZ0ID0gb3BhY2l0eVNjb3BlTGVmdCA/P1xuICAgICAgKHNsaWRlcldpZHRoICogYWxwaGFUb09wYWNpdHkoREVGQVVMVF9DT0xPUi5hbHBoYSgpKSkgLyBPUEFDSVRZX0xJTUlUUy5tYXg7XG4gICAgY29uc3Qgbm9Db2xvciA9IGNvbG9yID09PSBudWxsO1xuICAgIGNvbnN0IHZlcnRpY2FsID0gc2NvcGVPcmllbnRhdGlvbiA9PT0gXCJ2ZXJ0aWNhbFwiO1xuICAgIGNvbnN0IG5vSGV4ID0gaGV4RGlzYWJsZWQgfHwgaGlkZUhleDtcbiAgICBjb25zdCBub0NoYW5uZWxzID0gY2hhbm5lbHNEaXNhYmxlZCB8fCBoaWRlQ2hhbm5lbHM7XG4gICAgY29uc3Qgbm9TYXZlZCA9IHNhdmVkRGlzYWJsZWQgfHwgaGlkZVNhdmVkO1xuICAgIGNvbnN0IFthZGp1c3RlZENvbG9yRmllbGRTY29wZUxlZnQsIGFkanVzdGVkQ29sb3JGaWVsZFNjb3BlVG9wXSA9IHRoaXMuZ2V0QWRqdXN0ZWRTY29wZVBvc2l0aW9uKGNvbG9yRmllbGRTY29wZUxlZnQsIGNvbG9yRmllbGRTY29wZVRvcCk7XG4gICAgY29uc3QgW2FkanVzdGVkSHVlU2NvcGVMZWZ0LCBhZGp1c3RlZEh1ZVNjb3BlVG9wXSA9IHRoaXMuZ2V0QWRqdXN0ZWRTY29wZVBvc2l0aW9uKGh1ZUxlZnQsIGh1ZVRvcCk7XG4gICAgY29uc3QgW2FkanVzdGVkT3BhY2l0eVNjb3BlTGVmdCwgYWRqdXN0ZWRPcGFjaXR5U2NvcGVUb3BdID0gdGhpcy5nZXRBZGp1c3RlZFNjb3BlUG9zaXRpb24ob3BhY2l0eUxlZnQsIG9wYWNpdHlUb3ApO1xuICAgIHJldHVybiAoaChcImRpdlwiLCB7IGNsYXNzOiBDU1MuY29udGFpbmVyIH0sIGgoXCJkaXZcIiwgeyBjbGFzczogQ1NTLmNvbnRyb2xBbmRTY29wZSB9LCBoKFwiY2FudmFzXCIsIHsgY2xhc3M6IENTUy5jb2xvckZpZWxkLCBvblBvaW50ZXJEb3duOiB0aGlzLmhhbmRsZUNvbG9yRmllbGRQb2ludGVyRG93bixcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC9qc3gtc29ydC1wcm9wcyAtLSByZWYgc2hvdWxkIGJlIGxhc3Qgc28gbm9kZSBhdHRycy9wcm9wcyBhcmUgaW4gc3luYyAoc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtZGVzaWduLXN5c3RlbS9wdWxsLzY1MzApXG4gICAgICByZWY6IHRoaXMuaW5pdENvbG9yRmllbGQgfSksIGgoXCJkaXZcIiwgeyBcImFyaWEtbGFiZWxcIjogdmVydGljYWwgPyBtZXNzYWdlcy52YWx1ZSA6IG1lc3NhZ2VzLnNhdHVyYXRpb24sIFwiYXJpYS12YWx1ZW1heFwiOiB2ZXJ0aWNhbCA/IEhTVl9MSU1JVFMudiA6IEhTVl9MSU1JVFMucywgXCJhcmlhLXZhbHVlbWluXCI6IFwiMFwiLCBcImFyaWEtdmFsdWVub3dcIjogKHZlcnRpY2FsID8gY29sb3I/LnNhdHVyYXRpb252KCkgOiBjb2xvcj8udmFsdWUoKSkgfHwgXCIwXCIsIGNsYXNzOiB7IFtDU1Muc2NvcGVdOiB0cnVlLCBbQ1NTLmNvbG9yRmllbGRTY29wZV06IHRydWUgfSwgb25LZXlEb3duOiB0aGlzLmhhbmRsZUNvbG9yRmllbGRTY29wZUtleURvd24sIHJvbGU6IFwic2xpZGVyXCIsIHN0eWxlOiB7XG4gICAgICAgIHRvcDogYCR7YWRqdXN0ZWRDb2xvckZpZWxkU2NvcGVUb3AgfHwgMH1weGAsXG4gICAgICAgIGxlZnQ6IGAke2FkanVzdGVkQ29sb3JGaWVsZFNjb3BlTGVmdCB8fCAwfXB4YCxcbiAgICAgIH0sIHRhYmluZGV4OiBcIjBcIixcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC9qc3gtc29ydC1wcm9wcyAtLSByZWYgc2hvdWxkIGJlIGxhc3Qgc28gbm9kZSBhdHRycy9wcm9wcyBhcmUgaW4gc3luYyAoc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtZGVzaWduLXN5c3RlbS9wdWxsLzY1MzApXG4gICAgICByZWY6IHRoaXMuc3RvcmVDb2xvckZpZWxkU2NvcGUgfSkpLCBoKFwiZGl2XCIsIHsgY2xhc3M6IENTUy5wcmV2aWV3QW5kU2xpZGVycyB9LCBoKFwiY2FsY2l0ZS1jb2xvci1waWNrZXItc3dhdGNoXCIsIHsgY2xhc3M6IENTUy5wcmV2aWV3LCBjb2xvcjogc2VsZWN0ZWRDb2xvckluSGV4LCBzY2FsZTogXCJsXCIgfSksIGgoXCJkaXZcIiwgeyBjbGFzczogQ1NTLnNsaWRlcnMgfSwgaChcImRpdlwiLCB7IGNsYXNzOiBDU1MuY29udHJvbEFuZFNjb3BlIH0sIGgoXCJjYW52YXNcIiwgeyBjbGFzczogeyBbQ1NTLnNsaWRlcl06IHRydWUsIFtDU1MuaHVlU2xpZGVyXTogdHJ1ZSB9LCBvblBvaW50ZXJEb3duOiB0aGlzLmhhbmRsZUh1ZVNsaWRlclBvaW50ZXJEb3duLFxuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0L2pzeC1zb3J0LXByb3BzIC0tIHJlZiBzaG91bGQgYmUgbGFzdCBzbyBub2RlIGF0dHJzL3Byb3BzIGFyZSBpbiBzeW5jIChzZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1kZXNpZ24tc3lzdGVtL3B1bGwvNjUzMClcbiAgICAgIHJlZjogdGhpcy5pbml0SHVlU2xpZGVyIH0pLCBoKFwiZGl2XCIsIHsgXCJhcmlhLWxhYmVsXCI6IG1lc3NhZ2VzLmh1ZSwgXCJhcmlhLXZhbHVlbWF4XCI6IEhTVl9MSU1JVFMuaCwgXCJhcmlhLXZhbHVlbWluXCI6IFwiMFwiLCBcImFyaWEtdmFsdWVub3dcIjogY29sb3I/LnJvdW5kKCkuaHVlKCkgfHwgREVGQVVMVF9DT0xPUi5yb3VuZCgpLmh1ZSgpLCBjbGFzczogeyBbQ1NTLnNjb3BlXTogdHJ1ZSwgW0NTUy5odWVTY29wZV06IHRydWUgfSwgb25LZXlEb3duOiB0aGlzLmhhbmRsZUh1ZVNjb3BlS2V5RG93biwgcm9sZTogXCJzbGlkZXJcIiwgc3R5bGU6IHtcbiAgICAgICAgdG9wOiBgJHthZGp1c3RlZEh1ZVNjb3BlVG9wfXB4YCxcbiAgICAgICAgbGVmdDogYCR7YWRqdXN0ZWRIdWVTY29wZUxlZnR9cHhgLFxuICAgICAgfSwgdGFiaW5kZXg6IFwiMFwiLFxuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0L2pzeC1zb3J0LXByb3BzIC0tIHJlZiBzaG91bGQgYmUgbGFzdCBzbyBub2RlIGF0dHJzL3Byb3BzIGFyZSBpbiBzeW5jIChzZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1kZXNpZ24tc3lzdGVtL3B1bGwvNjUzMClcbiAgICAgIHJlZjogdGhpcy5zdG9yZUh1ZVNjb3BlIH0pKSwgYWxwaGFDaGFubmVsID8gKGgoXCJkaXZcIiwgeyBjbGFzczogQ1NTLmNvbnRyb2xBbmRTY29wZSB9LCBoKFwiY2FudmFzXCIsIHsgY2xhc3M6IHsgW0NTUy5zbGlkZXJdOiB0cnVlLCBbQ1NTLm9wYWNpdHlTbGlkZXJdOiB0cnVlIH0sIG9uUG9pbnRlckRvd246IHRoaXMuaGFuZGxlT3BhY2l0eVNsaWRlclBvaW50ZXJEb3duLFxuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0L2pzeC1zb3J0LXByb3BzIC0tIHJlZiBzaG91bGQgYmUgbGFzdCBzbyBub2RlIGF0dHJzL3Byb3BzIGFyZSBpbiBzeW5jIChzZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1kZXNpZ24tc3lzdGVtL3B1bGwvNjUzMClcbiAgICAgIHJlZjogdGhpcy5pbml0T3BhY2l0eVNsaWRlciB9KSwgaChcImRpdlwiLCB7IFwiYXJpYS1sYWJlbFwiOiBtZXNzYWdlcy5vcGFjaXR5LCBcImFyaWEtdmFsdWVtYXhcIjogT1BBQ0lUWV9MSU1JVFMubWF4LCBcImFyaWEtdmFsdWVtaW5cIjogT1BBQ0lUWV9MSU1JVFMubWluLCBcImFyaWEtdmFsdWVub3dcIjogKGNvbG9yIHx8IERFRkFVTFRfQ09MT1IpLnJvdW5kKCkuYWxwaGEoKSwgY2xhc3M6IHsgW0NTUy5zY29wZV06IHRydWUsIFtDU1Mub3BhY2l0eVNjb3BlXTogdHJ1ZSB9LCBvbktleURvd246IHRoaXMuaGFuZGxlT3BhY2l0eVNjb3BlS2V5RG93biwgcm9sZTogXCJzbGlkZXJcIiwgc3R5bGU6IHtcbiAgICAgICAgdG9wOiBgJHthZGp1c3RlZE9wYWNpdHlTY29wZVRvcH1weGAsXG4gICAgICAgIGxlZnQ6IGAke2FkanVzdGVkT3BhY2l0eVNjb3BlTGVmdH1weGAsXG4gICAgICB9LCB0YWJpbmRleDogXCIwXCIsXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QvanN4LXNvcnQtcHJvcHMgLS0gcmVmIHNob3VsZCBiZSBsYXN0IHNvIG5vZGUgYXR0cnMvcHJvcHMgYXJlIGluIHN5bmMgKHNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWRlc2lnbi1zeXN0ZW0vcHVsbC82NTMwKVxuICAgICAgcmVmOiB0aGlzLnN0b3JlT3BhY2l0eVNjb3BlIH0pKSkgOiBudWxsKSksIG5vSGV4ICYmIG5vQ2hhbm5lbHMgPyBudWxsIDogKGgoXCJkaXZcIiwgeyBjbGFzczoge1xuICAgICAgICBbQ1NTLmNvbnRyb2xTZWN0aW9uXTogdHJ1ZSxcbiAgICAgICAgW0NTUy5zZWN0aW9uXTogdHJ1ZSxcbiAgICAgIH0gfSwgaChcImRpdlwiLCB7IGNsYXNzOiBDU1MuaGV4QW5kQ2hhbm5lbHNHcm91cCB9LCBub0hleCA/IG51bGwgOiAoaChcImRpdlwiLCB7IGNsYXNzOiBDU1MuaGV4T3B0aW9ucyB9LCBoKFwiY2FsY2l0ZS1jb2xvci1waWNrZXItaGV4LWlucHV0XCIsIHsgYWxsb3dFbXB0eTogYWxsb3dFbXB0eSwgYWxwaGFDaGFubmVsOiBhbHBoYUNoYW5uZWwsIGNsYXNzOiBDU1MuY29udHJvbCwgbWVzc2FnZXM6IG1lc3NhZ2VzLCBudW1iZXJpbmdTeXN0ZW06IHRoaXMubnVtYmVyaW5nU3lzdGVtLCBvbkNhbGNpdGVDb2xvclBpY2tlckhleElucHV0Q2hhbmdlOiB0aGlzLmhhbmRsZUhleElucHV0Q2hhbmdlLCBzY2FsZTogc2NhbGUsIHZhbHVlOiBzZWxlY3RlZENvbG9ySW5IZXggfSkpKSwgbm9DaGFubmVscyA/IG51bGwgOiAoaChcImNhbGNpdGUtdGFic1wiLCB7IGNsYXNzOiB7XG4gICAgICAgIFtDU1MuY29sb3JNb2RlQ29udGFpbmVyXTogdHJ1ZSxcbiAgICAgICAgW0NTUy5zcGxpdFNlY3Rpb25dOiB0cnVlLFxuICAgICAgfSwgc2NhbGU6IHNjYWxlID09PSBcImxcIiA/IFwibVwiIDogXCJzXCIgfSwgaChcImNhbGNpdGUtdGFiLW5hdlwiLCB7IHNsb3Q6IFwidGl0bGUtZ3JvdXBcIiB9LCB0aGlzLnJlbmRlckNoYW5uZWxzVGFiVGl0bGUoXCJyZ2JcIiksIHRoaXMucmVuZGVyQ2hhbm5lbHNUYWJUaXRsZShcImhzdlwiKSksIHRoaXMucmVuZGVyQ2hhbm5lbHNUYWIoXCJyZ2JcIiksIHRoaXMucmVuZGVyQ2hhbm5lbHNUYWIoXCJoc3ZcIikpKSkpKSwgbm9TYXZlZCA/IG51bGwgOiAoaChcImRpdlwiLCB7IGNsYXNzOiB7IFtDU1Muc2F2ZWRDb2xvcnNTZWN0aW9uXTogdHJ1ZSwgW0NTUy5zZWN0aW9uXTogdHJ1ZSB9IH0sIGgoXCJkaXZcIiwgeyBjbGFzczogQ1NTLmhlYWRlciB9LCBoKFwibGFiZWxcIiwgbnVsbCwgbWVzc2FnZXMuc2F2ZWQpLCBoKFwiZGl2XCIsIHsgY2xhc3M6IENTUy5zYXZlZENvbG9yc0J1dHRvbnMgfSwgaChcImNhbGNpdGUtYnV0dG9uXCIsIHsgYXBwZWFyYW5jZTogXCJ0cmFuc3BhcmVudFwiLCBjbGFzczogQ1NTLmRlbGV0ZUNvbG9yLCBkaXNhYmxlZDogbm9Db2xvciwgaWNvblN0YXJ0OiBcIm1pbnVzXCIsIGtpbmQ6IFwibmV1dHJhbFwiLCBsYWJlbDogbWVzc2FnZXMuZGVsZXRlQ29sb3IsIG9uQ2xpY2s6IHRoaXMuZGVsZXRlQ29sb3IsIHNjYWxlOiBzY2FsZSwgdHlwZTogXCJidXR0b25cIiB9KSwgaChcImNhbGNpdGUtYnV0dG9uXCIsIHsgYXBwZWFyYW5jZTogXCJ0cmFuc3BhcmVudFwiLCBjbGFzczogQ1NTLnNhdmVDb2xvciwgZGlzYWJsZWQ6IG5vQ29sb3IsIGljb25TdGFydDogXCJwbHVzXCIsIGtpbmQ6IFwibmV1dHJhbFwiLCBsYWJlbDogbWVzc2FnZXMuc2F2ZUNvbG9yLCBvbkNsaWNrOiB0aGlzLnNhdmVDb2xvciwgc2NhbGU6IHNjYWxlLCB0eXBlOiBcImJ1dHRvblwiIH0pKSksIHNhdmVkQ29sb3JzLmxlbmd0aCA+IDAgPyAoaChcImRpdlwiLCB7IGNsYXNzOiBDU1Muc2F2ZWRDb2xvcnMgfSwgW1xuICAgICAgLi4uc2F2ZWRDb2xvcnMubWFwKChjb2xvcikgPT4gKGgoXCJjYWxjaXRlLWNvbG9yLXBpY2tlci1zd2F0Y2hcIiwgeyBjbGFzczogQ1NTLnNhdmVkQ29sb3IsIGNvbG9yOiBjb2xvciwga2V5OiBjb2xvciwgb25DbGljazogdGhpcy5oYW5kbGVTYXZlZENvbG9yU2VsZWN0LCBvbktleURvd246IHRoaXMuaGFuZGxlU2F2ZWRDb2xvcktleURvd24sIHNjYWxlOiBzY2FsZSwgdGFiSW5kZXg6IDAgfSkpKSxcbiAgICBdKSkgOiBudWxsKSkpKTtcbiAgfVxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgUHJpdmF0ZSBNZXRob2RzXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgaGFuZGxlS2V5RG93bihldmVudCkge1xuICAgIGlmIChldmVudC5rZXkgPT09IFwiRW50ZXJcIikge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gIH1cbiAgc2hvd0luY29tcGF0aWJsZUNvbG9yV2FybmluZyh2YWx1ZSwgZm9ybWF0KSB7XG4gICAgY29uc29sZS53YXJuKGBpZ25vcmluZyBjb2xvciB2YWx1ZSAoJHt2YWx1ZX0pIGFzIGl0IGlzIG5vdCBjb21wYXRpYmxlIHdpdGggdGhlIGN1cnJlbnQgZm9ybWF0ICgke2Zvcm1hdH0pYCk7XG4gIH1cbiAgc2V0TW9kZShmb3JtYXQsIHdhcm4gPSB0cnVlKSB7XG4gICAgY29uc3QgbW9kZSA9IGZvcm1hdCA9PT0gXCJhdXRvXCIgPyB0aGlzLm1vZGUgOiBmb3JtYXQ7XG4gICAgdGhpcy5tb2RlID0gdGhpcy5lbnN1cmVDb21wYXRpYmxlTW9kZShtb2RlLCB3YXJuKTtcbiAgfVxuICBlbnN1cmVDb21wYXRpYmxlTW9kZShtb2RlLCB3YXJuKSB7XG4gICAgY29uc3QgeyBhbHBoYUNoYW5uZWwgfSA9IHRoaXM7XG4gICAgY29uc3QgaXNBbHBoYUNvbXBhdGlibGUgPSBhbHBoYUNvbXBhdGlibGUobW9kZSk7XG4gICAgaWYgKGFscGhhQ2hhbm5lbCAmJiAhaXNBbHBoYUNvbXBhdGlibGUpIHtcbiAgICAgIGNvbnN0IGFscGhhTW9kZSA9IHRvQWxwaGFNb2RlKG1vZGUpO1xuICAgICAgaWYgKHdhcm4pIHtcbiAgICAgICAgY29uc29sZS53YXJuKGBzZXR0aW5nIGZvcm1hdCB0byAoJHthbHBoYU1vZGV9KSBhcyB0aGUgcHJvdmlkZWQgb25lICgke21vZGV9KSBkb2VzIG5vdCBzdXBwb3J0IGFscGhhYCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gYWxwaGFNb2RlO1xuICAgIH1cbiAgICBpZiAoIWFscGhhQ2hhbm5lbCAmJiBpc0FscGhhQ29tcGF0aWJsZSkge1xuICAgICAgY29uc3Qgbm9uQWxwaGFNb2RlID0gdG9Ob25BbHBoYU1vZGUobW9kZSk7XG4gICAgICBpZiAod2Fybikge1xuICAgICAgICBjb25zb2xlLndhcm4oYHNldHRpbmcgZm9ybWF0IHRvICgke25vbkFscGhhTW9kZX0pIGFzIHRoZSBwcm92aWRlZCBvbmUgKCR7bW9kZX0pIGRvZXMgbm90IHN1cHBvcnQgYWxwaGFgKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBub25BbHBoYU1vZGU7XG4gICAgfVxuICAgIHJldHVybiBtb2RlO1xuICB9XG4gIGNhcHR1cmVIdWVTbGlkZXJDb2xvcih4KSB7XG4gICAgY29uc3QgeyBkaW1lbnNpb25zOiB7IHNsaWRlcjogeyB3aWR0aCB9LCB9LCB9ID0gdGhpcztcbiAgICBjb25zdCBodWUgPSAoSFVFX0xJTUlUX0NPTlNUUkFJTkVEIC8gd2lkdGgpICogeDtcbiAgICB0aGlzLmludGVybmFsQ29sb3JTZXQodGhpcy5iYXNlQ29sb3JGaWVsZENvbG9yLmh1ZShodWUpLCBmYWxzZSk7XG4gIH1cbiAgY2FwdHVyZU9wYWNpdHlTbGlkZXJWYWx1ZSh4KSB7XG4gICAgY29uc3QgeyBkaW1lbnNpb25zOiB7IHNsaWRlcjogeyB3aWR0aCB9LCB9LCB9ID0gdGhpcztcbiAgICBjb25zdCBhbHBoYSA9IG9wYWNpdHlUb0FscGhhKChPUEFDSVRZX0xJTUlUUy5tYXggLyB3aWR0aCkgKiB4KTtcbiAgICB0aGlzLmludGVybmFsQ29sb3JTZXQodGhpcy5iYXNlQ29sb3JGaWVsZENvbG9yLmFscGhhKGFscGhhKSwgZmFsc2UpO1xuICB9XG4gIGludGVybmFsQ29sb3JTZXQoY29sb3IsIHNraXBFcXVhbCA9IHRydWUsIGNvbnRleHQgPSBcInVzZXItaW50ZXJhY3Rpb25cIikge1xuICAgIGlmIChza2lwRXF1YWwgJiYgY29sb3JFcXVhbChjb2xvciwgdGhpcy5jb2xvcikpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5pbnRlcm5hbENvbG9yVXBkYXRlQ29udGV4dCA9IGNvbnRleHQ7XG4gICAgdGhpcy5jb2xvciA9IGNvbG9yO1xuICAgIHRoaXMudmFsdWUgPSB0aGlzLnRvVmFsdWUoY29sb3IpO1xuICAgIHRoaXMuaW50ZXJuYWxDb2xvclVwZGF0ZUNvbnRleHQgPSBudWxsO1xuICB9XG4gIHRvVmFsdWUoY29sb3IsIGZvcm1hdCA9IHRoaXMubW9kZSkge1xuICAgIGlmICghY29sb3IpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCBoZXhNb2RlID0gXCJoZXhcIjtcbiAgICBpZiAoZm9ybWF0LmluY2x1ZGVzKGhleE1vZGUpKSB7XG4gICAgICBjb25zdCBoYXNBbHBoYSA9IGZvcm1hdCA9PT0gQ1NTQ29sb3JNb2RlLkhFWEE7XG4gICAgICByZXR1cm4gbm9ybWFsaXplSGV4KGhleGlmeShjb2xvci5yb3VuZCgpLCBoYXNBbHBoYSksIGhhc0FscGhhKTtcbiAgICB9XG4gICAgaWYgKGZvcm1hdC5pbmNsdWRlcyhcIi1jc3NcIikpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gY29sb3JbZm9ybWF0LnJlcGxhY2UoXCItY3NzXCIsIFwiXCIpLnJlcGxhY2UoXCJhXCIsIFwiXCIpXSgpLnJvdW5kKCkuc3RyaW5nKCk7XG4gICAgICAvLyBDb2xvciBvbWl0cyBhbHBoYSB2YWx1ZXMgd2hlbiBhbHBoYSBpcyAxXG4gICAgICBjb25zdCBuZWVkVG9JbmplY3RBbHBoYSA9IChmb3JtYXQuZW5kc1dpdGgoXCJhXCIpIHx8IGZvcm1hdC5lbmRzV2l0aChcImEtY3NzXCIpKSAmJiBjb2xvci5hbHBoYSgpID09PSAxO1xuICAgICAgaWYgKG5lZWRUb0luamVjdEFscGhhKSB7XG4gICAgICAgIGNvbnN0IG1vZGVsID0gdmFsdWUuc2xpY2UoMCwgMyk7XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IHZhbHVlLnNsaWNlKDQsIC0xKTtcbiAgICAgICAgcmV0dXJuIGAke21vZGVsfWEoJHt2YWx1ZXN9LCAke2NvbG9yLmFscGhhKCl9KWA7XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIGNvbnN0IGNvbG9yT2JqZWN0ID0gXG4gICAgLyogQ29sb3IoKSBkb2VzIG5vdCBzdXBwb3J0IGhzdmEsIGhzbGEgbm9yIHJnYmEsIHNvIHdlIHVzZSB0aGUgbm9uLWFscGhhIG1vZGUgKi9cbiAgICBjb2xvclt0b05vbkFscGhhTW9kZShmb3JtYXQpXSgpLnJvdW5kKCkub2JqZWN0KCk7XG4gICAgaWYgKGZvcm1hdC5lbmRzV2l0aChcImFcIikpIHtcbiAgICAgIHJldHVybiBub3JtYWxpemVBbHBoYShjb2xvck9iamVjdCk7XG4gICAgfVxuICAgIHJldHVybiBjb2xvck9iamVjdDtcbiAgfVxuICBnZXRTbGlkZXJDYXBTcGFjaW5nKCkge1xuICAgIGNvbnN0IHsgZGltZW5zaW9uczogeyBzbGlkZXI6IHsgaGVpZ2h0IH0sIHRodW1iOiB7IHJhZGl1cyB9LCB9LCB9ID0gdGhpcztcbiAgICByZXR1cm4gcmFkaXVzICogMiAtIGhlaWdodDtcbiAgfVxuICB1cGRhdGVEaW1lbnNpb25zKHNjYWxlID0gXCJtXCIpIHtcbiAgICB0aGlzLmRpbWVuc2lvbnMgPSBESU1FTlNJT05TW3NjYWxlXTtcbiAgfVxuICBkcmF3Q29sb3JGaWVsZCgpIHtcbiAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5jb2xvckZpZWxkUmVuZGVyaW5nQ29udGV4dDtcbiAgICBjb25zdCB7IGRpbWVuc2lvbnM6IHsgY29sb3JGaWVsZDogeyBoZWlnaHQsIHdpZHRoIH0sIH0sIH0gPSB0aGlzO1xuICAgIGNvbnRleHQuZmlsbFN0eWxlID0gdGhpcy5iYXNlQ29sb3JGaWVsZENvbG9yXG4gICAgICAuaHN2KClcbiAgICAgIC5zYXR1cmF0aW9udigxMDApXG4gICAgICAudmFsdWUoMTAwKVxuICAgICAgLmFscGhhKDEpXG4gICAgICAuc3RyaW5nKCk7XG4gICAgY29udGV4dC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICBjb25zdCB3aGl0ZUdyYWRpZW50ID0gY29udGV4dC5jcmVhdGVMaW5lYXJHcmFkaWVudCgwLCAwLCB3aWR0aCwgMCk7XG4gICAgd2hpdGVHcmFkaWVudC5hZGRDb2xvclN0b3AoMCwgXCJyZ2JhKDI1NSwyNTUsMjU1LDEpXCIpO1xuICAgIHdoaXRlR3JhZGllbnQuYWRkQ29sb3JTdG9wKDEsIFwicmdiYSgyNTUsMjU1LDI1NSwwKVwiKTtcbiAgICBjb250ZXh0LmZpbGxTdHlsZSA9IHdoaXRlR3JhZGllbnQ7XG4gICAgY29udGV4dC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICBjb25zdCBibGFja0dyYWRpZW50ID0gY29udGV4dC5jcmVhdGVMaW5lYXJHcmFkaWVudCgwLCAwLCAwLCBoZWlnaHQpO1xuICAgIGJsYWNrR3JhZGllbnQuYWRkQ29sb3JTdG9wKDAsIFwicmdiYSgwLDAsMCwwKVwiKTtcbiAgICBibGFja0dyYWRpZW50LmFkZENvbG9yU3RvcCgxLCBcInJnYmEoMCwwLDAsMSlcIik7XG4gICAgY29udGV4dC5maWxsU3R5bGUgPSBibGFja0dyYWRpZW50O1xuICAgIGNvbnRleHQuZmlsbFJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgdGhpcy5kcmF3QWN0aXZlQ29sb3JGaWVsZENvbG9yKCk7XG4gIH1cbiAgc2V0Q2FudmFzQ29udGV4dFNpemUoY2FudmFzLCB7IGhlaWdodCwgd2lkdGggfSkge1xuICAgIGlmICghY2FudmFzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGRldmljZVBpeGVsUmF0aW8gPSB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAxO1xuICAgIGNhbnZhcy53aWR0aCA9IHdpZHRoICogZGV2aWNlUGl4ZWxSYXRpbztcbiAgICBjYW52YXMuaGVpZ2h0ID0gaGVpZ2h0ICogZGV2aWNlUGl4ZWxSYXRpbztcbiAgICBjYW52YXMuc3R5bGUuaGVpZ2h0ID0gYCR7aGVpZ2h0fXB4YDtcbiAgICBjYW52YXMuc3R5bGUud2lkdGggPSBgJHt3aWR0aH1weGA7XG4gICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG4gICAgY29udGV4dC5zY2FsZShkZXZpY2VQaXhlbFJhdGlvLCBkZXZpY2VQaXhlbFJhdGlvKTtcbiAgfVxuICB1cGRhdGVDYW52YXNTaXplKGNvbnRleHQgPSBcImFsbFwiKSB7XG4gICAgY29uc3QgeyBkaW1lbnNpb25zIH0gPSB0aGlzO1xuICAgIGlmIChjb250ZXh0ID09PSBcImFsbFwiIHx8IGNvbnRleHQgPT09IFwiY29sb3ItZmllbGRcIikge1xuICAgICAgdGhpcy5zZXRDYW52YXNDb250ZXh0U2l6ZSh0aGlzLmNvbG9yRmllbGRSZW5kZXJpbmdDb250ZXh0Py5jYW52YXMsIGRpbWVuc2lvbnMuY29sb3JGaWVsZCk7XG4gICAgfVxuICAgIGNvbnN0IGFkanVzdGVkU2xpZGVyRGltZW5zaW9ucyA9IHtcbiAgICAgIHdpZHRoOiBkaW1lbnNpb25zLnNsaWRlci53aWR0aCxcbiAgICAgIGhlaWdodDogZGltZW5zaW9ucy5zbGlkZXIuaGVpZ2h0ICsgKGRpbWVuc2lvbnMudGh1bWIucmFkaXVzIC0gZGltZW5zaW9ucy5zbGlkZXIuaGVpZ2h0IC8gMikgKiAyLFxuICAgIH07XG4gICAgaWYgKGNvbnRleHQgPT09IFwiYWxsXCIgfHwgY29udGV4dCA9PT0gXCJodWUtc2xpZGVyXCIpIHtcbiAgICAgIHRoaXMuc2V0Q2FudmFzQ29udGV4dFNpemUodGhpcy5odWVTbGlkZXJSZW5kZXJpbmdDb250ZXh0Py5jYW52YXMsIGFkanVzdGVkU2xpZGVyRGltZW5zaW9ucyk7XG4gICAgfVxuICAgIGlmIChjb250ZXh0ID09PSBcImFsbFwiIHx8IGNvbnRleHQgPT09IFwib3BhY2l0eS1zbGlkZXJcIikge1xuICAgICAgdGhpcy5zZXRDYW52YXNDb250ZXh0U2l6ZSh0aGlzLm9wYWNpdHlTbGlkZXJSZW5kZXJpbmdDb250ZXh0Py5jYW52YXMsIGFkanVzdGVkU2xpZGVyRGltZW5zaW9ucyk7XG4gICAgfVxuICB9XG4gIGRyYXdBY3RpdmVDb2xvckZpZWxkQ29sb3IoKSB7XG4gICAgY29uc3QgeyBjb2xvciB9ID0gdGhpcztcbiAgICBpZiAoIWNvbG9yKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGhzdkNvbG9yID0gY29sb3IuaHN2KCk7XG4gICAgY29uc3QgeyBkaW1lbnNpb25zOiB7IGNvbG9yRmllbGQ6IHsgaGVpZ2h0LCB3aWR0aCB9LCB0aHVtYjogeyByYWRpdXMgfSwgfSwgfSA9IHRoaXM7XG4gICAgY29uc3QgeCA9IGhzdkNvbG9yLnNhdHVyYXRpb252KCkgLyAoSFNWX0xJTUlUUy5zIC8gd2lkdGgpO1xuICAgIGNvbnN0IHkgPSBoZWlnaHQgLSBoc3ZDb2xvci52YWx1ZSgpIC8gKEhTVl9MSU1JVFMudiAvIGhlaWdodCk7XG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgIHRoaXMuY29sb3JGaWVsZFNjb3BlTGVmdCA9IHg7XG4gICAgICB0aGlzLmNvbG9yRmllbGRTY29wZVRvcCA9IHk7XG4gICAgfSk7XG4gICAgdGhpcy5kcmF3VGh1bWIodGhpcy5jb2xvckZpZWxkUmVuZGVyaW5nQ29udGV4dCwgcmFkaXVzLCB4LCB5LCBoc3ZDb2xvcik7XG4gIH1cbiAgZHJhd1RodW1iKGNvbnRleHQsIHJhZGl1cywgeCwgeSwgY29sb3IpIHtcbiAgICBjb25zdCBzdGFydEFuZ2xlID0gMDtcbiAgICBjb25zdCBlbmRBbmdsZSA9IDIgKiBNYXRoLlBJO1xuICAgIGNvbnN0IG91dGxpbmVXaWR0aCA9IDE7XG4gICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICBjb250ZXh0LmFyYyh4LCB5LCByYWRpdXMsIHN0YXJ0QW5nbGUsIGVuZEFuZ2xlKTtcbiAgICBjb250ZXh0LmZpbGxTdHlsZSA9IFwiI2ZmZlwiO1xuICAgIGNvbnRleHQuZmlsbCgpO1xuICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBcInJnYmEoMCwwLDAsMC4zKVwiO1xuICAgIGNvbnRleHQubGluZVdpZHRoID0gb3V0bGluZVdpZHRoO1xuICAgIGNvbnRleHQuc3Ryb2tlKCk7XG4gICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICBjb250ZXh0LmFyYyh4LCB5LCByYWRpdXMgLSAzLCBzdGFydEFuZ2xlLCBlbmRBbmdsZSk7XG4gICAgY29udGV4dC5maWxsU3R5bGUgPSBjb2xvci5yZ2IoKS5hbHBoYSgxKS5zdHJpbmcoKTtcbiAgICBjb250ZXh0LmZpbGwoKTtcbiAgfVxuICBkcmF3QWN0aXZlSHVlU2xpZGVyQ29sb3IoKSB7XG4gICAgY29uc3QgeyBjb2xvciB9ID0gdGhpcztcbiAgICBpZiAoIWNvbG9yKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGhzdkNvbG9yID0gY29sb3IuaHN2KCkuc2F0dXJhdGlvbnYoMTAwKS52YWx1ZSgxMDApO1xuICAgIGNvbnN0IHsgZGltZW5zaW9uczogeyBzbGlkZXI6IHsgd2lkdGggfSwgdGh1bWI6IHsgcmFkaXVzIH0sIH0sIH0gPSB0aGlzO1xuICAgIGNvbnN0IHggPSBoc3ZDb2xvci5odWUoKSAvIChIVUVfTElNSVRfQ09OU1RSQUlORUQgLyB3aWR0aCk7XG4gICAgY29uc3QgeSA9IHJhZGl1cztcbiAgICBjb25zdCBzbGlkZXJCb3VuZFggPSB0aGlzLmdldFNsaWRlckJvdW5kWCh4LCB3aWR0aCwgcmFkaXVzKTtcbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgdGhpcy5odWVTY29wZUxlZnQgPSBzbGlkZXJCb3VuZFg7XG4gICAgfSk7XG4gICAgdGhpcy5kcmF3VGh1bWIodGhpcy5odWVTbGlkZXJSZW5kZXJpbmdDb250ZXh0LCByYWRpdXMsIHNsaWRlckJvdW5kWCwgeSwgaHN2Q29sb3IpO1xuICB9XG4gIGRyYXdIdWVTbGlkZXIoKSB7XG4gICAgY29uc3QgY29udGV4dCA9IHRoaXMuaHVlU2xpZGVyUmVuZGVyaW5nQ29udGV4dDtcbiAgICBjb25zdCB7IGRpbWVuc2lvbnM6IHsgc2xpZGVyOiB7IGhlaWdodCwgd2lkdGggfSwgdGh1bWI6IHsgcmFkaXVzOiB0aHVtYlJhZGl1cyB9LCB9LCB9ID0gdGhpcztcbiAgICBjb25zdCB4ID0gMDtcbiAgICBjb25zdCB5ID0gdGh1bWJSYWRpdXMgLSBoZWlnaHQgLyAyO1xuICAgIGNvbnN0IGdyYWRpZW50ID0gY29udGV4dC5jcmVhdGVMaW5lYXJHcmFkaWVudCgwLCAwLCB3aWR0aCwgMCk7XG4gICAgY29uc3QgaHVlU2xpZGVyQ29sb3JTdG9wS2V5d29yZHMgPSBbXG4gICAgICBcInJlZFwiLFxuICAgICAgXCJ5ZWxsb3dcIixcbiAgICAgIFwibGltZVwiLFxuICAgICAgXCJjeWFuXCIsXG4gICAgICBcImJsdWVcIixcbiAgICAgIFwibWFnZW50YVwiLFxuICAgICAgXCIjZmYwMDA0XCIgLyogMSB1bml0IGxlc3MgdGhhbiAjZmYwIHRvIGF2b2lkIGR1cGxpY2F0ZSB2YWx1ZXMgd2l0aGluIHJhbmdlICovLFxuICAgIF07XG4gICAgY29uc3Qgb2Zmc2V0ID0gMSAvIChodWVTbGlkZXJDb2xvclN0b3BLZXl3b3Jkcy5sZW5ndGggLSAxKTtcbiAgICBsZXQgY3VycmVudE9mZnNldCA9IDA7XG4gICAgaHVlU2xpZGVyQ29sb3JTdG9wS2V5d29yZHMuZm9yRWFjaCgoa2V5d29yZCkgPT4ge1xuICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKGN1cnJlbnRPZmZzZXQsIGNvbG9yKGtleXdvcmQpLnN0cmluZygpKTtcbiAgICAgIGN1cnJlbnRPZmZzZXQgKz0gb2Zmc2V0O1xuICAgIH0pO1xuICAgIGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQgKyB0aGlzLmdldFNsaWRlckNhcFNwYWNpbmcoKSAqIDIpO1xuICAgIHRoaXMuZHJhd1NsaWRlclBhdGgoY29udGV4dCwgaGVpZ2h0LCB3aWR0aCwgeCwgeSk7XG4gICAgY29udGV4dC5maWxsU3R5bGUgPSBncmFkaWVudDtcbiAgICBjb250ZXh0LmZpbGwoKTtcbiAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gXCJyZ2JhKDAsMCwwLDAuMylcIjtcbiAgICBjb250ZXh0LmxpbmVXaWR0aCA9IDE7XG4gICAgY29udGV4dC5zdHJva2UoKTtcbiAgICB0aGlzLmRyYXdBY3RpdmVIdWVTbGlkZXJDb2xvcigpO1xuICB9XG4gIGRyYXdPcGFjaXR5U2xpZGVyKCkge1xuICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzLm9wYWNpdHlTbGlkZXJSZW5kZXJpbmdDb250ZXh0O1xuICAgIGNvbnN0IHsgYmFzZUNvbG9yRmllbGRDb2xvcjogcHJldmlvdXNDb2xvciwgZGltZW5zaW9uczogeyBzbGlkZXI6IHsgaGVpZ2h0LCB3aWR0aCB9LCB0aHVtYjogeyByYWRpdXM6IHRodW1iUmFkaXVzIH0sIH0sIH0gPSB0aGlzO1xuICAgIGNvbnN0IHggPSAwO1xuICAgIGNvbnN0IHkgPSB0aHVtYlJhZGl1cyAtIGhlaWdodCAvIDI7XG4gICAgY29udGV4dC5jbGVhclJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCArIHRoaXMuZ2V0U2xpZGVyQ2FwU3BhY2luZygpICogMik7XG4gICAgY29uc3QgZ3JhZGllbnQgPSBjb250ZXh0LmNyZWF0ZUxpbmVhckdyYWRpZW50KDAsIHksIHdpZHRoLCAwKTtcbiAgICBjb25zdCBzdGFydENvbG9yID0gcHJldmlvdXNDb2xvci5yZ2IoKS5hbHBoYSgwKTtcbiAgICBjb25zdCBtaWRDb2xvciA9IHByZXZpb3VzQ29sb3IucmdiKCkuYWxwaGEoMC41KTtcbiAgICBjb25zdCBlbmRDb2xvciA9IHByZXZpb3VzQ29sb3IucmdiKCkuYWxwaGEoMSk7XG4gICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDAsIHN0YXJ0Q29sb3Iuc3RyaW5nKCkpO1xuICAgIGdyYWRpZW50LmFkZENvbG9yU3RvcCgwLjUsIG1pZENvbG9yLnN0cmluZygpKTtcbiAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoMSwgZW5kQ29sb3Iuc3RyaW5nKCkpO1xuICAgIHRoaXMuZHJhd1NsaWRlclBhdGgoY29udGV4dCwgaGVpZ2h0LCB3aWR0aCwgeCwgeSk7XG4gICAgY29uc3QgcGF0dGVybiA9IGNvbnRleHQuY3JlYXRlUGF0dGVybih0aGlzLmdldENoZWNrZXJlZEJhY2tncm91bmRQYXR0ZXJuKCksIFwicmVwZWF0XCIpO1xuICAgIGNvbnRleHQuZmlsbFN0eWxlID0gcGF0dGVybjtcbiAgICBjb250ZXh0LmZpbGwoKTtcbiAgICBjb250ZXh0LmZpbGxTdHlsZSA9IGdyYWRpZW50O1xuICAgIGNvbnRleHQuZmlsbCgpO1xuICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBcInJnYmEoMCwwLDAsMC4zKVwiO1xuICAgIGNvbnRleHQubGluZVdpZHRoID0gMTtcbiAgICBjb250ZXh0LnN0cm9rZSgpO1xuICAgIHRoaXMuZHJhd0FjdGl2ZU9wYWNpdHlTbGlkZXJDb2xvcigpO1xuICB9XG4gIGRyYXdTbGlkZXJQYXRoKGNvbnRleHQsIGhlaWdodCwgd2lkdGgsIHgsIHkpIHtcbiAgICBjb25zdCByYWRpdXMgPSBoZWlnaHQgLyAyICsgMTtcbiAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgIGNvbnRleHQubW92ZVRvKHggKyByYWRpdXMsIHkpO1xuICAgIGNvbnRleHQubGluZVRvKHggKyB3aWR0aCAtIHJhZGl1cywgeSk7XG4gICAgY29udGV4dC5xdWFkcmF0aWNDdXJ2ZVRvKHggKyB3aWR0aCwgeSwgeCArIHdpZHRoLCB5ICsgcmFkaXVzKTtcbiAgICBjb250ZXh0LmxpbmVUbyh4ICsgd2lkdGgsIHkgKyBoZWlnaHQgLSByYWRpdXMpO1xuICAgIGNvbnRleHQucXVhZHJhdGljQ3VydmVUbyh4ICsgd2lkdGgsIHkgKyBoZWlnaHQsIHggKyB3aWR0aCAtIHJhZGl1cywgeSArIGhlaWdodCk7XG4gICAgY29udGV4dC5saW5lVG8oeCArIHJhZGl1cywgeSArIGhlaWdodCk7XG4gICAgY29udGV4dC5xdWFkcmF0aWNDdXJ2ZVRvKHgsIHkgKyBoZWlnaHQsIHgsIHkgKyBoZWlnaHQgLSByYWRpdXMpO1xuICAgIGNvbnRleHQubGluZVRvKHgsIHkgKyByYWRpdXMpO1xuICAgIGNvbnRleHQucXVhZHJhdGljQ3VydmVUbyh4LCB5LCB4ICsgcmFkaXVzLCB5KTtcbiAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xuICB9XG4gIGdldENoZWNrZXJlZEJhY2tncm91bmRQYXR0ZXJuKCkge1xuICAgIGlmICh0aGlzLmNoZWNrZXJQYXR0ZXJuKSB7XG4gICAgICByZXR1cm4gdGhpcy5jaGVja2VyUGF0dGVybjtcbiAgICB9XG4gICAgY29uc3QgcGF0dGVybiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XG4gICAgcGF0dGVybi53aWR0aCA9IDEwO1xuICAgIHBhdHRlcm4uaGVpZ2h0ID0gMTA7XG4gICAgY29uc3QgcGF0dGVybkNvbnRleHQgPSBwYXR0ZXJuLmdldENvbnRleHQoXCIyZFwiKTtcbiAgICBwYXR0ZXJuQ29udGV4dC5maWxsU3R5bGUgPSBcIiNjY2NcIjtcbiAgICBwYXR0ZXJuQ29udGV4dC5maWxsUmVjdCgwLCAwLCAxMCwgMTApO1xuICAgIHBhdHRlcm5Db250ZXh0LmZpbGxTdHlsZSA9IFwiI2ZmZlwiO1xuICAgIHBhdHRlcm5Db250ZXh0LmZpbGxSZWN0KDAsIDAsIDUsIDUpO1xuICAgIHBhdHRlcm5Db250ZXh0LmZpbGxSZWN0KDUsIDUsIDUsIDUpO1xuICAgIHRoaXMuY2hlY2tlclBhdHRlcm4gPSBwYXR0ZXJuO1xuICAgIHJldHVybiBwYXR0ZXJuO1xuICB9XG4gIGRyYXdBY3RpdmVPcGFjaXR5U2xpZGVyQ29sb3IoKSB7XG4gICAgY29uc3QgeyBjb2xvciB9ID0gdGhpcztcbiAgICBpZiAoIWNvbG9yKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGhzdkNvbG9yID0gY29sb3I7XG4gICAgY29uc3QgeyBkaW1lbnNpb25zOiB7IHNsaWRlcjogeyB3aWR0aCB9LCB0aHVtYjogeyByYWRpdXMgfSwgfSwgfSA9IHRoaXM7XG4gICAgY29uc3QgeCA9IGFscGhhVG9PcGFjaXR5KGhzdkNvbG9yLmFscGhhKCkpIC8gKE9QQUNJVFlfTElNSVRTLm1heCAvIHdpZHRoKTtcbiAgICBjb25zdCB5ID0gcmFkaXVzO1xuICAgIGNvbnN0IHNsaWRlckJvdW5kWCA9IHRoaXMuZ2V0U2xpZGVyQm91bmRYKHgsIHdpZHRoLCByYWRpdXMpO1xuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICB0aGlzLm9wYWNpdHlTY29wZUxlZnQgPSBzbGlkZXJCb3VuZFg7XG4gICAgfSk7XG4gICAgdGhpcy5kcmF3VGh1bWIodGhpcy5vcGFjaXR5U2xpZGVyUmVuZGVyaW5nQ29udGV4dCwgcmFkaXVzLCBzbGlkZXJCb3VuZFgsIHksIGhzdkNvbG9yKTtcbiAgfVxuICBnZXRTbGlkZXJCb3VuZFgoeCwgd2lkdGgsIHJhZGl1cykge1xuICAgIGNvbnN0IGNsb3NlVG9FZGdlID0gY2xvc2VUb1JhbmdlRWRnZSh4LCB3aWR0aCwgcmFkaXVzKTtcbiAgICByZXR1cm4gY2xvc2VUb0VkZ2UgPT09IDBcbiAgICAgID8geFxuICAgICAgOiBjbG9zZVRvRWRnZSA9PT0gLTFcbiAgICAgICAgPyByZW1hcCh4LCAwLCB3aWR0aCwgcmFkaXVzLCByYWRpdXMgKiAyKVxuICAgICAgICA6IHJlbWFwKHgsIDAsIHdpZHRoLCB3aWR0aCAtIHJhZGl1cyAqIDIsIHdpZHRoIC0gcmFkaXVzKTtcbiAgfVxuICB1cGRhdGVDb2xvckZyb21DaGFubmVscyhjaGFubmVscykge1xuICAgIHRoaXMuaW50ZXJuYWxDb2xvclNldChjb2xvcihjaGFubmVscywgdGhpcy5jaGFubmVsTW9kZSkpO1xuICB9XG4gIHVwZGF0ZUNoYW5uZWxzRnJvbUNvbG9yKGNvbG9yKSB7XG4gICAgdGhpcy5jaGFubmVscyA9IGNvbG9yID8gdGhpcy50b0NoYW5uZWxzKGNvbG9yKSA6IFtudWxsLCBudWxsLCBudWxsLCBudWxsXTtcbiAgfVxuICB0b0NoYW5uZWxzKGNvbG9yKSB7XG4gICAgY29uc3QgeyBjaGFubmVsTW9kZSB9ID0gdGhpcztcbiAgICBjb25zdCBjaGFubmVscyA9IGNvbG9yW2NoYW5uZWxNb2RlXSgpXG4gICAgICAuYXJyYXkoKVxuICAgICAgLm1hcCgodmFsdWUsIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBpc0FscGhhID0gaW5kZXggPT09IDM7XG4gICAgICByZXR1cm4gaXNBbHBoYSA/IHZhbHVlIDogTWF0aC5mbG9vcih2YWx1ZSk7XG4gICAgfSk7XG4gICAgaWYgKGNoYW5uZWxzLmxlbmd0aCA9PT0gMykge1xuICAgICAgY2hhbm5lbHMucHVzaCgxKTsgLy8gQ29sb3Igb21pdHMgYWxwaGEgd2hlbiAxXG4gICAgfVxuICAgIHJldHVybiBjaGFubmVscztcbiAgfVxuICBnZXRBZGp1c3RlZFNjb3BlUG9zaXRpb24obGVmdCwgdG9wKSB7XG4gICAgcmV0dXJuIFtsZWZ0IC0gU0NPUEVfU0laRSAvIDIsIHRvcCAtIFNDT1BFX1NJWkUgLyAyXTtcbiAgfVxuICBzdGF0aWMgZ2V0IGRlbGVnYXRlc0ZvY3VzKCkgeyByZXR1cm4gdHJ1ZTsgfVxuICBzdGF0aWMgZ2V0IGFzc2V0c0RpcnMoKSB7IHJldHVybiBbXCJhc3NldHNcIl07IH1cbiAgZ2V0IGVsKCkgeyByZXR1cm4gdGhpczsgfVxuICBzdGF0aWMgZ2V0IHdhdGNoZXJzKCkgeyByZXR1cm4ge1xuICAgIFwiYWxwaGFDaGFubmVsXCI6IFtcImhhbmRsZUFscGhhQ2hhbm5lbENoYW5nZVwiLCBcImhhbmRsZUZvcm1hdE9yQWxwaGFDaGFubmVsQ2hhbmdlXCJdLFxuICAgIFwiY29sb3JcIjogW1wiaGFuZGxlQ29sb3JDaGFuZ2VcIl0sXG4gICAgXCJmb3JtYXRcIjogW1wiaGFuZGxlRm9ybWF0T3JBbHBoYUNoYW5uZWxDaGFuZ2VcIl0sXG4gICAgXCJzY2FsZVwiOiBbXCJoYW5kbGVTY2FsZUNoYW5nZVwiXSxcbiAgICBcIm1lc3NhZ2VPdmVycmlkZXNcIjogW1wib25NZXNzYWdlc0NoYW5nZVwiXSxcbiAgICBcInZhbHVlXCI6IFtcImhhbmRsZVZhbHVlQ2hhbmdlXCJdLFxuICAgIFwiZWZmZWN0aXZlTG9jYWxlXCI6IFtcImVmZmVjdGl2ZUxvY2FsZUNoYW5nZVwiXVxuICB9OyB9XG4gIHN0YXRpYyBnZXQgc3R5bGUoKSB7IHJldHVybiBjb2xvclBpY2tlckNzczsgfVxufSwgWzE3LCBcImNhbGNpdGUtY29sb3ItcGlja2VyXCIsIHtcbiAgICBcImFsbG93RW1wdHlcIjogWzUxNiwgXCJhbGxvdy1lbXB0eVwiXSxcbiAgICBcImFscGhhQ2hhbm5lbFwiOiBbNCwgXCJhbHBoYS1jaGFubmVsXCJdLFxuICAgIFwiY2hhbm5lbHNEaXNhYmxlZFwiOiBbNCwgXCJjaGFubmVscy1kaXNhYmxlZFwiXSxcbiAgICBcImNvbG9yXCI6IFsxMDQwXSxcbiAgICBcImRpc2FibGVkXCI6IFs1MTZdLFxuICAgIFwiZm9ybWF0XCI6IFs1MTNdLFxuICAgIFwiaGlkZUNoYW5uZWxzXCI6IFs1MTYsIFwiaGlkZS1jaGFubmVsc1wiXSxcbiAgICBcImhleERpc2FibGVkXCI6IFs0LCBcImhleC1kaXNhYmxlZFwiXSxcbiAgICBcImhpZGVIZXhcIjogWzUxNiwgXCJoaWRlLWhleFwiXSxcbiAgICBcImhpZGVTYXZlZFwiOiBbNTE2LCBcImhpZGUtc2F2ZWRcIl0sXG4gICAgXCJzYXZlZERpc2FibGVkXCI6IFs1MTYsIFwic2F2ZWQtZGlzYWJsZWRcIl0sXG4gICAgXCJzY2FsZVwiOiBbNTEzXSxcbiAgICBcInN0b3JhZ2VJZFwiOiBbNTEzLCBcInN0b3JhZ2UtaWRcIl0sXG4gICAgXCJtZXNzYWdlT3ZlcnJpZGVzXCI6IFsxMDQwXSxcbiAgICBcIm51bWJlcmluZ1N5c3RlbVwiOiBbNTEzLCBcIm51bWJlcmluZy1zeXN0ZW1cIl0sXG4gICAgXCJ2YWx1ZVwiOiBbMTAyNV0sXG4gICAgXCJtZXNzYWdlc1wiOiBbMTA0MF0sXG4gICAgXCJkZWZhdWx0TWVzc2FnZXNcIjogWzMyXSxcbiAgICBcImNoYW5uZWxNb2RlXCI6IFszMl0sXG4gICAgXCJjaGFubmVsc1wiOiBbMzJdLFxuICAgIFwiZGltZW5zaW9uc1wiOiBbMzJdLFxuICAgIFwiZWZmZWN0aXZlTG9jYWxlXCI6IFszMl0sXG4gICAgXCJzYXZlZENvbG9yc1wiOiBbMzJdLFxuICAgIFwiY29sb3JGaWVsZFNjb3BlVG9wXCI6IFszMl0sXG4gICAgXCJjb2xvckZpZWxkU2NvcGVMZWZ0XCI6IFszMl0sXG4gICAgXCJodWVTY29wZUxlZnRcIjogWzMyXSxcbiAgICBcIm9wYWNpdHlTY29wZUxlZnRcIjogWzMyXSxcbiAgICBcInNjb3BlT3JpZW50YXRpb25cIjogWzMyXSxcbiAgICBcInNldEZvY3VzXCI6IFs2NF1cbiAgfSwgW1syLCBcImtleWRvd25cIiwgXCJoYW5kbGVDaGFubmVsS2V5VXBPckRvd25cIl0sIFsyLCBcImtleXVwXCIsIFwiaGFuZGxlQ2hhbm5lbEtleVVwT3JEb3duXCJdXV0pO1xuZnVuY3Rpb24gZGVmaW5lQ3VzdG9tRWxlbWVudCQxKCkge1xuICBpZiAodHlwZW9mIGN1c3RvbUVsZW1lbnRzID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGNvbXBvbmVudHMgPSBbXCJjYWxjaXRlLWNvbG9yLXBpY2tlclwiLCBcImNhbGNpdGUtYnV0dG9uXCIsIFwiY2FsY2l0ZS1jb2xvci1waWNrZXItaGV4LWlucHV0XCIsIFwiY2FsY2l0ZS1jb2xvci1waWNrZXItc3dhdGNoXCIsIFwiY2FsY2l0ZS1pY29uXCIsIFwiY2FsY2l0ZS1pbnB1dC1udW1iZXJcIiwgXCJjYWxjaXRlLWlucHV0LXRleHRcIiwgXCJjYWxjaXRlLWxvYWRlclwiLCBcImNhbGNpdGUtcHJvZ3Jlc3NcIiwgXCJjYWxjaXRlLXRhYlwiLCBcImNhbGNpdGUtdGFiLW5hdlwiLCBcImNhbGNpdGUtdGFiLXRpdGxlXCIsIFwiY2FsY2l0ZS10YWJzXCJdO1xuICBjb21wb25lbnRzLmZvckVhY2godGFnTmFtZSA9PiB7IHN3aXRjaCAodGFnTmFtZSkge1xuICAgIGNhc2UgXCJjYWxjaXRlLWNvbG9yLXBpY2tlclwiOlxuICAgICAgaWYgKCFjdXN0b21FbGVtZW50cy5nZXQodGFnTmFtZSkpIHtcbiAgICAgICAgY3VzdG9tRWxlbWVudHMuZGVmaW5lKHRhZ05hbWUsIENvbG9yUGlja2VyKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJjYWxjaXRlLWJ1dHRvblwiOlxuICAgICAgaWYgKCFjdXN0b21FbGVtZW50cy5nZXQodGFnTmFtZSkpIHtcbiAgICAgICAgZGVmaW5lQ3VzdG9tRWxlbWVudCRkKCk7XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwiY2FsY2l0ZS1jb2xvci1waWNrZXItaGV4LWlucHV0XCI6XG4gICAgICBpZiAoIWN1c3RvbUVsZW1lbnRzLmdldCh0YWdOYW1lKSkge1xuICAgICAgICBkZWZpbmVDdXN0b21FbGVtZW50JGMoKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJjYWxjaXRlLWNvbG9yLXBpY2tlci1zd2F0Y2hcIjpcbiAgICAgIGlmICghY3VzdG9tRWxlbWVudHMuZ2V0KHRhZ05hbWUpKSB7XG4gICAgICAgIGRlZmluZUN1c3RvbUVsZW1lbnQkYigpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImNhbGNpdGUtaWNvblwiOlxuICAgICAgaWYgKCFjdXN0b21FbGVtZW50cy5nZXQodGFnTmFtZSkpIHtcbiAgICAgICAgZGVmaW5lQ3VzdG9tRWxlbWVudCRhKCk7XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwiY2FsY2l0ZS1pbnB1dC1udW1iZXJcIjpcbiAgICAgIGlmICghY3VzdG9tRWxlbWVudHMuZ2V0KHRhZ05hbWUpKSB7XG4gICAgICAgIGRlZmluZUN1c3RvbUVsZW1lbnQkOSgpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImNhbGNpdGUtaW5wdXQtdGV4dFwiOlxuICAgICAgaWYgKCFjdXN0b21FbGVtZW50cy5nZXQodGFnTmFtZSkpIHtcbiAgICAgICAgZGVmaW5lQ3VzdG9tRWxlbWVudCQ4KCk7XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwiY2FsY2l0ZS1sb2FkZXJcIjpcbiAgICAgIGlmICghY3VzdG9tRWxlbWVudHMuZ2V0KHRhZ05hbWUpKSB7XG4gICAgICAgIGRlZmluZUN1c3RvbUVsZW1lbnQkNygpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImNhbGNpdGUtcHJvZ3Jlc3NcIjpcbiAgICAgIGlmICghY3VzdG9tRWxlbWVudHMuZ2V0KHRhZ05hbWUpKSB7XG4gICAgICAgIGRlZmluZUN1c3RvbUVsZW1lbnQkNigpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImNhbGNpdGUtdGFiXCI6XG4gICAgICBpZiAoIWN1c3RvbUVsZW1lbnRzLmdldCh0YWdOYW1lKSkge1xuICAgICAgICBkZWZpbmVDdXN0b21FbGVtZW50JDUoKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJjYWxjaXRlLXRhYi1uYXZcIjpcbiAgICAgIGlmICghY3VzdG9tRWxlbWVudHMuZ2V0KHRhZ05hbWUpKSB7XG4gICAgICAgIGRlZmluZUN1c3RvbUVsZW1lbnQkNCgpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImNhbGNpdGUtdGFiLXRpdGxlXCI6XG4gICAgICBpZiAoIWN1c3RvbUVsZW1lbnRzLmdldCh0YWdOYW1lKSkge1xuICAgICAgICBkZWZpbmVDdXN0b21FbGVtZW50JDMoKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJjYWxjaXRlLXRhYnNcIjpcbiAgICAgIGlmICghY3VzdG9tRWxlbWVudHMuZ2V0KHRhZ05hbWUpKSB7XG4gICAgICAgIGRlZmluZUN1c3RvbUVsZW1lbnQkMigpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gIH0gfSk7XG59XG5kZWZpbmVDdXN0b21FbGVtZW50JDEoKTtcblxuY29uc3QgQ2FsY2l0ZUNvbG9yUGlja2VyID0gQ29sb3JQaWNrZXI7XG5jb25zdCBkZWZpbmVDdXN0b21FbGVtZW50ID0gZGVmaW5lQ3VzdG9tRWxlbWVudCQxO1xuXG5leHBvcnQgeyBDYWxjaXRlQ29sb3JQaWNrZXIsIGRlZmluZUN1c3RvbUVsZW1lbnQgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWRlc2lnbi1zeXN0ZW0vYmxvYi9tYWluL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2MS43LjBcbiAqL1xuaW1wb3J0IHsgcHJveHlDdXN0b21FbGVtZW50LCBIVE1MRWxlbWVudCwgaCwgRnJhZ21lbnQgfSBmcm9tICdAc3RlbmNpbC9jb3JlL2ludGVybmFsL2NsaWVudC9pbmRleC5qcyc7XG5pbXBvcnQgeyBjIGFzIGNvbG9yIH0gZnJvbSAnLi9pbmRleDIuanMnO1xuaW1wb3J0IHsgciBhcyBnZXRNb2RlTmFtZSB9IGZyb20gJy4vZG9tLmpzJztcbmltcG9ydCB7IGggYXMgaGV4aWZ5IH0gZnJvbSAnLi91dGlscy5qcyc7XG5cbmNvbnN0IENTUyA9IHtcbiAgc3dhdGNoOiBcInN3YXRjaFwiLFxuICBub0NvbG9yU3dhdGNoOiBcInN3YXRjaC0tbm8tY29sb3JcIixcbiAgY2hlY2tlcjogXCJjaGVja2VyXCIsXG59O1xuY29uc3QgQ09MT1JTID0ge1xuICBib3JkZXJMaWdodDogXCJyZ2JhKDAsIDAsIDAsIDAuMylcIixcbiAgYm9yZGVyRGFyazogXCJyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMTUpXCIsXG59O1xuY29uc3QgY2hlY2tlclNxdWFyZVNpemUgPSA0O1xuY29uc3QgQ0hFQ0tFUl9ESU1FTlNJT05TID0ge1xuICBzcXVhcmVTaXplOiBjaGVja2VyU3F1YXJlU2l6ZSxcbiAgc2l6ZTogY2hlY2tlclNxdWFyZVNpemUgKiAyLFxufTtcblxuY29uc3QgY29sb3JQaWNrZXJTd2F0Y2hDc3MgPSBcIjpob3N0e3Bvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6aW5saW5lLWZsZXh9Omhvc3QoW3NjYWxlPXNdKXtibG9jay1zaXplOjEuMjVyZW07aW5saW5lLXNpemU6MS4yNXJlbX06aG9zdChbc2NhbGU9bV0pe2Jsb2NrLXNpemU6MS41cmVtO2lubGluZS1zaXplOjEuNXJlbX06aG9zdChbc2NhbGU9bF0pe2Jsb2NrLXNpemU6MnJlbTtpbmxpbmUtc2l6ZToycmVtfS5zd2F0Y2h7b3ZlcmZsb3c6aGlkZGVuO2Jsb2NrLXNpemU6aW5oZXJpdDtpbmxpbmUtc2l6ZTppbmhlcml0fS5zd2F0Y2ggcmVjdHt0cmFuc2l0aW9uLXByb3BlcnR5OmFsbDt0cmFuc2l0aW9uLWR1cmF0aW9uOjE1MG1zO3RyYW5zaXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllcigwLjQsIDAsIDAuMiwgMSl9LnN3YXRjaC0tbm8tY29sb3IgcmVjdHtmaWxsOnZhcigtLWNhbGNpdGUtdWktZm9yZWdyb3VuZC0xKX0uc3dhdGNoLS1uby1jb2xvciBsaW5le3N0cm9rZTp2YXIoLS1jYWxjaXRlLXVpLWRhbmdlcil9LmNoZWNrZXJ7ZmlsbDojY2FjYWNhfTpob3N0KFtoaWRkZW5dKXtkaXNwbGF5Om5vbmV9W2hpZGRlbl17ZGlzcGxheTpub25lfVwiO1xuXG5jb25zdCBDb2xvclBpY2tlclN3YXRjaCA9IC8qQF9fUFVSRV9fKi8gcHJveHlDdXN0b21FbGVtZW50KGNsYXNzIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuX19yZWdpc3Rlckhvc3QoKTtcbiAgICB0aGlzLl9fYXR0YWNoU2hhZG93KCk7XG4gICAgdGhpcy5hY3RpdmUgPSBmYWxzZTtcbiAgICB0aGlzLmNvbG9yID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuc2NhbGUgPSBcIm1cIjtcbiAgfVxuICBoYW5kbGVDb2xvckNoYW5nZShjb2xvciQxKSB7XG4gICAgdGhpcy5pbnRlcm5hbENvbG9yID0gY29sb3IkMSA/IGNvbG9yKGNvbG9yJDEpIDogbnVsbDtcbiAgfVxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBMaWZlY3ljbGVcbiAgLy9cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBjb21wb25lbnRXaWxsTG9hZCgpIHtcbiAgICB0aGlzLmhhbmRsZUNvbG9yQ2hhbmdlKHRoaXMuY29sb3IpO1xuICB9XG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCBpc0VtcHR5ID0gIXRoaXMuaW50ZXJuYWxDb2xvcjtcbiAgICBjb25zdCBjbGFzc2VzID0ge1xuICAgICAgW0NTUy5zd2F0Y2hdOiB0cnVlLFxuICAgICAgW0NTUy5ub0NvbG9yU3dhdGNoXTogaXNFbXB0eSxcbiAgICB9O1xuICAgIHJldHVybiAoaChcInN2Z1wiLCB7IGNsYXNzOiBjbGFzc2VzLCB4bWxuczogXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIH0sIHRoaXMucmVuZGVyU3dhdGNoKCkpKTtcbiAgfVxuICByZW5kZXJTd2F0Y2goKSB7XG4gICAgY29uc3QgeyBhY3RpdmUsIGVsLCBpbnRlcm5hbENvbG9yIH0gPSB0aGlzO1xuICAgIGNvbnN0IGJvcmRlclJhZGl1cyA9IGFjdGl2ZSA/IFwiMTAwJVwiIDogXCIwXCI7XG4gICAgY29uc3QgdGhlbWUgPSBnZXRNb2RlTmFtZShlbCk7XG4gICAgY29uc3QgYm9yZGVyQ29sb3IgPSB0aGVtZSA9PT0gXCJsaWdodFwiID8gQ09MT1JTLmJvcmRlckxpZ2h0IDogQ09MT1JTLmJvcmRlckRhcms7XG4gICAgY29uc3QgY29tbW9uU3dhdGNoUHJvcHMgPSB7XG4gICAgICBoZWlnaHQ6IFwiMTAwJVwiLFxuICAgICAgcng6IGJvcmRlclJhZGl1cyxcbiAgICAgIHN0cm9rZTogYm9yZGVyQ29sb3IsXG4gICAgICAvLyBzdHJva2Utd2lkdGggYW5kIGNsaXAtcGF0aCBhcmUgbmVlZGVkIHRvIGhpZGUgb3ZlcmZsb3dpbmcgcG9ydGlvbiBvZiBzdHJva2VcbiAgICAgIC8vIHNlZSBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvNzI3MzM0Ni8xOTQyMTZcbiAgICAgIC8vIHVzaW5nIGF0dHJpYnV0ZSB0byB3b3JrIGFyb3VuZCBTdGVuY2lsIHVzaW5nIHRoZSBwcm9wIG5hbWUgdnMgdGhlIGF0dHJpYnV0ZSB3aGVuIHJlbmRlcmluZ1xuICAgICAgW1wic3Ryb2tlLXdpZHRoXCJdOiBcIjJcIixcbiAgICAgIHdpZHRoOiBcIjEwMCVcIixcbiAgICB9O1xuICAgIGNvbnN0IGlzRW1wdHkgPSAhaW50ZXJuYWxDb2xvcjtcbiAgICBpZiAoaXNFbXB0eSkge1xuICAgICAgcmV0dXJuIChoKEZyYWdtZW50LCBudWxsLCBoKFwiY2xpcFBhdGhcIiwgeyBpZDogXCJzaGFwZVwiIH0sIGgoXCJyZWN0XCIsIHsgaGVpZ2h0OiBcIjEwMCVcIiwgcng6IGJvcmRlclJhZGl1cywgd2lkdGg6IFwiMTAwJVwiIH0pKSwgaChcInJlY3RcIiwgeyBcImNsaXAtcGF0aFwiOiBgaW5zZXQoMCByb3VuZCAke2JvcmRlclJhZGl1c30pYCwgcng6IGJvcmRlclJhZGl1cywgLi4uY29tbW9uU3dhdGNoUHJvcHMgfSksIGgoXCJsaW5lXCIsIHsgXCJjbGlwLXBhdGhcIjogXCJ1cmwoI3NoYXBlKVwiLCBcInN0cm9rZS13aWR0aFwiOiBcIjNcIiwgeDE6IFwiMTAwJVwiLCB4MjogXCIwXCIsIHkxOiBcIjBcIiwgeTI6IFwiMTAwJVwiIH0pKSk7XG4gICAgfVxuICAgIGNvbnN0IGFscGhhID0gaW50ZXJuYWxDb2xvci5hbHBoYSgpO1xuICAgIGNvbnN0IGhleCA9IGhleGlmeShpbnRlcm5hbENvbG9yKTtcbiAgICBjb25zdCBoZXhhID0gaGV4aWZ5KGludGVybmFsQ29sb3IsIGFscGhhIDwgMSk7XG4gICAgcmV0dXJuIChoKEZyYWdtZW50LCBudWxsLCBoKFwidGl0bGVcIiwgbnVsbCwgaGV4YSksIGgoXCJkZWZzXCIsIG51bGwsIGgoXCJwYXR0ZXJuXCIsIHsgaGVpZ2h0OiBDSEVDS0VSX0RJTUVOU0lPTlMuc2l6ZSwgaWQ6IFwiY2hlY2tlclwiLCBwYXR0ZXJuVW5pdHM6IFwidXNlclNwYWNlT25Vc2VcIiwgd2lkdGg6IENIRUNLRVJfRElNRU5TSU9OUy5zaXplLCB4OiBcIjBcIiwgeTogXCIwXCIgfSwgaChcInJlY3RcIiwgeyBjbGFzczogQ1NTLmNoZWNrZXIsIGhlaWdodDogQ0hFQ0tFUl9ESU1FTlNJT05TLnNxdWFyZVNpemUsIHdpZHRoOiBDSEVDS0VSX0RJTUVOU0lPTlMuc3F1YXJlU2l6ZSwgeDogXCIwXCIsIHk6IFwiMFwiIH0pLCBoKFwicmVjdFwiLCB7IGNsYXNzOiBDU1MuY2hlY2tlciwgaGVpZ2h0OiBDSEVDS0VSX0RJTUVOU0lPTlMuc3F1YXJlU2l6ZSwgd2lkdGg6IENIRUNLRVJfRElNRU5TSU9OUy5zcXVhcmVTaXplLCB4OiBDSEVDS0VSX0RJTUVOU0lPTlMuc3F1YXJlU2l6ZSwgeTogQ0hFQ0tFUl9ESU1FTlNJT05TLnNxdWFyZVNpemUgfSkpKSwgaChcInJlY3RcIiwgeyBmaWxsOiBcInVybCgjY2hlY2tlcilcIiwgaGVpZ2h0OiBcIjEwMCVcIiwgcng6IGJvcmRlclJhZGl1cywgd2lkdGg6IFwiMTAwJVwiIH0pLCBoKFwicmVjdFwiLCB7IGZpbGw6IGhleCwgc3R5bGU6IHtcbiAgICAgICAgXCJjbGlwLXBhdGhcIjogYWxwaGEgPCAxID8gXCJwb2x5Z29uKDEwMCUgMCwgMCAwLCAwIDEwMCUpXCIgOiBgaW5zZXQoMCByb3VuZCAke2JvcmRlclJhZGl1c30pYCxcbiAgICAgIH0sIC4uLmNvbW1vblN3YXRjaFByb3BzIH0pLCBhbHBoYSA8IDEgPyAoaChcInJlY3RcIiwgeyBmaWxsOiBoZXhhLCBrZXk6IFwib3BhY2l0eS1maWxsXCIsIHN0eWxlOiB7IFwiY2xpcC1wYXRoXCI6IFwicG9seWdvbigxMDAlIDAsIDEwMCUgMTAwJSwgMCAxMDAlKVwiIH0sIC4uLmNvbW1vblN3YXRjaFByb3BzIH0pKSA6IG51bGwpKTtcbiAgfVxuICBnZXQgZWwoKSB7IHJldHVybiB0aGlzOyB9XG4gIHN0YXRpYyBnZXQgd2F0Y2hlcnMoKSB7IHJldHVybiB7XG4gICAgXCJjb2xvclwiOiBbXCJoYW5kbGVDb2xvckNoYW5nZVwiXVxuICB9OyB9XG4gIHN0YXRpYyBnZXQgc3R5bGUoKSB7IHJldHVybiBjb2xvclBpY2tlclN3YXRjaENzczsgfVxufSwgWzEsIFwiY2FsY2l0ZS1jb2xvci1waWNrZXItc3dhdGNoXCIsIHtcbiAgICBcImFjdGl2ZVwiOiBbNTE2XSxcbiAgICBcImNvbG9yXCI6IFsxXSxcbiAgICBcInNjYWxlXCI6IFs1MTNdXG4gIH1dKTtcbmZ1bmN0aW9uIGRlZmluZUN1c3RvbUVsZW1lbnQoKSB7XG4gIGlmICh0eXBlb2YgY3VzdG9tRWxlbWVudHMgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgY29tcG9uZW50cyA9IFtcImNhbGNpdGUtY29sb3ItcGlja2VyLXN3YXRjaFwiXTtcbiAgY29tcG9uZW50cy5mb3JFYWNoKHRhZ05hbWUgPT4geyBzd2l0Y2ggKHRhZ05hbWUpIHtcbiAgICBjYXNlIFwiY2FsY2l0ZS1jb2xvci1waWNrZXItc3dhdGNoXCI6XG4gICAgICBpZiAoIWN1c3RvbUVsZW1lbnRzLmdldCh0YWdOYW1lKSkge1xuICAgICAgICBjdXN0b21FbGVtZW50cy5kZWZpbmUodGFnTmFtZSwgQ29sb3JQaWNrZXJTd2F0Y2gpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gIH0gfSk7XG59XG5kZWZpbmVDdXN0b21FbGVtZW50KCk7XG5cbmV4cG9ydCB7IENvbG9yUGlja2VyU3dhdGNoIGFzIEMsIGRlZmluZUN1c3RvbUVsZW1lbnQgYXMgZCB9O1xuIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtZGVzaWduLXN5c3RlbS9ibG9iL21haW4vTElDRU5TRS5tZCBmb3IgZGV0YWlscy5cbiAqIHYxLjcuMFxuICovXG5pbXBvcnQgeyBwcm94eUN1c3RvbUVsZW1lbnQsIEhUTUxFbGVtZW50LCBjcmVhdGVFdmVudCwgaCwgSG9zdCB9IGZyb20gJ0BzdGVuY2lsL2NvcmUvaW50ZXJuYWwvY2xpZW50L2luZGV4LmpzJztcbmltcG9ydCB7IG8gYXMgbm9kZUxpc3RUb0FycmF5IH0gZnJvbSAnLi9kb20uanMnO1xuaW1wb3J0IHsgZyBhcyBndWlkIH0gZnJvbSAnLi9ndWlkLmpzJztcblxuY29uc3QgdGFiQ3NzID0gXCI6aG9zdChbc2VsZWN0ZWRdKSBzZWN0aW9uLDpob3N0KFtzZWxlY3RlZF0pIC5jb250YWluZXJ7ZGlzcGxheTpibG9ja306aG9zdHtkaXNwbGF5Om5vbmU7YmxvY2stc2l6ZToxMDAlO2lubGluZS1zaXplOjEwMCV9Omhvc3QoW3NlbGVjdGVkXSl7ZGlzcGxheTpibG9jaztibG9jay1zaXplOjEwMCU7aW5saW5lLXNpemU6MTAwJTtvdmVyZmxvdzphdXRvfXNlY3Rpb24sLmNvbnRhaW5lcntkaXNwbGF5Om5vbmU7YmxvY2stc2l6ZToxMDAlO2lubGluZS1zaXplOjEwMCV9Omhvc3QoW3NjYWxlPXNdKXtwYWRkaW5nLWJsb2NrOjAuMjVyZW07Zm9udC1zaXplOnZhcigtLWNhbGNpdGUtZm9udC1zaXplLS0yKTtsaW5lLWhlaWdodDoxcmVtfTpob3N0KFtzY2FsZT1tXSl7cGFkZGluZy1ibG9jazowLjVyZW07Zm9udC1zaXplOnZhcigtLWNhbGNpdGUtZm9udC1zaXplLS0xKTtsaW5lLWhlaWdodDoxcmVtfTpob3N0KFtzY2FsZT1sXSl7Zm9udC1zaXplOnZhcigtLWNhbGNpdGUtZm9udC1zaXplLTApO2xpbmUtaGVpZ2h0OjEuMjVyZW07cGFkZGluZy1ibG9jazoxM3B4fTpob3N0KFtoaWRkZW5dKXtkaXNwbGF5Om5vbmV9W2hpZGRlbl17ZGlzcGxheTpub25lfVwiO1xuXG5jb25zdCBUYWIgPSAvKkBfX1BVUkVfXyovIHByb3h5Q3VzdG9tRWxlbWVudChjbGFzcyBleHRlbmRzIEhUTUxFbGVtZW50IHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLl9fcmVnaXN0ZXJIb3N0KCk7XG4gICAgdGhpcy5fX2F0dGFjaFNoYWRvdygpO1xuICAgIHRoaXMuY2FsY2l0ZUludGVybmFsVGFiUmVnaXN0ZXIgPSBjcmVhdGVFdmVudCh0aGlzLCBcImNhbGNpdGVJbnRlcm5hbFRhYlJlZ2lzdGVyXCIsIDYpO1xuICAgIHRoaXMuZ3VpZCA9IGBjYWxjaXRlLXRhYi10aXRsZS0ke2d1aWQoKX1gO1xuICAgIHRoaXMudGFiID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuc2VsZWN0ZWQgPSBmYWxzZTtcbiAgICB0aGlzLnNjYWxlID0gXCJtXCI7XG4gICAgdGhpcy5sYWJlbGVkQnkgPSB1bmRlZmluZWQ7XG4gIH1cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgTGlmZWN5Y2xlXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IGlkID0gdGhpcy5lbC5pZCB8fCB0aGlzLmd1aWQ7XG4gICAgcmV0dXJuIChoKEhvc3QsIHsgXCJhcmlhLWxhYmVsbGVkYnlcIjogdGhpcy5sYWJlbGVkQnksIGlkOiBpZCB9LCBoKFwiZGl2XCIsIHsgY2xhc3M6IFwiY29udGFpbmVyXCIsIHJvbGU6IFwidGFicGFuZWxcIiwgdGFiSW5kZXg6IHRoaXMuc2VsZWN0ZWQgPyAwIDogLTEgfSwgaChcInNlY3Rpb25cIiwgbnVsbCwgaChcInNsb3RcIiwgbnVsbCkpKSkpO1xuICB9XG4gIGNvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIHRoaXMucGFyZW50VGFic0VsID0gdGhpcy5lbC5jbG9zZXN0KFwiY2FsY2l0ZS10YWJzXCIpO1xuICB9XG4gIGNvbXBvbmVudERpZExvYWQoKSB7XG4gICAgdGhpcy5jYWxjaXRlSW50ZXJuYWxUYWJSZWdpc3Rlci5lbWl0KCk7XG4gIH1cbiAgY29tcG9uZW50V2lsbFJlbmRlcigpIHtcbiAgICB0aGlzLnNjYWxlID0gdGhpcy5wYXJlbnRUYWJzRWw/LnNjYWxlO1xuICB9XG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIC8vIERpc3BhdGNoaW5nIHRvIGJvZHkgaW4gb3JkZXIgdG8gYmUgbGlzdGVuZWQgYnkgb3RoZXIgZWxlbWVudHMgdGhhdCBhcmUgc3RpbGwgY29ubmVjdGVkIHRvIHRoZSBET00uXG4gICAgZG9jdW1lbnQuYm9keT8uZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJjYWxjaXRlVGFiVW5yZWdpc3RlclwiLCB7XG4gICAgICBkZXRhaWw6IHRoaXMuZWwsXG4gICAgfSkpO1xuICB9XG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gIEV2ZW50IExpc3RlbmVyc1xuICAvL1xuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIGludGVybmFsVGFiQ2hhbmdlSGFuZGxlcihldmVudCkge1xuICAgIGNvbnN0IHRhcmdldFRhYnNFbCA9IGV2ZW50XG4gICAgICAuY29tcG9zZWRQYXRoKClcbiAgICAgIC5maW5kKChlbCkgPT4gZWwudGFnTmFtZSA9PT0gXCJDQUxDSVRFLVRBQlNcIik7XG4gICAgLy8gdG8gYWxsb3cgYDxjYWxjaXRlLXRhYnM+YCB0byBiZSBuZXN0ZWQgd2UgbmVlZCB0byBtYWtlIHN1cmUgdGhpc1xuICAgIC8vIGBjYWxjaXRlVGFiQ2hhbmdlYCBldmVudCB3YXMgYWN0dWFsbHkgZmlyZWQgZnJvbSBhIHdpdGhpbiB0aGUgc2FtZVxuICAgIC8vIGA8Y2FsY2l0ZS10YWJzPmAgdGhhdCBpcyB0aGUgYSBwYXJlbnQgb2YgdGhpcyB0YWIuXG4gICAgaWYgKHRhcmdldFRhYnNFbCAhPT0gdGhpcy5wYXJlbnRUYWJzRWwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHRoaXMudGFiKSB7XG4gICAgICB0aGlzLnNlbGVjdGVkID0gdGhpcy50YWIgPT09IGV2ZW50LmRldGFpbC50YWI7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdGhpcy5nZXRUYWJJbmRleCgpLnRoZW4oKGluZGV4KSA9PiB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWQgPSBpbmRleCA9PT0gZXZlbnQuZGV0YWlsLnRhYjtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgfVxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBQdWJsaWMgTWV0aG9kc1xuICAvL1xuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgY29tcG9uZW50IGl0ZW0gd2l0aGluIHRoZSB0YWIgYXJyYXkuXG4gICAqL1xuICBhc3luYyBnZXRUYWJJbmRleCgpIHtcbiAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChub2RlTGlzdFRvQXJyYXkodGhpcy5lbC5wYXJlbnRFbGVtZW50LmNoaWxkcmVuKS5maWx0ZXIoKGVsKSA9PiBlbC5tYXRjaGVzKFwiY2FsY2l0ZS10YWJcIikpLCB0aGlzLmVsKTtcbiAgfVxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBQcml2YXRlIE1ldGhvZHNcbiAgLy9cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvKipcbiAgICogQHBhcmFtIHRhYklkc1xuICAgKiBAcGFyYW0gdGl0bGVJZHNcbiAgICogQGludGVybmFsXG4gICAqL1xuICBhc3luYyB1cGRhdGVBcmlhSW5mbyh0YWJJZHMgPSBbXSwgdGl0bGVJZHMgPSBbXSkge1xuICAgIHRoaXMubGFiZWxlZEJ5ID0gdGl0bGVJZHNbdGFiSWRzLmluZGV4T2YodGhpcy5lbC5pZCldIHx8IG51bGw7XG4gIH1cbiAgZ2V0IGVsKCkgeyByZXR1cm4gdGhpczsgfVxuICBzdGF0aWMgZ2V0IHN0eWxlKCkgeyByZXR1cm4gdGFiQ3NzOyB9XG59LCBbMSwgXCJjYWxjaXRlLXRhYlwiLCB7XG4gICAgXCJ0YWJcIjogWzUxM10sXG4gICAgXCJzZWxlY3RlZFwiOiBbMTU0MF0sXG4gICAgXCJzY2FsZVwiOiBbMTUzN10sXG4gICAgXCJsYWJlbGVkQnlcIjogWzMyXSxcbiAgICBcImdldFRhYkluZGV4XCI6IFs2NF0sXG4gICAgXCJ1cGRhdGVBcmlhSW5mb1wiOiBbNjRdXG4gIH0sIFtbMTYsIFwiY2FsY2l0ZUludGVybmFsVGFiQ2hhbmdlXCIsIFwiaW50ZXJuYWxUYWJDaGFuZ2VIYW5kbGVyXCJdXV0pO1xuZnVuY3Rpb24gZGVmaW5lQ3VzdG9tRWxlbWVudCgpIHtcbiAgaWYgKHR5cGVvZiBjdXN0b21FbGVtZW50cyA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBjb21wb25lbnRzID0gW1wiY2FsY2l0ZS10YWJcIl07XG4gIGNvbXBvbmVudHMuZm9yRWFjaCh0YWdOYW1lID0+IHsgc3dpdGNoICh0YWdOYW1lKSB7XG4gICAgY2FzZSBcImNhbGNpdGUtdGFiXCI6XG4gICAgICBpZiAoIWN1c3RvbUVsZW1lbnRzLmdldCh0YWdOYW1lKSkge1xuICAgICAgICBjdXN0b21FbGVtZW50cy5kZWZpbmUodGFnTmFtZSwgVGFiKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICB9IH0pO1xufVxuZGVmaW5lQ3VzdG9tRWxlbWVudCgpO1xuXG5leHBvcnQgeyBUYWIgYXMgVCwgZGVmaW5lQ3VzdG9tRWxlbWVudCBhcyBkIH07XG4iLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1kZXNpZ24tc3lzdGVtL2Jsb2IvbWFpbi9MSUNFTlNFLm1kIGZvciBkZXRhaWxzLlxuICogdjEuNy4wXG4gKi9cbmltcG9ydCB7IHByb3h5Q3VzdG9tRWxlbWVudCwgSFRNTEVsZW1lbnQsIGgsIEZyYWdtZW50IH0gZnJvbSAnQHN0ZW5jaWwvY29yZS9pbnRlcm5hbC9jbGllbnQvaW5kZXguanMnO1xuXG5jb25zdCBTTE9UUyA9IHtcbiAgdGl0bGVHcm91cDogXCJ0aXRsZS1ncm91cFwiLFxufTtcblxuY29uc3QgdGFic0NzcyA9IFwiOmhvc3R7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbn06aG9zdChbYm9yZGVyZWRdKXtib3gtc2hhZG93Omluc2V0IDAgMXB4IDAgdmFyKC0tY2FsY2l0ZS11aS1ib3JkZXItMSk7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jYWxjaXRlLXVpLWZvcmVncm91bmQtMSl9Omhvc3QoW2JvcmRlcmVkXTpub3QoW3Bvc2l0aW9uPWJvdHRvbV0pKSA6OnNsb3R0ZWQoY2FsY2l0ZS10YWItbmF2KXttYXJnaW4tYmxvY2stZW5kOi0xcHh9Omhvc3QoW2JvcmRlcmVkXVtwb3NpdGlvbj1ib3R0b21dKXtib3gtc2hhZG93Omluc2V0IDAgMXB4IDAgdmFyKC0tY2FsY2l0ZS11aS1ib3JkZXItMSksIGluc2V0IDAgLTFweCAwIHZhcigtLWNhbGNpdGUtdWktYm9yZGVyLTEpfTpob3N0KFtib3JkZXJlZF0pIHNlY3Rpb257Ym9yZGVyLXdpZHRoOjFweDtib3JkZXItc3R5bGU6c29saWQ7Ym9yZGVyLWNvbG9yOnZhcigtLWNhbGNpdGUtdWktYm9yZGVyLTEpfTpob3N0KFtib3JkZXJlZF1bc2NhbGU9c10pIHNlY3Rpb257cGFkZGluZzowLjc1cmVtfTpob3N0KFtib3JkZXJlZF1bc2NhbGU9bV0pIHNlY3Rpb257cGFkZGluZzowLjVyZW19Omhvc3QoW2JvcmRlcmVkXVtzY2FsZT1sXSkgc2VjdGlvbntwYWRkaW5nOjFyZW19Omhvc3QoW3Bvc2l0aW9uPWJvdHRvbV0pe2ZsZXgtZGlyZWN0aW9uOmNvbHVtbi1yZXZlcnNlfXNlY3Rpb257ZGlzcGxheTpmbGV4O2ZsZXgtZ3JvdzoxO292ZXJmbG93OmhpZGRlbjtib3JkZXItYmxvY2stc3RhcnQtd2lkdGg6MXB4O2JvcmRlci1ibG9jay1zdGFydC1jb2xvcjp2YXIoLS1jYWxjaXRlLXVpLWJvcmRlci0xKTtib3JkZXItYmxvY2stc3RhcnQtc3R5bGU6c29saWR9Omhvc3QoW3Bvc2l0aW9uPWJvdHRvbV0pIHNlY3Rpb257ZmxleC1kaXJlY3Rpb246Y29sdW1uLXJldmVyc2U7Ym9yZGVyLWJsb2NrLXN0YXJ0LXdpZHRoOjBweDtib3JkZXItYmxvY2stZW5kLXdpZHRoOjFweDtib3JkZXItYmxvY2stZW5kLWNvbG9yOnZhcigtLWNhbGNpdGUtdWktYm9yZGVyLTEpfTpob3N0KFtwb3NpdGlvbj1ib3R0b21dOm5vdChbYm9yZGVyZWRdKSkgc2VjdGlvbntib3JkZXItYmxvY2stZW5kLXN0eWxlOnNvbGlkfUBtZWRpYSAoZm9yY2VkLWNvbG9yczogYWN0aXZlKXs6aG9zdChbYm9yZGVyZWRdKSBzZWN0aW9ue2JvcmRlci1ibG9jay1zdGFydC13aWR0aDowcHg7Ym9yZGVyLWJsb2NrLWVuZC13aWR0aDoxcHh9Omhvc3QoW3Bvc2l0aW9uPWJvdHRvbV1bYm9yZGVyZWRdKSBzZWN0aW9ue2JvcmRlci1ibG9jay1zdGFydC13aWR0aDoxcHg7Ym9yZGVyLWJsb2NrLWVuZC13aWR0aDowcHh9fTpob3N0KFtoaWRkZW5dKXtkaXNwbGF5Om5vbmV9W2hpZGRlbl17ZGlzcGxheTpub25lfVwiO1xuXG5jb25zdCBUYWJzID0gLypAX19QVVJFX18qLyBwcm94eUN1c3RvbUVsZW1lbnQoY2xhc3MgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5fX3JlZ2lzdGVySG9zdCgpO1xuICAgIHRoaXMuX19hdHRhY2hTaGFkb3coKTtcbiAgICB0aGlzLmxheW91dCA9IFwiaW5saW5lXCI7XG4gICAgdGhpcy5wb3NpdGlvbiA9IFwidG9wXCI7XG4gICAgdGhpcy5zY2FsZSA9IFwibVwiO1xuICAgIHRoaXMuYm9yZGVyZWQgPSBmYWxzZTtcbiAgICB0aGlzLnRpdGxlcyA9IFtdO1xuICAgIHRoaXMudGFicyA9IFtdO1xuICB9XG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gIExpZmVjeWNsZVxuICAvL1xuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gKGgoRnJhZ21lbnQsIG51bGwsIGgoXCJzbG90XCIsIHsgbmFtZTogU0xPVFMudGl0bGVHcm91cCB9KSwgaChcInNlY3Rpb25cIiwgbnVsbCwgaChcInNsb3RcIiwgbnVsbCkpKSk7XG4gIH1cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgRXZlbnQgTGlzdGVuZXJzXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLyoqXG4gICAqIEBwYXJhbSBldmVudFxuICAgKiBAaW50ZXJuYWxcbiAgICovXG4gIGNhbGNpdGVJbnRlcm5hbFRhYlRpdGxlUmVnaXN0ZXIoZXZlbnQpIHtcbiAgICB0aGlzLnRpdGxlcyA9IFsuLi50aGlzLnRpdGxlcywgZXZlbnQudGFyZ2V0XTtcbiAgICB0aGlzLnJlZ2lzdHJ5SGFuZGxlcigpO1xuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICB9XG4gIC8qKlxuICAgKiBAcGFyYW0gZXZlbnRcbiAgICogQGludGVybmFsXG4gICAqL1xuICBjYWxjaXRlVGFiVGl0bGVVbnJlZ2lzdGVyKGV2ZW50KSB7XG4gICAgdGhpcy50aXRsZXMgPSB0aGlzLnRpdGxlcy5maWx0ZXIoKGVsKSA9PiBlbCAhPT0gZXZlbnQuZGV0YWlsKTtcbiAgICB0aGlzLnJlZ2lzdHJ5SGFuZGxlcigpO1xuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICB9XG4gIC8qKlxuICAgKiBAcGFyYW0gZXZlbnRcbiAgICogQGludGVybmFsXG4gICAqL1xuICBjYWxjaXRlSW50ZXJuYWxUYWJSZWdpc3RlcihldmVudCkge1xuICAgIHRoaXMudGFicyA9IFsuLi50aGlzLnRhYnMsIGV2ZW50LnRhcmdldF07XG4gICAgdGhpcy5yZWdpc3RyeUhhbmRsZXIoKTtcbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgfVxuICAvKipcbiAgICogQHBhcmFtIGV2ZW50XG4gICAqIEBpbnRlcm5hbFxuICAgKi9cbiAgY2FsY2l0ZVRhYlVucmVnaXN0ZXIoZXZlbnQpIHtcbiAgICB0aGlzLnRhYnMgPSB0aGlzLnRhYnMuZmlsdGVyKChlbCkgPT4gZWwgIT09IGV2ZW50LmRldGFpbCk7XG4gICAgdGhpcy5yZWdpc3RyeUhhbmRsZXIoKTtcbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgfVxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBQcml2YXRlIE1ldGhvZHNcbiAgLy9cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvKipcbiAgICpcbiAgICogTWF0Y2hlcyB1cCBlbGVtZW50cyBmcm9tIHRoZSBpbnRlcm5hbCBgdGFic2AgYW5kIGB0aXRsZXNgIHRvIGF1dG9tYXRpY2FsbHlcbiAgICogdXBkYXRlIHRoZSBBUklBIGF0dHJpYnV0ZXMgYW5kIGxpbmsgYDxjYWxjaXRlLXRhYj5gIGFuZFxuICAgKiBgPGNhbGNpdGUtdGFiLXRpdGxlPmAgY29tcG9uZW50cy5cbiAgICovXG4gIGFzeW5jIHJlZ2lzdHJ5SGFuZGxlcigpIHtcbiAgICBsZXQgdGFiSWRzO1xuICAgIGxldCB0aXRsZUlkcztcbiAgICAvLyBkZXRlcm1pbmUgaWYgd2UgYXJlIHVzaW5nIGB0YWJgIGJhc2VkIG9yIGBpbmRleGAgYmFzZWQgdGFiIGlkZW50aWZpZXJzLlxuICAgIGlmICh0aGlzLnRhYnMuc29tZSgoZWwpID0+IGVsLnRhYikgfHwgdGhpcy50aXRsZXMuc29tZSgoZWwpID0+IGVsLnRhYikpIHtcbiAgICAgIC8vIGlmIHdlIGFyZSB1c2luZyBgdGFiYCBiYXNlZCBpZGVudGlmaWVycyBzb3J0IGJ5IGB0YWJgIHRvIGFjY291bnQgZm9yXG4gICAgICAvLyBwb3NzaWJsZSBvdXQgb2Ygb3JkZXIgdGFicyBhbmQgZ2V0IHRoZSBpZCBvZiBlYWNoIHRhYlxuICAgICAgdGFiSWRzID0gdGhpcy50YWJzLnNvcnQoKGEsIGIpID0+IGEudGFiLmxvY2FsZUNvbXBhcmUoYi50YWIpKS5tYXAoKGVsKSA9PiBlbC5pZCk7XG4gICAgICB0aXRsZUlkcyA9IHRoaXMudGl0bGVzLnNvcnQoKGEsIGIpID0+IGEudGFiLmxvY2FsZUNvbXBhcmUoYi50YWIpKS5tYXAoKGVsKSA9PiBlbC5pZCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgLy8gaWYgd2UgYXJlIHVzaW5nIGluZGV4IGJhc2VkIHRhYnMgdGhlbiB0aGUgYDxjYWxjaXRlLXRhYj5gIGFuZFxuICAgICAgLy8gYDxjYWxjaXRlLXRhYi10aXRsZT5gIG1pZ2h0IGhhdmUgYmVlbiByZW5kZXJlZCBvdXQgb2Ygb3JkZXIgc28gdGhlXG4gICAgICAvLyBvcmRlciBvZiBgdGhpcy50YWJzYCBhbmQgYHRoaXMudGl0bGVzYCBtaWdodCBub3QgcmVmbGVjdCB0aGUgRE9NIHN0YXRlLFxuICAgICAgLy8gYW5kIG1pZ2h0IG5vdCBtYXRjaCBlYWNoIG90aGVyIHNvIHdlIG5lZWQgdG8gZ2V0IHRoZSBpbmRleCBvZiBhbGwgdGhlXG4gICAgICAvLyB0YWJzIGFuZCB0aXRsZXMgaW4gdGhlIERPTSBvcmRlciB0byBtYXRjaCB0aGVtIHVwIGFzIGEgc291cmNlIG9mIHRydXRoXG4gICAgICBjb25zdCB0YWJEb21JbmRleGVzID0gYXdhaXQgUHJvbWlzZS5hbGwodGhpcy50YWJzLm1hcCgoZWwpID0+IGVsLmdldFRhYkluZGV4KCkpKTtcbiAgICAgIGNvbnN0IHRpdGxlRG9tSW5kZXhlcyA9IGF3YWl0IFByb21pc2UuYWxsKHRoaXMudGl0bGVzLm1hcCgoZWwpID0+IGVsLmdldFRhYkluZGV4KCkpKTtcbiAgICAgIC8vIG9uY2Ugd2UgaGF2ZSB0aGUgRE9NIG9yZGVyIGFzIGEgc291cmNlIG9mIHRydXRoIHdlIGNhbiBidWlsZCB0aGVcbiAgICAgIC8vIG1hdGNoaW5nIHRhYklkcyBhbmQgdGl0bGVJZHMgYXJyYXlzXG4gICAgICB0YWJJZHMgPSB0YWJEb21JbmRleGVzLnJlZHVjZSgoaWRzLCBpbmRleEluRE9NLCByZWdpc3RyeUluZGV4KSA9PiB7XG4gICAgICAgIGlkc1tpbmRleEluRE9NXSA9IHRoaXMudGFic1tyZWdpc3RyeUluZGV4XS5pZDtcbiAgICAgICAgcmV0dXJuIGlkcztcbiAgICAgIH0sIFtdKTtcbiAgICAgIHRpdGxlSWRzID0gdGl0bGVEb21JbmRleGVzLnJlZHVjZSgoaWRzLCBpbmRleEluRE9NLCByZWdpc3RyeUluZGV4KSA9PiB7XG4gICAgICAgIGlkc1tpbmRleEluRE9NXSA9IHRoaXMudGl0bGVzW3JlZ2lzdHJ5SW5kZXhdLmlkO1xuICAgICAgICByZXR1cm4gaWRzO1xuICAgICAgfSwgW10pO1xuICAgIH1cbiAgICAvLyBwYXNzIGFsbCBvdXIgbmV3IGFyaWEgaW5mb3JtYXRpb24gdG8gZWFjaCBgPGNhbGNpdGUtdGFiPmAgYW5kXG4gICAgLy8gYDxjYWxjaXRlLXRhYi10aXRsZT5gIHdoaWNoIHdpbGwgY2hlY2sgaWYgdGhleSBjYW4gdXBkYXRlIHRoZWlyIGludGVybmFsXG4gICAgLy8gYGNvbnRyb2xsZWRgIG9yIGBsYWJlbGVkQnlgIHN0YXRlcyBhbmQgcmUtcmVuZGVyIGlmIG5lY2Vzc2FyeVxuICAgIHRoaXMudGFicy5mb3JFYWNoKChlbCkgPT4gZWwudXBkYXRlQXJpYUluZm8odGFiSWRzLCB0aXRsZUlkcykpO1xuICAgIHRoaXMudGl0bGVzLmZvckVhY2goKGVsKSA9PiBlbC51cGRhdGVBcmlhSW5mbyh0YWJJZHMsIHRpdGxlSWRzKSk7XG4gIH1cbiAgZ2V0IGVsKCkgeyByZXR1cm4gdGhpczsgfVxuICBzdGF0aWMgZ2V0IHN0eWxlKCkgeyByZXR1cm4gdGFic0NzczsgfVxufSwgWzEsIFwiY2FsY2l0ZS10YWJzXCIsIHtcbiAgICBcImxheW91dFwiOiBbNTEzXSxcbiAgICBcInBvc2l0aW9uXCI6IFs1MTNdLFxuICAgIFwic2NhbGVcIjogWzUxM10sXG4gICAgXCJib3JkZXJlZFwiOiBbNF0sXG4gICAgXCJ0aXRsZXNcIjogWzMyXSxcbiAgICBcInRhYnNcIjogWzMyXVxuICB9LCBbWzAsIFwiY2FsY2l0ZUludGVybmFsVGFiVGl0bGVSZWdpc3RlclwiLCBcImNhbGNpdGVJbnRlcm5hbFRhYlRpdGxlUmVnaXN0ZXJcIl0sIFsxNiwgXCJjYWxjaXRlVGFiVGl0bGVVbnJlZ2lzdGVyXCIsIFwiY2FsY2l0ZVRhYlRpdGxlVW5yZWdpc3RlclwiXSwgWzAsIFwiY2FsY2l0ZUludGVybmFsVGFiUmVnaXN0ZXJcIiwgXCJjYWxjaXRlSW50ZXJuYWxUYWJSZWdpc3RlclwiXSwgWzE2LCBcImNhbGNpdGVUYWJVbnJlZ2lzdGVyXCIsIFwiY2FsY2l0ZVRhYlVucmVnaXN0ZXJcIl1dXSk7XG5mdW5jdGlvbiBkZWZpbmVDdXN0b21FbGVtZW50KCkge1xuICBpZiAodHlwZW9mIGN1c3RvbUVsZW1lbnRzID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGNvbXBvbmVudHMgPSBbXCJjYWxjaXRlLXRhYnNcIl07XG4gIGNvbXBvbmVudHMuZm9yRWFjaCh0YWdOYW1lID0+IHsgc3dpdGNoICh0YWdOYW1lKSB7XG4gICAgY2FzZSBcImNhbGNpdGUtdGFic1wiOlxuICAgICAgaWYgKCFjdXN0b21FbGVtZW50cy5nZXQodGFnTmFtZSkpIHtcbiAgICAgICAgY3VzdG9tRWxlbWVudHMuZGVmaW5lKHRhZ05hbWUsIFRhYnMpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gIH0gfSk7XG59XG5kZWZpbmVDdXN0b21FbGVtZW50KCk7XG5cbmV4cG9ydCB7IFRhYnMgYXMgVCwgZGVmaW5lQ3VzdG9tRWxlbWVudCBhcyBkIH07XG4iLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1kZXNpZ24tc3lzdGVtL2Jsb2IvbWFpbi9MSUNFTlNFLm1kIGZvciBkZXRhaWxzLlxuICogdjEuNy4wXG4gKi9cbmltcG9ydCB7IGQgYXMgZGVib3VuY2UsIGkgYXMgaXNPYmplY3QgfSBmcm9tICcuL2RlYm91bmNlLmpzJztcblxuLyoqIEVycm9yIG1lc3NhZ2UgY29uc3RhbnRzLiAqL1xudmFyIEZVTkNfRVJST1JfVEVYVCA9ICdFeHBlY3RlZCBhIGZ1bmN0aW9uJztcblxuLyoqXG4gKiBDcmVhdGVzIGEgdGhyb3R0bGVkIGZ1bmN0aW9uIHRoYXQgb25seSBpbnZva2VzIGBmdW5jYCBhdCBtb3N0IG9uY2UgcGVyXG4gKiBldmVyeSBgd2FpdGAgbWlsbGlzZWNvbmRzLiBUaGUgdGhyb3R0bGVkIGZ1bmN0aW9uIGNvbWVzIHdpdGggYSBgY2FuY2VsYFxuICogbWV0aG9kIHRvIGNhbmNlbCBkZWxheWVkIGBmdW5jYCBpbnZvY2F0aW9ucyBhbmQgYSBgZmx1c2hgIG1ldGhvZCB0b1xuICogaW1tZWRpYXRlbHkgaW52b2tlIHRoZW0uIFByb3ZpZGUgYG9wdGlvbnNgIHRvIGluZGljYXRlIHdoZXRoZXIgYGZ1bmNgXG4gKiBzaG91bGQgYmUgaW52b2tlZCBvbiB0aGUgbGVhZGluZyBhbmQvb3IgdHJhaWxpbmcgZWRnZSBvZiB0aGUgYHdhaXRgXG4gKiB0aW1lb3V0LiBUaGUgYGZ1bmNgIGlzIGludm9rZWQgd2l0aCB0aGUgbGFzdCBhcmd1bWVudHMgcHJvdmlkZWQgdG8gdGhlXG4gKiB0aHJvdHRsZWQgZnVuY3Rpb24uIFN1YnNlcXVlbnQgY2FsbHMgdG8gdGhlIHRocm90dGxlZCBmdW5jdGlvbiByZXR1cm4gdGhlXG4gKiByZXN1bHQgb2YgdGhlIGxhc3QgYGZ1bmNgIGludm9jYXRpb24uXG4gKlxuICogKipOb3RlOioqIElmIGBsZWFkaW5nYCBhbmQgYHRyYWlsaW5nYCBvcHRpb25zIGFyZSBgdHJ1ZWAsIGBmdW5jYCBpc1xuICogaW52b2tlZCBvbiB0aGUgdHJhaWxpbmcgZWRnZSBvZiB0aGUgdGltZW91dCBvbmx5IGlmIHRoZSB0aHJvdHRsZWQgZnVuY3Rpb25cbiAqIGlzIGludm9rZWQgbW9yZSB0aGFuIG9uY2UgZHVyaW5nIHRoZSBgd2FpdGAgdGltZW91dC5cbiAqXG4gKiBJZiBgd2FpdGAgaXMgYDBgIGFuZCBgbGVhZGluZ2AgaXMgYGZhbHNlYCwgYGZ1bmNgIGludm9jYXRpb24gaXMgZGVmZXJyZWRcbiAqIHVudGlsIHRvIHRoZSBuZXh0IHRpY2ssIHNpbWlsYXIgdG8gYHNldFRpbWVvdXRgIHdpdGggYSB0aW1lb3V0IG9mIGAwYC5cbiAqXG4gKiBTZWUgW0RhdmlkIENvcmJhY2hvJ3MgYXJ0aWNsZV0oaHR0cHM6Ly9jc3MtdHJpY2tzLmNvbS9kZWJvdW5jaW5nLXRocm90dGxpbmctZXhwbGFpbmVkLWV4YW1wbGVzLylcbiAqIGZvciBkZXRhaWxzIG92ZXIgdGhlIGRpZmZlcmVuY2VzIGJldHdlZW4gYF8udGhyb3R0bGVgIGFuZCBgXy5kZWJvdW5jZWAuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSAwLjEuMFxuICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byB0aHJvdHRsZS5cbiAqIEBwYXJhbSB7bnVtYmVyfSBbd2FpdD0wXSBUaGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB0aHJvdHRsZSBpbnZvY2F0aW9ucyB0by5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucz17fV0gVGhlIG9wdGlvbnMgb2JqZWN0LlxuICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5sZWFkaW5nPXRydWVdXG4gKiAgU3BlY2lmeSBpbnZva2luZyBvbiB0aGUgbGVhZGluZyBlZGdlIG9mIHRoZSB0aW1lb3V0LlxuICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy50cmFpbGluZz10cnVlXVxuICogIFNwZWNpZnkgaW52b2tpbmcgb24gdGhlIHRyYWlsaW5nIGVkZ2Ugb2YgdGhlIHRpbWVvdXQuXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyB0aHJvdHRsZWQgZnVuY3Rpb24uXG4gKiBAZXhhbXBsZVxuICpcbiAqIC8vIEF2b2lkIGV4Y2Vzc2l2ZWx5IHVwZGF0aW5nIHRoZSBwb3NpdGlvbiB3aGlsZSBzY3JvbGxpbmcuXG4gKiBqUXVlcnkod2luZG93KS5vbignc2Nyb2xsJywgXy50aHJvdHRsZSh1cGRhdGVQb3NpdGlvbiwgMTAwKSk7XG4gKlxuICogLy8gSW52b2tlIGByZW5ld1Rva2VuYCB3aGVuIHRoZSBjbGljayBldmVudCBpcyBmaXJlZCwgYnV0IG5vdCBtb3JlIHRoYW4gb25jZSBldmVyeSA1IG1pbnV0ZXMuXG4gKiB2YXIgdGhyb3R0bGVkID0gXy50aHJvdHRsZShyZW5ld1Rva2VuLCAzMDAwMDAsIHsgJ3RyYWlsaW5nJzogZmFsc2UgfSk7XG4gKiBqUXVlcnkoZWxlbWVudCkub24oJ2NsaWNrJywgdGhyb3R0bGVkKTtcbiAqXG4gKiAvLyBDYW5jZWwgdGhlIHRyYWlsaW5nIHRocm90dGxlZCBpbnZvY2F0aW9uLlxuICogalF1ZXJ5KHdpbmRvdykub24oJ3BvcHN0YXRlJywgdGhyb3R0bGVkLmNhbmNlbCk7XG4gKi9cbmZ1bmN0aW9uIHRocm90dGxlKGZ1bmMsIHdhaXQsIG9wdGlvbnMpIHtcbiAgdmFyIGxlYWRpbmcgPSB0cnVlLFxuICAgICAgdHJhaWxpbmcgPSB0cnVlO1xuXG4gIGlmICh0eXBlb2YgZnVuYyAhPSAnZnVuY3Rpb24nKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihGVU5DX0VSUk9SX1RFWFQpO1xuICB9XG4gIGlmIChpc09iamVjdChvcHRpb25zKSkge1xuICAgIGxlYWRpbmcgPSAnbGVhZGluZycgaW4gb3B0aW9ucyA/ICEhb3B0aW9ucy5sZWFkaW5nIDogbGVhZGluZztcbiAgICB0cmFpbGluZyA9ICd0cmFpbGluZycgaW4gb3B0aW9ucyA/ICEhb3B0aW9ucy50cmFpbGluZyA6IHRyYWlsaW5nO1xuICB9XG4gIHJldHVybiBkZWJvdW5jZShmdW5jLCB3YWl0LCB7XG4gICAgJ2xlYWRpbmcnOiBsZWFkaW5nLFxuICAgICdtYXhXYWl0Jzogd2FpdCxcbiAgICAndHJhaWxpbmcnOiB0cmFpbGluZ1xuICB9KTtcbn1cblxuZXhwb3J0IHsgdGhyb3R0bGUgYXMgdCB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9
"use strict";
(self["webpackChunksynview"] = self["webpackChunksynview"] || []).push([["vendors-node_modules_esri_calcite-components_dist_components_calcite-menu-item_js"],{

/***/ "./node_modules/@esri/calcite-components/dist/components/calcite-menu-item.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/components/calcite-menu-item.js ***!
  \************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   CalciteMenuItem: () => (/* binding */ CalciteMenuItem),
/* harmony export */   defineCustomElement: () => (/* binding */ defineCustomElement)
/* harmony export */ });
/* harmony import */ var _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @stencil/core/internal/client/index.js */ "./node_modules/@stencil/core/internal/client/index.js");
/* harmony import */ var _dom_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dom.js */ "./node_modules/@esri/calcite-components/dist/components/dom.js");
/* harmony import */ var _loadable_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./loadable.js */ "./node_modules/@esri/calcite-components/dist/components/loadable.js");
/* harmony import */ var _t9n_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./t9n.js */ "./node_modules/@esri/calcite-components/dist/components/t9n.js");
/* harmony import */ var _locale_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./locale.js */ "./node_modules/@esri/calcite-components/dist/components/locale.js");
/* harmony import */ var _action_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./action.js */ "./node_modules/@esri/calcite-components/dist/components/action.js");
/* harmony import */ var _icon_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./icon.js */ "./node_modules/@esri/calcite-components/dist/components/icon.js");
/* harmony import */ var _loader_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./loader.js */ "./node_modules/@esri/calcite-components/dist/components/loader.js");
/* harmony import */ var _menu_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./menu.js */ "./node_modules/@esri/calcite-components/dist/components/menu.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v1.7.0
 */










const CSS = {
  container: "container",
  content: "content",
  dropdownVertical: "dropdown--vertical",
  dropdownMenuItems: "dropdown-menu-items",
  dropdownAction: "dropdown-action",
  layoutVertical: "layout--vertical",
  hoverHrefIcon: "hover-href-icon",
  icon: "icon",
  iconBreadcrumb: "icon--breadcrumb",
  iconDropdown: "icon--dropdown",
  iconEnd: "icon--end",
  iconStart: "icon--start",
  isParentVertical: "parent--vertical",
  itemContent: "item-content",
  open: "open",
  nested: "nested",
  textContainer: "text-container",
};

const menuItemCss = ":host{position:relative;box-sizing:border-box;display:flex;align-items:center;flex-shrink:0}:host .container,:host .item-content,:host .content{min-block-size:3rem}:host([layout=vertical]){inline-size:100%}:host(:not([layout=vertical])){block-size:100%}.container,.item-content{display:flex;block-size:100%;inline-size:100%;flex-direction:row;align-items:stretch}.content{position:relative;box-sizing:border-box;display:flex;block-size:100%;inline-size:100%;cursor:pointer;align-items:center;justify-content:center;background-color:var(--calcite-ui-foreground-1);padding-inline:1rem;font-size:var(--calcite-font-size-0);color:var(--calcite-ui-text-2);outline:2px solid transparent;outline-offset:2px;text-decoration:none;border-block-end:0.125rem solid transparent;padding-block-start:0.125rem}.content:hover{background-color:var(--calcite-ui-foreground-2);color:var(--calcite-ui-text-2)}.content:focus{background-color:var(--calcite-ui-foreground-2);color:var(--calcite-ui-text-2);outline:2px solid var(--calcite-ui-focus-color, var(--calcite-ui-brand));outline-offset:calc(\n            -2px *\n            calc(\n              1 -\n              2 * clamp(\n                0,\n                var(--calcite-ui-focus-offset-invert),\n                1\n              )\n            )\n          )}.content:active{background-color:var(--calcite-ui-foreground-3);color:var(--calcite-ui-text-1)}.content span{display:inline-flex}.content.layout--vertical{display:flex;inline-size:100%;justify-content:flex-start;padding-block:1rem;border-block-end:0;border-inline-end:0.25rem solid transparent}:host([active]) .content{color:var(--calcite-ui-text-1);border-color:var(--calcite-ui-brand)}:host([active]) .content .icon{--calcite-ui-icon-color:var(--calcite-ui-brand)}:host([layout=vertical]) .content{padding-inline:0.75rem}.icon--start{margin-inline-end:0.75rem}.icon--end{margin-inline-start:0.75rem}:host([layout=vertical]) .icon--end{margin-inline-start:auto;padding-inline-start:0.75rem}.icon--dropdown{position:relative;margin-inline-start:auto;margin-inline-end:0px;padding-inline-start:0.5rem;--calcite-ui-icon-color:var(--calcite-ui-text-3)}:host([layout=vertical]) .icon--end~.icon--dropdown{margin-inline-start:0.75rem}:host([layout=vertical]) .hover-href-icon{padding-inline-start:0.5rem}:host([layout=vertical]) .hover-href-icon~.icon--end{margin-inline-start:0.5rem}:host([layout=vertical]) .hover-href-icon~.icon--breadcrumb{margin-inline-start:0.75rem}.icon--breadcrumb{margin-inline-end:0px;padding-inline-start:0.5rem;--calcite-ui-icon-color:var(--calcite-ui-text-3)}:host([layout=vertical]) .icon--breadcrumb{margin-inline-start:auto}:host([layout=vertical]) .icon--breadcrumb~.icon--dropdown{margin-inline-start:0.5rem}:host([layout=vertical]) .icon--end~.icon--breadcrumb{margin-inline-start:0.5rem}:host([breadcrumb]) .content{padding-inline-end:0.75rem}calcite-action{position:relative;block-size:auto;border-inline-start:1px solid var(--calcite-ui-foreground-1)}calcite-action:after{position:absolute;inset-inline-start:-1px;display:block;inline-size:1px;content:\"\";inset-block:0.75rem;background-color:var(--calcite-ui-border-3)}calcite-action:hover:after{block-size:100%;inset-block:0}.content:focus~calcite-action,.content:hover~calcite-action{color:var(--calcite-ui-text-1);border-inline-start:1px solid var(--calcite-ui-border-3)}.container:hover .dropdown-action{background-color:var(--calcite-ui-foreground-2)}.dropdown-menu-items{position:absolute;display:none;block-size:auto;min-inline-size:100%;flex-direction:column;overflow:visible;border:1px solid var(--calcite-ui-border-3);background:var(--calcite-ui-foreground-1);inset-block-start:100%;z-index:var(--calcite-app-z-index-dropdown)}.dropdown-menu-items.open{display:block}.dropdown-menu-items.nested{position:absolute;inset-block-start:-1px;transform:translateX(calc(100% - 2px))}.parent--vertical{flex-direction:column}.dropdown--vertical.dropdown-menu-items{position:relative;border-radius:0px;box-shadow:none;inset-block-start:0;transform:none}.dropdown--vertical.dropdown-menu-items:last-of-type{border-inline:0}:host([layout=vertical]:last-of-type) .dropdown-menu-items{border-block-end:0}:host([slot=submenu-item]) .parent--vertical{padding-inline-start:1.5rem}.dropdown-menu-items.nested.calcite--rtl{transform:translateX(calc(-100% + 2px))}.dropdown--vertical.dropdown-menu-items.nested.calcite--rtl{transform:none}.hover-href-icon{position:relative;inset-inline-end:0.25rem;margin-inline-start:auto;opacity:0;transition:all var(--calcite-internal-animation-timing-medium) ease-in-out}.content:focus .hover-href-icon,.content:hover .hover-href-icon{inset-inline-end:-0.25rem;opacity:1}:host([hidden]){display:none}[hidden]{display:none}";

const CalciteMenuItem$1 = /*@__PURE__*/ (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.proxyCustomElement)(class extends _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.HTMLElement {
  constructor() {
    super();
    this.__registerHost();
    this.__attachShadow();
    this.calciteInternalMenuItemKeyEvent = (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.createEvent)(this, "calciteInternalMenuItemKeyEvent", 7);
    this.calciteMenuItemSelect = (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.createEvent)(this, "calciteMenuItemSelect", 7);
    this.clickHandler = (event) => {
      if ((this.href && event.target === this.dropdownActionEl) || (!this.href && this.hasSubmenu)) {
        this.open = !this.open;
      }
      this.selectMenuItem(event);
    };
    this.handleMenuItemSlotChange = (event) => {
      this.submenuItems = (0,_dom_js__WEBPACK_IMPORTED_MODULE_0__.s)(event);
      this.submenuItems.forEach((item) => {
        if (!item.topLevelMenuLayout) {
          item.topLevelMenuLayout = this.topLevelMenuLayout;
        }
      });
      this.hasSubmenu = this.submenuItems.length > 0;
    };
    this.keyDownHandler = async (event) => {
      // opening and closing of submenu is handled here. Any other functionality is bubbled to parent menu.
      if (event.key === " " || event.key === "Enter") {
        this.selectMenuItem(event);
        if (this.hasSubmenu &&
          (!this.href || (this.href && event.target === this.dropdownActionEl))) {
          this.open = !this.open;
        }
        event.preventDefault();
      }
      else if (event.key === "Escape") {
        if (this.open) {
          this.open = false;
          return;
        }
        this.calciteInternalMenuItemKeyEvent.emit({ event });
        event.preventDefault();
      }
      else if (event.key === "ArrowDown" || event.key === "ArrowUp") {
        event.preventDefault();
        if ((event.target === this.dropdownActionEl || !this.href) &&
          this.hasSubmenu &&
          !this.open &&
          this.layout === "horizontal") {
          this.open = true;
          return;
        }
        this.calciteInternalMenuItemKeyEvent.emit({
          event,
          children: this.submenuItems,
          isSubmenuOpen: this.open && this.hasSubmenu,
        });
      }
      else if (event.key === "ArrowLeft") {
        event.preventDefault();
        this.calciteInternalMenuItemKeyEvent.emit({
          event,
          children: this.submenuItems,
          isSubmenuOpen: true,
        });
      }
      else if (event.key === "ArrowRight") {
        event.preventDefault();
        if ((event.target === this.dropdownActionEl || !this.href) &&
          this.hasSubmenu &&
          !this.open &&
          this.layout === "vertical") {
          this.open = true;
          return;
        }
        this.calciteInternalMenuItemKeyEvent.emit({
          event,
          children: this.submenuItems,
          isSubmenuOpen: this.open && this.hasSubmenu,
        });
      }
    };
    this.active = undefined;
    this.breadcrumb = undefined;
    this.href = undefined;
    this.iconEnd = undefined;
    this.iconFlipRtl = undefined;
    this.iconStart = undefined;
    this.isTopLevelItem = false;
    this.label = undefined;
    this.layout = undefined;
    this.messageOverrides = undefined;
    this.messages = undefined;
    this.open = false;
    this.rel = undefined;
    this.target = undefined;
    this.text = undefined;
    this.topLevelMenuLayout = undefined;
    this.defaultMessages = undefined;
    this.effectiveLocale = "";
    this.hasSubmenu = false;
    this.submenuItems = undefined;
  }
  onMessagesChange() {
    /* wired up by t9n util */
  }
  effectiveLocaleChange() {
    (0,_t9n_js__WEBPACK_IMPORTED_MODULE_2__.u)(this, this.effectiveLocale);
  }
  //--------------------------------------------------------------------------
  //
  //  Public Methods
  //
  //--------------------------------------------------------------------------
  /** Sets focus on the component. */
  async setFocus() {
    await (0,_loadable_js__WEBPACK_IMPORTED_MODULE_1__.c)(this);
    this.anchorEl.focus();
  }
  //--------------------------------------------------------------------------
  //
  //  Event Listeners
  //
  //--------------------------------------------------------------------------
  handleClickOut(event) {
    if (this.topLevelMenuLayout !== "vertical" &&
      this.hasSubmenu &&
      this.open &&
      !event.composedPath().includes(this.el)) {
      this.open = false;
    }
  }
  handleFocusOut(event) {
    if (this.topLevelMenuLayout !== "vertical" &&
      !this.el.contains(event.relatedTarget)) {
      this.open = false;
    }
  }
  //--------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  //--------------------------------------------------------------------------
  connectedCallback() {
    (0,_locale_js__WEBPACK_IMPORTED_MODULE_3__.c)(this);
    (0,_t9n_js__WEBPACK_IMPORTED_MODULE_2__.c)(this);
  }
  async componentWillLoad() {
    (0,_loadable_js__WEBPACK_IMPORTED_MODULE_1__.a)(this);
    await (0,_t9n_js__WEBPACK_IMPORTED_MODULE_2__.s)(this);
  }
  componentDidLoad() {
    (0,_loadable_js__WEBPACK_IMPORTED_MODULE_1__.s)(this);
  }
  disconnectedCallback() {
    (0,_locale_js__WEBPACK_IMPORTED_MODULE_3__.d)(this);
    (0,_t9n_js__WEBPACK_IMPORTED_MODULE_2__.d)(this);
  }
  // --------------------------------------------------------------------------
  //
  //  Private Methods
  //
  // --------------------------------------------------------------------------
  blurHandler() {
    this.isFocused = false;
  }
  focusHandler(event) {
    const target = event.target;
    this.isFocused = true;
    if (target.open && !this.open) {
      target.open = false;
    }
  }
  selectMenuItem(event) {
    if (event.target !== this.dropdownActionEl) {
      this.calciteMenuItemSelect.emit();
    }
  }
  //--------------------------------------------------------------------------
  //
  //  Render Methods
  //
  //--------------------------------------------------------------------------
  renderIconStart() {
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.h)("calcite-icon", { class: `${CSS.icon} ${CSS.iconStart}`, flipRtl: this.iconFlipRtl === "start" || this.iconFlipRtl === "both", icon: this.iconStart, key: CSS.iconStart, scale: "s" }));
  }
  renderIconEnd() {
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.h)("calcite-icon", { class: `${CSS.icon} ${CSS.iconEnd}`, flipRtl: this.iconFlipRtl === "end" || this.iconFlipRtl === "both", icon: this.iconEnd, key: CSS.iconEnd, scale: "s" }));
  }
  renderBreadcrumbIcon(dir) {
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.h)("calcite-icon", { class: `${CSS.icon} ${CSS.iconBreadcrumb}`, icon: dir === "rtl" ? "chevron-left" : "chevron-right", key: CSS.iconBreadcrumb, scale: "s" }));
  }
  renderDropdownIcon(dir) {
    const dirChevron = dir === "rtl" ? "chevron-left" : "chevron-right";
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.h)("calcite-icon", { class: `${CSS.icon} ${CSS.iconDropdown}`, icon: this.topLevelMenuLayout === "vertical" || this.isTopLevelItem
        ? this.open
          ? "chevron-up"
          : "chevron-down"
        : dirChevron, key: CSS.iconDropdown, scale: "s" }));
  }
  renderDropdownAction(dir) {
    const dirChevron = dir === "rtl" ? "chevron-left" : "chevron-right";
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.h)("calcite-action", { class: CSS.dropdownAction, icon: this.topLevelMenuLayout === "vertical" || this.isTopLevelItem
        ? this.open
          ? "chevron-up"
          : "chevron-down"
        : dirChevron, key: CSS.dropdownAction, onClick: this.clickHandler, onKeyDown: this.keyDownHandler, text: this.messages.open,
      // eslint-disable-next-line react/jsx-sort-props -- ref should be last so node attrs/props are in sync (see https://github.com/Esri/calcite-design-system/pull/6530)
      ref: (el) => (this.dropdownActionEl = el) }));
  }
  renderSubmenuItems(dir) {
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.h)("calcite-menu", { class: {
        [CSS.dropdownMenuItems]: true,
        [CSS.open]: this.open,
        [CSS.nested]: !this.isTopLevelItem,
        [_dom_js__WEBPACK_IMPORTED_MODULE_0__.C.rtl]: dir === "rtl",
        [CSS.dropdownVertical]: this.topLevelMenuLayout === "vertical",
      }, label: this.messages.submenu, layout: "vertical", role: "menu" }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.h)("slot", { name: "submenu-item", onSlotchange: this.handleMenuItemSlotChange })));
  }
  renderHrefIcon(dir) {
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.h)("calcite-icon", { class: CSS.hoverHrefIcon, icon: dir === "rtl" ? "arrow-left" : "arrow-right", key: CSS.hoverHrefIcon, scale: "s" }));
  }
  renderItemContent(dir) {
    const hasHref = this.href && (this.topLevelMenuLayout === "vertical" || !this.isTopLevelItem);
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.h)(_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.Fragment, null, this.iconStart && this.renderIconStart(), (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.h)("div", { class: CSS.textContainer }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.h)("span", null, this.text)), hasHref && this.renderHrefIcon(dir), this.iconEnd && this.renderIconEnd(), this.breadcrumb ? this.renderBreadcrumbIcon(dir) : null, !this.href && this.hasSubmenu ? this.renderDropdownIcon(dir) : null));
  }
  render() {
    const dir = (0,_dom_js__WEBPACK_IMPORTED_MODULE_0__.b)(this.el);
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.h)(_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.Host, { onBlur: this.blurHandler, onFocus: this.focusHandler }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.h)("li", { class: {
        [CSS.container]: true,
        [CSS.isParentVertical]: this.topLevelMenuLayout === "vertical",
      }, role: "none" }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.h)("div", { class: CSS.itemContent }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.h)("a", { "aria-current": this.isFocused ? "page" : false, "aria-expanded": this.open, "aria-haspopup": this.hasSubmenu, "aria-label": this.label, class: { [CSS.layoutVertical]: this.layout === "vertical", [CSS.content]: true }, href: this.href, onClick: this.clickHandler, onKeyDown: this.keyDownHandler, rel: this.rel, role: "menuitem", tabIndex: this.isTopLevelItem ? 0 : -1, target: this.target,
      // eslint-disable-next-line react/jsx-sort-props -- ref should be last so node attrs/props are in sync (see https://github.com/Esri/calcite-design-system/pull/6530)
      ref: (el) => (this.anchorEl = el) }, this.renderItemContent(dir)), this.href && this.hasSubmenu ? this.renderDropdownAction(dir) : null), this.renderSubmenuItems(dir))));
  }
  static get assetsDirs() { return ["assets"]; }
  get el() { return this; }
  static get watchers() { return {
    "messageOverrides": ["onMessagesChange"],
    "effectiveLocale": ["effectiveLocaleChange"]
  }; }
  static get style() { return menuItemCss; }
}, [1, "calcite-menu-item", {
    "active": [516],
    "breadcrumb": [516],
    "href": [1],
    "iconEnd": [513, "icon-end"],
    "iconFlipRtl": [513, "icon-flip-rtl"],
    "iconStart": [513, "icon-start"],
    "isTopLevelItem": [4, "is-top-level-item"],
    "label": [1],
    "layout": [513],
    "messageOverrides": [1040],
    "messages": [1040],
    "open": [1540],
    "rel": [513],
    "target": [513],
    "text": [1],
    "topLevelMenuLayout": [1, "top-level-menu-layout"],
    "defaultMessages": [32],
    "effectiveLocale": [32],
    "hasSubmenu": [32],
    "submenuItems": [32],
    "setFocus": [64]
  }, [[8, "click", "handleClickOut"], [0, "focusout", "handleFocusOut"]]]);
function defineCustomElement$1() {
  if (typeof customElements === "undefined") {
    return;
  }
  const components = ["calcite-menu-item", "calcite-action", "calcite-icon", "calcite-loader", "calcite-menu"];
  components.forEach(tagName => { switch (tagName) {
    case "calcite-menu-item":
      if (!customElements.get(tagName)) {
        customElements.define(tagName, CalciteMenuItem$1);
      }
      break;
    case "calcite-action":
      if (!customElements.get(tagName)) {
        (0,_action_js__WEBPACK_IMPORTED_MODULE_4__.d)();
      }
      break;
    case "calcite-icon":
      if (!customElements.get(tagName)) {
        (0,_icon_js__WEBPACK_IMPORTED_MODULE_5__.d)();
      }
      break;
    case "calcite-loader":
      if (!customElements.get(tagName)) {
        (0,_loader_js__WEBPACK_IMPORTED_MODULE_6__.d)();
      }
      break;
    case "calcite-menu":
      if (!customElements.get(tagName)) {
        (0,_menu_js__WEBPACK_IMPORTED_MODULE_7__.d)();
      }
      break;
  } });
}
defineCustomElement$1();

const CalciteMenuItem = CalciteMenuItem$1;
const defineCustomElement = defineCustomElement$1;




/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/components/menu.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/components/menu.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   C: () => (/* binding */ CalciteMenu),
/* harmony export */   d: () => (/* binding */ defineCustomElement)
/* harmony export */ });
/* harmony import */ var _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @stencil/core/internal/client/index.js */ "./node_modules/@stencil/core/internal/client/index.js");
/* harmony import */ var _dom_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dom.js */ "./node_modules/@esri/calcite-components/dist/components/dom.js");
/* harmony import */ var _loadable_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./loadable.js */ "./node_modules/@esri/calcite-components/dist/components/loadable.js");
/* harmony import */ var _locale_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./locale.js */ "./node_modules/@esri/calcite-components/dist/components/locale.js");
/* harmony import */ var _t9n_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./t9n.js */ "./node_modules/@esri/calcite-components/dist/components/t9n.js");
/* harmony import */ var _observers_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./observers.js */ "./node_modules/@esri/calcite-components/dist/components/observers.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v1.7.0
 */







const allowedGlobalAttributes = ["lang", "role"];
const elementToComponentAndObserverOptionsMap = new Map();
let mutationObserver;
function updateGlobalAttributes(component, attributeFilter, reuseAttributes = false) {
  const { el } = component;
  const updatedAttributes = reuseAttributes ? component.globalAttributes : {};
  attributeFilter
    .filter((attr) => !!allowedGlobalAttributes.includes(attr) && !!el.hasAttribute(attr))
    .forEach((attr) => {
    const value = el.getAttribute(attr);
    if (value !== null) {
      updatedAttributes[attr] = value;
    }
  });
  component.globalAttributes = updatedAttributes;
}
function processMutations(mutations) {
  mutations.forEach(({ target }) => {
    const [component, options] = elementToComponentAndObserverOptionsMap.get(target);
    updateGlobalAttributes(component, options.attributeFilter);
  });
}
/**
 * Helper to set up listening for changes to global attributes.
 *
 * render(): VNode {
 * return (<Host>
 * <ul {...this.globalAttributes}></div>
 * </Host>);
 * }
 *
 * @param component
 * @param attributeFilter
 */
function watchGlobalAttributes(component, attributeFilter) {
  const { el } = component;
  const observerOptions = { attributeFilter };
  elementToComponentAndObserverOptionsMap.set(el, [component, observerOptions]);
  updateGlobalAttributes(component, attributeFilter, true);
  if (!mutationObserver) {
    mutationObserver = (0,_observers_js__WEBPACK_IMPORTED_MODULE_4__.c)("mutation", processMutations);
  }
  mutationObserver.observe(el, observerOptions);
}
/**
 * Helper remove listening for changes to inherited attributes.
 *
 * @param component
 */
function unwatchGlobalAttributes(component) {
  elementToComponentAndObserverOptionsMap.delete(component.el);
  // we explicitly process queued mutations and disconnect and reconnect
  // the observer until MutationObserver gets an `unobserve` method
  // see https://github.com/whatwg/dom/issues/126
  processMutations(mutationObserver.takeRecords());
  mutationObserver.disconnect();
  for (const [element, [, observerOptions]] of elementToComponentAndObserverOptionsMap.entries()) {
    mutationObserver.observe(element, observerOptions);
  }
}

const menuCss = ":host{display:flex}ul{margin:0px;display:inline-flex;block-size:100%;align-items:center;padding:0px}:host([layout=vertical]) ul{display:flex;inline-size:100%;flex-direction:column}:host([hidden]){display:none}[hidden]{display:none}";

const CalciteMenu = /*@__PURE__*/ (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_5__.proxyCustomElement)(class extends _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_5__.HTMLElement {
  constructor() {
    super();
    this.__registerHost();
    this.__attachShadow();
    this.menuItems = [];
    //--------------------------------------------------------------------------
    //
    //  Private Methods
    //
    //--------------------------------------------------------------------------
    this.handleMenuSlotChange = (event) => {
      this.menuItems = (0,_dom_js__WEBPACK_IMPORTED_MODULE_0__.s)(event);
      this.setMenuItemLayout(this.menuItems, this.layout);
    };
    this.label = undefined;
    this.layout = "horizontal";
    this.messageOverrides = undefined;
    this.messages = undefined;
    this.defaultMessages = undefined;
    this.effectiveLocale = "";
    this.globalAttributes = {
      role: "menubar",
    };
  }
  handleLayoutChange(value) {
    this.setMenuItemLayout(this.menuItems, value);
  }
  onMessagesChange() {
    /* wired up by t9n util */
  }
  effectiveLocaleChange() {
    (0,_t9n_js__WEBPACK_IMPORTED_MODULE_3__.u)(this, this.effectiveLocale);
  }
  //--------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  //--------------------------------------------------------------------------
  connectedCallback() {
    (0,_locale_js__WEBPACK_IMPORTED_MODULE_2__.c)(this);
    (0,_t9n_js__WEBPACK_IMPORTED_MODULE_3__.c)(this);
    watchGlobalAttributes(this, ["role"]);
  }
  async componentWillLoad() {
    (0,_loadable_js__WEBPACK_IMPORTED_MODULE_1__.a)(this);
    await (0,_t9n_js__WEBPACK_IMPORTED_MODULE_3__.s)(this);
  }
  componentDidLoad() {
    (0,_loadable_js__WEBPACK_IMPORTED_MODULE_1__.s)(this);
  }
  disconnectedCallback() {
    (0,_locale_js__WEBPACK_IMPORTED_MODULE_2__.d)(this);
    (0,_t9n_js__WEBPACK_IMPORTED_MODULE_3__.d)(this);
    unwatchGlobalAttributes(this);
  }
  //--------------------------------------------------------------------------
  //
  //  Public Methods
  //
  //--------------------------------------------------------------------------
  /** Sets focus on the component's first focusable element. */
  async setFocus() {
    await (0,_loadable_js__WEBPACK_IMPORTED_MODULE_1__.c)(this);
    this.el.focus();
  }
  //--------------------------------------------------------------------------
  //
  //  Event Listeners
  //
  //--------------------------------------------------------------------------
  calciteInternalNavMenuItemKeyEvent(event) {
    const target = event.target;
    const submenuItems = event.detail.children;
    const key = event.detail.event.key;
    event.stopPropagation();
    if (key === "ArrowDown") {
      if (target.layout === "vertical") {
        (0,_dom_js__WEBPACK_IMPORTED_MODULE_0__.i)(this.menuItems, target, "next", false);
      }
      else {
        if (event.detail.isSubmenuOpen) {
          submenuItems[0].setFocus();
        }
      }
    }
    else if (key === "ArrowUp") {
      if (this.layout === "vertical") {
        (0,_dom_js__WEBPACK_IMPORTED_MODULE_0__.i)(this.menuItems, target, "previous", false);
      }
      else {
        if (event.detail.isSubmenuOpen) {
          submenuItems[submenuItems.length - 1].setFocus();
        }
      }
    }
    else if (key === "ArrowRight") {
      if (this.layout === "horizontal") {
        (0,_dom_js__WEBPACK_IMPORTED_MODULE_0__.i)(this.menuItems, target, "next", false);
      }
      else {
        if (event.detail.isSubmenuOpen) {
          submenuItems[0].setFocus();
        }
      }
    }
    else if (key === "ArrowLeft") {
      if (this.layout === "horizontal") {
        (0,_dom_js__WEBPACK_IMPORTED_MODULE_0__.i)(this.menuItems, target, "previous", false);
      }
      else {
        if (event.detail.isSubmenuOpen) {
          this.focusParentElement(event.target);
        }
      }
    }
    else if (key === "Escape") {
      this.focusParentElement(event.target);
    }
    event.preventDefault();
  }
  focusParentElement(el) {
    const parentEl = el.parentElement;
    if (parentEl) {
      (0,_dom_js__WEBPACK_IMPORTED_MODULE_0__.k)(parentEl);
      parentEl.open = false;
    }
  }
  setMenuItemLayout(items, layout) {
    items.forEach((item) => {
      item.layout = layout;
      if (this.globalAttributes.role === "menubar") {
        item.isTopLevelItem = true;
        item.topLevelMenuLayout = this.layout;
      }
    });
  }
  // --------------------------------------------------------------------------
  //
  //  Render Methods
  //
  // --------------------------------------------------------------------------
  render() {
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_5__.h)(_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_5__.Host, null, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_5__.h)("ul", { "aria-label": this.label, ...this.globalAttributes }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_5__.h)("slot", { onSlotchange: this.handleMenuSlotChange }))));
  }
  static get delegatesFocus() { return true; }
  static get assetsDirs() { return ["assets"]; }
  get el() { return this; }
  static get watchers() { return {
    "layout": ["handleLayoutChange"],
    "messageOverrides": ["onMessagesChange"],
    "effectiveLocale": ["effectiveLocaleChange"]
  }; }
  static get style() { return menuCss; }
}, [17, "calcite-menu", {
    "label": [1],
    "layout": [513],
    "messageOverrides": [1040],
    "messages": [1040],
    "defaultMessages": [32],
    "effectiveLocale": [32],
    "globalAttributes": [32],
    "setFocus": [64]
  }, [[0, "calciteInternalMenuItemKeyEvent", "calciteInternalNavMenuItemKeyEvent"]]]);
function defineCustomElement() {
  if (typeof customElements === "undefined") {
    return;
  }
  const components = ["calcite-menu"];
  components.forEach(tagName => { switch (tagName) {
    case "calcite-menu":
      if (!customElements.get(tagName)) {
        customElements.define(tagName, CalciteMenu);
      }
      break;
  } });
}
defineCustomElement();




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfZXNyaV9jYWxjaXRlLWNvbXBvbmVudHNfZGlzdF9jb21wb25lbnRzX2NhbGNpdGUtbWVudS1pdGVtX2pzLmJ1bmRsZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDeUg7QUFDckI7QUFDVTtBQUNJO0FBQ3BDO0FBQ3JCO0FBQ0Y7QUFDRTtBQUNGOztBQUV2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSwyQkFBMkIsa0JBQWtCLHNCQUFzQixhQUFhLG1CQUFtQixjQUFjLG9EQUFvRCxvQkFBb0IseUJBQXlCLGlCQUFpQiwrQkFBK0IsZ0JBQWdCLHlCQUF5QixhQUFhLGdCQUFnQixpQkFBaUIsbUJBQW1CLG9CQUFvQixTQUFTLGtCQUFrQixzQkFBc0IsYUFBYSxnQkFBZ0IsaUJBQWlCLGVBQWUsbUJBQW1CLHVCQUF1QixnREFBZ0Qsb0JBQW9CLHFDQUFxQywrQkFBK0IsOEJBQThCLG1CQUFtQixxQkFBcUIsNENBQTRDLDZCQUE2QixlQUFlLGdEQUFnRCwrQkFBK0IsZUFBZSxnREFBZ0QsK0JBQStCLHlFQUF5RSxxUEFBcVAsZ0JBQWdCLGdEQUFnRCwrQkFBK0IsY0FBYyxvQkFBb0IsMEJBQTBCLGFBQWEsaUJBQWlCLDJCQUEyQixtQkFBbUIsbUJBQW1CLDRDQUE0Qyx5QkFBeUIsK0JBQStCLHFDQUFxQywrQkFBK0IsZ0RBQWdELGtDQUFrQyx1QkFBdUIsYUFBYSwwQkFBMEIsV0FBVyw0QkFBNEIsb0NBQW9DLHlCQUF5Qiw2QkFBNkIsZ0JBQWdCLGtCQUFrQix5QkFBeUIsc0JBQXNCLDRCQUE0QixpREFBaUQsb0RBQW9ELDRCQUE0QiwwQ0FBMEMsNEJBQTRCLHFEQUFxRCwyQkFBMkIsNERBQTRELDRCQUE0QixrQkFBa0Isc0JB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QUFDQTtBQUNBLHVCQUF1QjtBQUN2QixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFc0QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zeW52aWV3Ly4vbm9kZV9tb2R1bGVzL0Blc3JpL2NhbGNpdGUtY29tcG9uZW50cy9kaXN0L2NvbXBvbmVudHMvY2FsY2l0ZS1tZW51LWl0ZW0uanMiLCJ3ZWJwYWNrOi8vc3ludmlldy8uL25vZGVfbW9kdWxlcy9AZXNyaS9jYWxjaXRlLWNvbXBvbmVudHMvZGlzdC9jb21wb25lbnRzL21lbnUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtZGVzaWduLXN5c3RlbS9ibG9iL21haW4vTElDRU5TRS5tZCBmb3IgZGV0YWlscy5cbiAqIHYxLjcuMFxuICovXG5pbXBvcnQgeyBwcm94eUN1c3RvbUVsZW1lbnQsIEhUTUxFbGVtZW50LCBjcmVhdGVFdmVudCwgaCwgRnJhZ21lbnQsIEhvc3QgfSBmcm9tICdAc3RlbmNpbC9jb3JlL2ludGVybmFsL2NsaWVudC9pbmRleC5qcyc7XG5pbXBvcnQgeyBzIGFzIHNsb3RDaGFuZ2VHZXRBc3NpZ25lZEVsZW1lbnRzLCBDIGFzIENTU19VVElMSVRZLCBiIGFzIGdldEVsZW1lbnREaXIgfSBmcm9tICcuL2RvbS5qcyc7XG5pbXBvcnQgeyBjIGFzIGNvbXBvbmVudEZvY3VzYWJsZSwgYSBhcyBzZXRVcExvYWRhYmxlQ29tcG9uZW50LCBzIGFzIHNldENvbXBvbmVudExvYWRlZCB9IGZyb20gJy4vbG9hZGFibGUuanMnO1xuaW1wb3J0IHsgdSBhcyB1cGRhdGVNZXNzYWdlcywgYyBhcyBjb25uZWN0TWVzc2FnZXMsIHMgYXMgc2V0VXBNZXNzYWdlcywgZCBhcyBkaXNjb25uZWN0TWVzc2FnZXMgfSBmcm9tICcuL3Q5bi5qcyc7XG5pbXBvcnQgeyBjIGFzIGNvbm5lY3RMb2NhbGl6ZWQsIGQgYXMgZGlzY29ubmVjdExvY2FsaXplZCB9IGZyb20gJy4vbG9jYWxlLmpzJztcbmltcG9ydCB7IGQgYXMgZGVmaW5lQ3VzdG9tRWxlbWVudCQ1IH0gZnJvbSAnLi9hY3Rpb24uanMnO1xuaW1wb3J0IHsgZCBhcyBkZWZpbmVDdXN0b21FbGVtZW50JDQgfSBmcm9tICcuL2ljb24uanMnO1xuaW1wb3J0IHsgZCBhcyBkZWZpbmVDdXN0b21FbGVtZW50JDMgfSBmcm9tICcuL2xvYWRlci5qcyc7XG5pbXBvcnQgeyBkIGFzIGRlZmluZUN1c3RvbUVsZW1lbnQkMiB9IGZyb20gJy4vbWVudS5qcyc7XG5cbmNvbnN0IENTUyA9IHtcbiAgY29udGFpbmVyOiBcImNvbnRhaW5lclwiLFxuICBjb250ZW50OiBcImNvbnRlbnRcIixcbiAgZHJvcGRvd25WZXJ0aWNhbDogXCJkcm9wZG93bi0tdmVydGljYWxcIixcbiAgZHJvcGRvd25NZW51SXRlbXM6IFwiZHJvcGRvd24tbWVudS1pdGVtc1wiLFxuICBkcm9wZG93bkFjdGlvbjogXCJkcm9wZG93bi1hY3Rpb25cIixcbiAgbGF5b3V0VmVydGljYWw6IFwibGF5b3V0LS12ZXJ0aWNhbFwiLFxuICBob3ZlckhyZWZJY29uOiBcImhvdmVyLWhyZWYtaWNvblwiLFxuICBpY29uOiBcImljb25cIixcbiAgaWNvbkJyZWFkY3J1bWI6IFwiaWNvbi0tYnJlYWRjcnVtYlwiLFxuICBpY29uRHJvcGRvd246IFwiaWNvbi0tZHJvcGRvd25cIixcbiAgaWNvbkVuZDogXCJpY29uLS1lbmRcIixcbiAgaWNvblN0YXJ0OiBcImljb24tLXN0YXJ0XCIsXG4gIGlzUGFyZW50VmVydGljYWw6IFwicGFyZW50LS12ZXJ0aWNhbFwiLFxuICBpdGVtQ29udGVudDogXCJpdGVtLWNvbnRlbnRcIixcbiAgb3BlbjogXCJvcGVuXCIsXG4gIG5lc3RlZDogXCJuZXN0ZWRcIixcbiAgdGV4dENvbnRhaW5lcjogXCJ0ZXh0LWNvbnRhaW5lclwiLFxufTtcblxuY29uc3QgbWVudUl0ZW1Dc3MgPSBcIjpob3N0e3Bvc2l0aW9uOnJlbGF0aXZlO2JveC1zaXppbmc6Ym9yZGVyLWJveDtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2ZsZXgtc2hyaW5rOjB9Omhvc3QgLmNvbnRhaW5lciw6aG9zdCAuaXRlbS1jb250ZW50LDpob3N0IC5jb250ZW50e21pbi1ibG9jay1zaXplOjNyZW19Omhvc3QoW2xheW91dD12ZXJ0aWNhbF0pe2lubGluZS1zaXplOjEwMCV9Omhvc3QoOm5vdChbbGF5b3V0PXZlcnRpY2FsXSkpe2Jsb2NrLXNpemU6MTAwJX0uY29udGFpbmVyLC5pdGVtLWNvbnRlbnR7ZGlzcGxheTpmbGV4O2Jsb2NrLXNpemU6MTAwJTtpbmxpbmUtc2l6ZToxMDAlO2ZsZXgtZGlyZWN0aW9uOnJvdzthbGlnbi1pdGVtczpzdHJldGNofS5jb250ZW50e3Bvc2l0aW9uOnJlbGF0aXZlO2JveC1zaXppbmc6Ym9yZGVyLWJveDtkaXNwbGF5OmZsZXg7YmxvY2stc2l6ZToxMDAlO2lubGluZS1zaXplOjEwMCU7Y3Vyc29yOnBvaW50ZXI7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jYWxjaXRlLXVpLWZvcmVncm91bmQtMSk7cGFkZGluZy1pbmxpbmU6MXJlbTtmb250LXNpemU6dmFyKC0tY2FsY2l0ZS1mb250LXNpemUtMCk7Y29sb3I6dmFyKC0tY2FsY2l0ZS11aS10ZXh0LTIpO291dGxpbmU6MnB4IHNvbGlkIHRyYW5zcGFyZW50O291dGxpbmUtb2Zmc2V0OjJweDt0ZXh0LWRlY29yYXRpb246bm9uZTtib3JkZXItYmxvY2stZW5kOjAuMTI1cmVtIHNvbGlkIHRyYW5zcGFyZW50O3BhZGRpbmctYmxvY2stc3RhcnQ6MC4xMjVyZW19LmNvbnRlbnQ6aG92ZXJ7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jYWxjaXRlLXVpLWZvcmVncm91bmQtMik7Y29sb3I6dmFyKC0tY2FsY2l0ZS11aS10ZXh0LTIpfS5jb250ZW50OmZvY3Vze2JhY2tncm91bmQtY29sb3I6dmFyKC0tY2FsY2l0ZS11aS1mb3JlZ3JvdW5kLTIpO2NvbG9yOnZhcigtLWNhbGNpdGUtdWktdGV4dC0yKTtvdXRsaW5lOjJweCBzb2xpZCB2YXIoLS1jYWxjaXRlLXVpLWZvY3VzLWNvbG9yLCB2YXIoLS1jYWxjaXRlLXVpLWJyYW5kKSk7b3V0bGluZS1vZmZzZXQ6Y2FsYyhcXG4gICAgICAgICAgICAtMnB4ICpcXG4gICAgICAgICAgICBjYWxjKFxcbiAgICAgICAgICAgICAgMSAtXFxuICAgICAgICAgICAgICAyICogY2xhbXAoXFxuICAgICAgICAgICAgICAgIDAsXFxuICAgICAgICAgICAgICAgIHZhcigtLWNhbGNpdGUtdWktZm9jdXMtb2Zmc2V0LWludmVydCksXFxuICAgICAgICAgICAgICAgIDFcXG4gICAgICAgICAgICAgIClcXG4gICAgICAgICAgICApXFxuICAgICAgICAgICl9LmNvbnRlbnQ6YWN0aXZle2JhY2tncm91bmQtY29sb3I6dmFyKC0tY2FsY2l0ZS11aS1mb3JlZ3JvdW5kLTMpO2NvbG9yOnZhcigtLWNhbGNpdGUtdWktdGV4dC0xKX0uY29udGVudCBzcGFue2Rpc3BsYXk6aW5saW5lLWZsZXh9LmNvbnRlbnQubGF5b3V0LS12ZXJ0aWNhbHtkaXNwbGF5OmZsZXg7aW5saW5lLXNpemU6MTAwJTtqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1zdGFydDtwYWRkaW5nLWJsb2NrOjFyZW07Ym9yZGVyLWJsb2NrLWVuZDowO2JvcmRlci1pbmxpbmUtZW5kOjAuMjVyZW0gc29saWQgdHJhbnNwYXJlbnR9Omhvc3QoW2FjdGl2ZV0pIC5jb250ZW50e2NvbG9yOnZhcigtLWNhbGNpdGUtdWktdGV4dC0xKTtib3JkZXItY29sb3I6dmFyKC0tY2FsY2l0ZS11aS1icmFuZCl9Omhvc3QoW2FjdGl2ZV0pIC5jb250ZW50IC5pY29uey0tY2FsY2l0ZS11aS1pY29uLWNvbG9yOnZhcigtLWNhbGNpdGUtdWktYnJhbmQpfTpob3N0KFtsYXlvdXQ9dmVydGljYWxdKSAuY29udGVudHtwYWRkaW5nLWlubGluZTowLjc1cmVtfS5pY29uLS1zdGFydHttYXJnaW4taW5saW5lLWVuZDowLjc1cmVtfS5pY29uLS1lbmR7bWFyZ2luLWlubGluZS1zdGFydDowLjc1cmVtfTpob3N0KFtsYXlvdXQ9dmVydGljYWxdKSAuaWNvbi0tZW5ke21hcmdpbi1pbmxpbmUtc3RhcnQ6YXV0bztwYWRkaW5nLWlubGluZS1zdGFydDowLjc1cmVtfS5pY29uLS1kcm9wZG93bntwb3NpdGlvbjpyZWxhdGl2ZTttYXJnaW4taW5saW5lLXN0YXJ0OmF1dG87bWFyZ2luLWlubGluZS1lbmQ6MHB4O3BhZGRpbmctaW5saW5lLXN0YXJ0OjAuNXJlbTstLWNhbGNpdGUtdWktaWNvbi1jb2xvcjp2YXIoLS1jYWxjaXRlLXVpLXRleHQtMyl9Omhvc3QoW2xheW91dD12ZXJ0aWNhbF0pIC5pY29uLS1lbmR+Lmljb24tLWRyb3Bkb3due21hcmdpbi1pbmxpbmUtc3RhcnQ6MC43NXJlbX06aG9zdChbbGF5b3V0PXZlcnRpY2FsXSkgLmhvdmVyLWhyZWYtaWNvbntwYWRkaW5nLWlubGluZS1zdGFydDowLjVyZW19Omhvc3QoW2xheW91dD12ZXJ0aWNhbF0pIC5ob3Zlci1ocmVmLWljb25+Lmljb24tLWVuZHttYXJnaW4taW5saW5lLXN0YXJ0OjAuNXJlbX06aG9zdChbbGF5b3V0PXZlcnRpY2FsXSkgLmhvdmVyLWhyZWYtaWNvbn4uaWNvbi0tYnJlYWRjcnVtYnttYXJnaW4taW5saW5lLXN0YXJ0OjAuNzVyZW19Lmljb24tLWJyZWFkY3J1bWJ7bWFyZ2luLWlubGluZS1lbmQ6MHB4O3BhZGRpbmctaW5saW5lLXN0YXJ0OjAuNXJlbTstLWNhbGNpdGUtdWktaWNvbi1jb2xvcjp2YXIoLS1jYWxjaXRlLXVpLXRleHQtMyl9Omhvc3QoW2xheW91dD12ZXJ0aWNhbF0pIC5pY29uLS1icmVhZGNydW1ie21hcmdpbi1pbmxpbmUtc3RhcnQ6YXV0b306aG9zdChbbGF5b3V0PXZlcnRpY2FsXSkgLmljb24tLWJyZWFkY3J1bWJ+Lmljb24tLWRyb3Bkb3due21hcmdpbi1pbmxpbmUtc3RhcnQ6MC41cmVtfTpob3N0KFtsYXlvdXQ9dmVydGljYWxdKSAuaWNvbi0tZW5kfi5pY29uLS1icmVhZGNydW1ie21hcmdpbi1pbmxpbmUtc3RhcnQ6MC41cmVtfTpob3N0KFticmVhZGNydW1iXSkgLmNvbnRlbnR7cGFkZGluZy1pbmxpbmUtZW5kOjAuNzVyZW19Y2FsY2l0ZS1hY3Rpb257cG9zaXRpb246cmVsYXRpdmU7YmxvY2stc2l6ZTphdXRvO2JvcmRlci1pbmxpbmUtc3RhcnQ6MXB4IHNvbGlkIHZhcigtLWNhbGNpdGUtdWktZm9yZWdyb3VuZC0xKX1jYWxjaXRlLWFjdGlvbjphZnRlcntwb3NpdGlvbjphYnNvbHV0ZTtpbnNldC1pbmxpbmUtc3RhcnQ6LTFweDtkaXNwbGF5OmJsb2NrO2lubGluZS1zaXplOjFweDtjb250ZW50OlxcXCJcXFwiO2luc2V0LWJsb2NrOjAuNzVyZW07YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jYWxjaXRlLXVpLWJvcmRlci0zKX1jYWxjaXRlLWFjdGlvbjpob3ZlcjphZnRlcntibG9jay1zaXplOjEwMCU7aW5zZXQtYmxvY2s6MH0uY29udGVudDpmb2N1c35jYWxjaXRlLWFjdGlvbiwuY29udGVudDpob3Zlcn5jYWxjaXRlLWFjdGlvbntjb2xvcjp2YXIoLS1jYWxjaXRlLXVpLXRleHQtMSk7Ym9yZGVyLWlubGluZS1zdGFydDoxcHggc29saWQgdmFyKC0tY2FsY2l0ZS11aS1ib3JkZXItMyl9LmNvbnRhaW5lcjpob3ZlciAuZHJvcGRvd24tYWN0aW9ue2JhY2tncm91bmQtY29sb3I6dmFyKC0tY2FsY2l0ZS11aS1mb3JlZ3JvdW5kLTIpfS5kcm9wZG93bi1tZW51LWl0ZW1ze3Bvc2l0aW9uOmFic29sdXRlO2Rpc3BsYXk6bm9uZTtibG9jay1zaXplOmF1dG87bWluLWlubGluZS1zaXplOjEwMCU7ZmxleC1kaXJlY3Rpb246Y29sdW1uO292ZXJmbG93OnZpc2libGU7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1jYWxjaXRlLXVpLWJvcmRlci0zKTtiYWNrZ3JvdW5kOnZhcigtLWNhbGNpdGUtdWktZm9yZWdyb3VuZC0xKTtpbnNldC1ibG9jay1zdGFydDoxMDAlO3otaW5kZXg6dmFyKC0tY2FsY2l0ZS1hcHAtei1pbmRleC1kcm9wZG93bil9LmRyb3Bkb3duLW1lbnUtaXRlbXMub3BlbntkaXNwbGF5OmJsb2NrfS5kcm9wZG93bi1tZW51LWl0ZW1zLm5lc3RlZHtwb3NpdGlvbjphYnNvbHV0ZTtpbnNldC1ibG9jay1zdGFydDotMXB4O3RyYW5zZm9ybTp0cmFuc2xhdGVYKGNhbGMoMTAwJSAtIDJweCkpfS5wYXJlbnQtLXZlcnRpY2Fse2ZsZXgtZGlyZWN0aW9uOmNvbHVtbn0uZHJvcGRvd24tLXZlcnRpY2FsLmRyb3Bkb3duLW1lbnUtaXRlbXN7cG9zaXRpb246cmVsYXRpdmU7Ym9yZGVyLXJhZGl1czowcHg7Ym94LXNoYWRvdzpub25lO2luc2V0LWJsb2NrLXN0YXJ0OjA7dHJhbnNmb3JtOm5vbmV9LmRyb3Bkb3duLS12ZXJ0aWNhbC5kcm9wZG93bi1tZW51LWl0ZW1zOmxhc3Qtb2YtdHlwZXtib3JkZXItaW5saW5lOjB9Omhvc3QoW2xheW91dD12ZXJ0aWNhbF06bGFzdC1vZi10eXBlKSAuZHJvcGRvd24tbWVudS1pdGVtc3tib3JkZXItYmxvY2stZW5kOjB9Omhvc3QoW3Nsb3Q9c3VibWVudS1pdGVtXSkgLnBhcmVudC0tdmVydGljYWx7cGFkZGluZy1pbmxpbmUtc3RhcnQ6MS41cmVtfS5kcm9wZG93bi1tZW51LWl0ZW1zLm5lc3RlZC5jYWxjaXRlLS1ydGx7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoY2FsYygtMTAwJSArIDJweCkpfS5kcm9wZG93bi0tdmVydGljYWwuZHJvcGRvd24tbWVudS1pdGVtcy5uZXN0ZWQuY2FsY2l0ZS0tcnRse3RyYW5zZm9ybTpub25lfS5ob3Zlci1ocmVmLWljb257cG9zaXRpb246cmVsYXRpdmU7aW5zZXQtaW5saW5lLWVuZDowLjI1cmVtO21hcmdpbi1pbmxpbmUtc3RhcnQ6YXV0bztvcGFjaXR5OjA7dHJhbnNpdGlvbjphbGwgdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1hbmltYXRpb24tdGltaW5nLW1lZGl1bSkgZWFzZS1pbi1vdXR9LmNvbnRlbnQ6Zm9jdXMgLmhvdmVyLWhyZWYtaWNvbiwuY29udGVudDpob3ZlciAuaG92ZXItaHJlZi1pY29ue2luc2V0LWlubGluZS1lbmQ6LTAuMjVyZW07b3BhY2l0eToxfTpob3N0KFtoaWRkZW5dKXtkaXNwbGF5Om5vbmV9W2hpZGRlbl17ZGlzcGxheTpub25lfVwiO1xuXG5jb25zdCBDYWxjaXRlTWVudUl0ZW0kMSA9IC8qQF9fUFVSRV9fKi8gcHJveHlDdXN0b21FbGVtZW50KGNsYXNzIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuX19yZWdpc3Rlckhvc3QoKTtcbiAgICB0aGlzLl9fYXR0YWNoU2hhZG93KCk7XG4gICAgdGhpcy5jYWxjaXRlSW50ZXJuYWxNZW51SXRlbUtleUV2ZW50ID0gY3JlYXRlRXZlbnQodGhpcywgXCJjYWxjaXRlSW50ZXJuYWxNZW51SXRlbUtleUV2ZW50XCIsIDcpO1xuICAgIHRoaXMuY2FsY2l0ZU1lbnVJdGVtU2VsZWN0ID0gY3JlYXRlRXZlbnQodGhpcywgXCJjYWxjaXRlTWVudUl0ZW1TZWxlY3RcIiwgNyk7XG4gICAgdGhpcy5jbGlja0hhbmRsZXIgPSAoZXZlbnQpID0+IHtcbiAgICAgIGlmICgodGhpcy5ocmVmICYmIGV2ZW50LnRhcmdldCA9PT0gdGhpcy5kcm9wZG93bkFjdGlvbkVsKSB8fCAoIXRoaXMuaHJlZiAmJiB0aGlzLmhhc1N1Ym1lbnUpKSB7XG4gICAgICAgIHRoaXMub3BlbiA9ICF0aGlzLm9wZW47XG4gICAgICB9XG4gICAgICB0aGlzLnNlbGVjdE1lbnVJdGVtKGV2ZW50KTtcbiAgICB9O1xuICAgIHRoaXMuaGFuZGxlTWVudUl0ZW1TbG90Q2hhbmdlID0gKGV2ZW50KSA9PiB7XG4gICAgICB0aGlzLnN1Ym1lbnVJdGVtcyA9IHNsb3RDaGFuZ2VHZXRBc3NpZ25lZEVsZW1lbnRzKGV2ZW50KTtcbiAgICAgIHRoaXMuc3VibWVudUl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgaWYgKCFpdGVtLnRvcExldmVsTWVudUxheW91dCkge1xuICAgICAgICAgIGl0ZW0udG9wTGV2ZWxNZW51TGF5b3V0ID0gdGhpcy50b3BMZXZlbE1lbnVMYXlvdXQ7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgdGhpcy5oYXNTdWJtZW51ID0gdGhpcy5zdWJtZW51SXRlbXMubGVuZ3RoID4gMDtcbiAgICB9O1xuICAgIHRoaXMua2V5RG93bkhhbmRsZXIgPSBhc3luYyAoZXZlbnQpID0+IHtcbiAgICAgIC8vIG9wZW5pbmcgYW5kIGNsb3Npbmcgb2Ygc3VibWVudSBpcyBoYW5kbGVkIGhlcmUuIEFueSBvdGhlciBmdW5jdGlvbmFsaXR5IGlzIGJ1YmJsZWQgdG8gcGFyZW50IG1lbnUuXG4gICAgICBpZiAoZXZlbnQua2V5ID09PSBcIiBcIiB8fCBldmVudC5rZXkgPT09IFwiRW50ZXJcIikge1xuICAgICAgICB0aGlzLnNlbGVjdE1lbnVJdGVtKGV2ZW50KTtcbiAgICAgICAgaWYgKHRoaXMuaGFzU3VibWVudSAmJlxuICAgICAgICAgICghdGhpcy5ocmVmIHx8ICh0aGlzLmhyZWYgJiYgZXZlbnQudGFyZ2V0ID09PSB0aGlzLmRyb3Bkb3duQWN0aW9uRWwpKSkge1xuICAgICAgICAgIHRoaXMub3BlbiA9ICF0aGlzLm9wZW47XG4gICAgICAgIH1cbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgICBpZiAodGhpcy5vcGVuKSB7XG4gICAgICAgICAgdGhpcy5vcGVuID0gZmFsc2U7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2FsY2l0ZUludGVybmFsTWVudUl0ZW1LZXlFdmVudC5lbWl0KHsgZXZlbnQgfSk7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChldmVudC5rZXkgPT09IFwiQXJyb3dEb3duXCIgfHwgZXZlbnQua2V5ID09PSBcIkFycm93VXBcIikge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBpZiAoKGV2ZW50LnRhcmdldCA9PT0gdGhpcy5kcm9wZG93bkFjdGlvbkVsIHx8ICF0aGlzLmhyZWYpICYmXG4gICAgICAgICAgdGhpcy5oYXNTdWJtZW51ICYmXG4gICAgICAgICAgIXRoaXMub3BlbiAmJlxuICAgICAgICAgIHRoaXMubGF5b3V0ID09PSBcImhvcml6b250YWxcIikge1xuICAgICAgICAgIHRoaXMub3BlbiA9IHRydWU7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2FsY2l0ZUludGVybmFsTWVudUl0ZW1LZXlFdmVudC5lbWl0KHtcbiAgICAgICAgICBldmVudCxcbiAgICAgICAgICBjaGlsZHJlbjogdGhpcy5zdWJtZW51SXRlbXMsXG4gICAgICAgICAgaXNTdWJtZW51T3BlbjogdGhpcy5vcGVuICYmIHRoaXMuaGFzU3VibWVudSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChldmVudC5rZXkgPT09IFwiQXJyb3dMZWZ0XCIpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5jYWxjaXRlSW50ZXJuYWxNZW51SXRlbUtleUV2ZW50LmVtaXQoe1xuICAgICAgICAgIGV2ZW50LFxuICAgICAgICAgIGNoaWxkcmVuOiB0aGlzLnN1Ym1lbnVJdGVtcyxcbiAgICAgICAgICBpc1N1Ym1lbnVPcGVuOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gXCJBcnJvd1JpZ2h0XCIpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgaWYgKChldmVudC50YXJnZXQgPT09IHRoaXMuZHJvcGRvd25BY3Rpb25FbCB8fCAhdGhpcy5ocmVmKSAmJlxuICAgICAgICAgIHRoaXMuaGFzU3VibWVudSAmJlxuICAgICAgICAgICF0aGlzLm9wZW4gJiZcbiAgICAgICAgICB0aGlzLmxheW91dCA9PT0gXCJ2ZXJ0aWNhbFwiKSB7XG4gICAgICAgICAgdGhpcy5vcGVuID0gdHJ1ZTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jYWxjaXRlSW50ZXJuYWxNZW51SXRlbUtleUV2ZW50LmVtaXQoe1xuICAgICAgICAgIGV2ZW50LFxuICAgICAgICAgIGNoaWxkcmVuOiB0aGlzLnN1Ym1lbnVJdGVtcyxcbiAgICAgICAgICBpc1N1Ym1lbnVPcGVuOiB0aGlzLm9wZW4gJiYgdGhpcy5oYXNTdWJtZW51LFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMuYWN0aXZlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuYnJlYWRjcnVtYiA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmhyZWYgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5pY29uRW5kID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuaWNvbkZsaXBSdGwgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5pY29uU3RhcnQgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5pc1RvcExldmVsSXRlbSA9IGZhbHNlO1xuICAgIHRoaXMubGFiZWwgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5sYXlvdXQgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5tZXNzYWdlT3ZlcnJpZGVzID0gdW5kZWZpbmVkO1xuICAgIHRoaXMubWVzc2FnZXMgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5vcGVuID0gZmFsc2U7XG4gICAgdGhpcy5yZWwgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy50YXJnZXQgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy50ZXh0ID0gdW5kZWZpbmVkO1xuICAgIHRoaXMudG9wTGV2ZWxNZW51TGF5b3V0ID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuZGVmYXVsdE1lc3NhZ2VzID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuZWZmZWN0aXZlTG9jYWxlID0gXCJcIjtcbiAgICB0aGlzLmhhc1N1Ym1lbnUgPSBmYWxzZTtcbiAgICB0aGlzLnN1Ym1lbnVJdGVtcyA9IHVuZGVmaW5lZDtcbiAgfVxuICBvbk1lc3NhZ2VzQ2hhbmdlKCkge1xuICAgIC8qIHdpcmVkIHVwIGJ5IHQ5biB1dGlsICovXG4gIH1cbiAgZWZmZWN0aXZlTG9jYWxlQ2hhbmdlKCkge1xuICAgIHVwZGF0ZU1lc3NhZ2VzKHRoaXMsIHRoaXMuZWZmZWN0aXZlTG9jYWxlKTtcbiAgfVxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBQdWJsaWMgTWV0aG9kc1xuICAvL1xuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8qKiBTZXRzIGZvY3VzIG9uIHRoZSBjb21wb25lbnQuICovXG4gIGFzeW5jIHNldEZvY3VzKCkge1xuICAgIGF3YWl0IGNvbXBvbmVudEZvY3VzYWJsZSh0aGlzKTtcbiAgICB0aGlzLmFuY2hvckVsLmZvY3VzKCk7XG4gIH1cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgRXZlbnQgTGlzdGVuZXJzXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgaGFuZGxlQ2xpY2tPdXQoZXZlbnQpIHtcbiAgICBpZiAodGhpcy50b3BMZXZlbE1lbnVMYXlvdXQgIT09IFwidmVydGljYWxcIiAmJlxuICAgICAgdGhpcy5oYXNTdWJtZW51ICYmXG4gICAgICB0aGlzLm9wZW4gJiZcbiAgICAgICFldmVudC5jb21wb3NlZFBhdGgoKS5pbmNsdWRlcyh0aGlzLmVsKSkge1xuICAgICAgdGhpcy5vcGVuID0gZmFsc2U7XG4gICAgfVxuICB9XG4gIGhhbmRsZUZvY3VzT3V0KGV2ZW50KSB7XG4gICAgaWYgKHRoaXMudG9wTGV2ZWxNZW51TGF5b3V0ICE9PSBcInZlcnRpY2FsXCIgJiZcbiAgICAgICF0aGlzLmVsLmNvbnRhaW5zKGV2ZW50LnJlbGF0ZWRUYXJnZXQpKSB7XG4gICAgICB0aGlzLm9wZW4gPSBmYWxzZTtcbiAgICB9XG4gIH1cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgTGlmZWN5Y2xlXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgY29ubmVjdExvY2FsaXplZCh0aGlzKTtcbiAgICBjb25uZWN0TWVzc2FnZXModGhpcyk7XG4gIH1cbiAgYXN5bmMgY29tcG9uZW50V2lsbExvYWQoKSB7XG4gICAgc2V0VXBMb2FkYWJsZUNvbXBvbmVudCh0aGlzKTtcbiAgICBhd2FpdCBzZXRVcE1lc3NhZ2VzKHRoaXMpO1xuICB9XG4gIGNvbXBvbmVudERpZExvYWQoKSB7XG4gICAgc2V0Q29tcG9uZW50TG9hZGVkKHRoaXMpO1xuICB9XG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIGRpc2Nvbm5lY3RMb2NhbGl6ZWQodGhpcyk7XG4gICAgZGlzY29ubmVjdE1lc3NhZ2VzKHRoaXMpO1xuICB9XG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBQcml2YXRlIE1ldGhvZHNcbiAgLy9cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgYmx1ckhhbmRsZXIoKSB7XG4gICAgdGhpcy5pc0ZvY3VzZWQgPSBmYWxzZTtcbiAgfVxuICBmb2N1c0hhbmRsZXIoZXZlbnQpIHtcbiAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG4gICAgdGhpcy5pc0ZvY3VzZWQgPSB0cnVlO1xuICAgIGlmICh0YXJnZXQub3BlbiAmJiAhdGhpcy5vcGVuKSB7XG4gICAgICB0YXJnZXQub3BlbiA9IGZhbHNlO1xuICAgIH1cbiAgfVxuICBzZWxlY3RNZW51SXRlbShldmVudCkge1xuICAgIGlmIChldmVudC50YXJnZXQgIT09IHRoaXMuZHJvcGRvd25BY3Rpb25FbCkge1xuICAgICAgdGhpcy5jYWxjaXRlTWVudUl0ZW1TZWxlY3QuZW1pdCgpO1xuICAgIH1cbiAgfVxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBSZW5kZXIgTWV0aG9kc1xuICAvL1xuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIHJlbmRlckljb25TdGFydCgpIHtcbiAgICByZXR1cm4gKGgoXCJjYWxjaXRlLWljb25cIiwgeyBjbGFzczogYCR7Q1NTLmljb259ICR7Q1NTLmljb25TdGFydH1gLCBmbGlwUnRsOiB0aGlzLmljb25GbGlwUnRsID09PSBcInN0YXJ0XCIgfHwgdGhpcy5pY29uRmxpcFJ0bCA9PT0gXCJib3RoXCIsIGljb246IHRoaXMuaWNvblN0YXJ0LCBrZXk6IENTUy5pY29uU3RhcnQsIHNjYWxlOiBcInNcIiB9KSk7XG4gIH1cbiAgcmVuZGVySWNvbkVuZCgpIHtcbiAgICByZXR1cm4gKGgoXCJjYWxjaXRlLWljb25cIiwgeyBjbGFzczogYCR7Q1NTLmljb259ICR7Q1NTLmljb25FbmR9YCwgZmxpcFJ0bDogdGhpcy5pY29uRmxpcFJ0bCA9PT0gXCJlbmRcIiB8fCB0aGlzLmljb25GbGlwUnRsID09PSBcImJvdGhcIiwgaWNvbjogdGhpcy5pY29uRW5kLCBrZXk6IENTUy5pY29uRW5kLCBzY2FsZTogXCJzXCIgfSkpO1xuICB9XG4gIHJlbmRlckJyZWFkY3J1bWJJY29uKGRpcikge1xuICAgIHJldHVybiAoaChcImNhbGNpdGUtaWNvblwiLCB7IGNsYXNzOiBgJHtDU1MuaWNvbn0gJHtDU1MuaWNvbkJyZWFkY3J1bWJ9YCwgaWNvbjogZGlyID09PSBcInJ0bFwiID8gXCJjaGV2cm9uLWxlZnRcIiA6IFwiY2hldnJvbi1yaWdodFwiLCBrZXk6IENTUy5pY29uQnJlYWRjcnVtYiwgc2NhbGU6IFwic1wiIH0pKTtcbiAgfVxuICByZW5kZXJEcm9wZG93bkljb24oZGlyKSB7XG4gICAgY29uc3QgZGlyQ2hldnJvbiA9IGRpciA9PT0gXCJydGxcIiA/IFwiY2hldnJvbi1sZWZ0XCIgOiBcImNoZXZyb24tcmlnaHRcIjtcbiAgICByZXR1cm4gKGgoXCJjYWxjaXRlLWljb25cIiwgeyBjbGFzczogYCR7Q1NTLmljb259ICR7Q1NTLmljb25Ecm9wZG93bn1gLCBpY29uOiB0aGlzLnRvcExldmVsTWVudUxheW91dCA9PT0gXCJ2ZXJ0aWNhbFwiIHx8IHRoaXMuaXNUb3BMZXZlbEl0ZW1cbiAgICAgICAgPyB0aGlzLm9wZW5cbiAgICAgICAgICA/IFwiY2hldnJvbi11cFwiXG4gICAgICAgICAgOiBcImNoZXZyb24tZG93blwiXG4gICAgICAgIDogZGlyQ2hldnJvbiwga2V5OiBDU1MuaWNvbkRyb3Bkb3duLCBzY2FsZTogXCJzXCIgfSkpO1xuICB9XG4gIHJlbmRlckRyb3Bkb3duQWN0aW9uKGRpcikge1xuICAgIGNvbnN0IGRpckNoZXZyb24gPSBkaXIgPT09IFwicnRsXCIgPyBcImNoZXZyb24tbGVmdFwiIDogXCJjaGV2cm9uLXJpZ2h0XCI7XG4gICAgcmV0dXJuIChoKFwiY2FsY2l0ZS1hY3Rpb25cIiwgeyBjbGFzczogQ1NTLmRyb3Bkb3duQWN0aW9uLCBpY29uOiB0aGlzLnRvcExldmVsTWVudUxheW91dCA9PT0gXCJ2ZXJ0aWNhbFwiIHx8IHRoaXMuaXNUb3BMZXZlbEl0ZW1cbiAgICAgICAgPyB0aGlzLm9wZW5cbiAgICAgICAgICA/IFwiY2hldnJvbi11cFwiXG4gICAgICAgICAgOiBcImNoZXZyb24tZG93blwiXG4gICAgICAgIDogZGlyQ2hldnJvbiwga2V5OiBDU1MuZHJvcGRvd25BY3Rpb24sIG9uQ2xpY2s6IHRoaXMuY2xpY2tIYW5kbGVyLCBvbktleURvd246IHRoaXMua2V5RG93bkhhbmRsZXIsIHRleHQ6IHRoaXMubWVzc2FnZXMub3BlbixcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC9qc3gtc29ydC1wcm9wcyAtLSByZWYgc2hvdWxkIGJlIGxhc3Qgc28gbm9kZSBhdHRycy9wcm9wcyBhcmUgaW4gc3luYyAoc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtZGVzaWduLXN5c3RlbS9wdWxsLzY1MzApXG4gICAgICByZWY6IChlbCkgPT4gKHRoaXMuZHJvcGRvd25BY3Rpb25FbCA9IGVsKSB9KSk7XG4gIH1cbiAgcmVuZGVyU3VibWVudUl0ZW1zKGRpcikge1xuICAgIHJldHVybiAoaChcImNhbGNpdGUtbWVudVwiLCB7IGNsYXNzOiB7XG4gICAgICAgIFtDU1MuZHJvcGRvd25NZW51SXRlbXNdOiB0cnVlLFxuICAgICAgICBbQ1NTLm9wZW5dOiB0aGlzLm9wZW4sXG4gICAgICAgIFtDU1MubmVzdGVkXTogIXRoaXMuaXNUb3BMZXZlbEl0ZW0sXG4gICAgICAgIFtDU1NfVVRJTElUWS5ydGxdOiBkaXIgPT09IFwicnRsXCIsXG4gICAgICAgIFtDU1MuZHJvcGRvd25WZXJ0aWNhbF06IHRoaXMudG9wTGV2ZWxNZW51TGF5b3V0ID09PSBcInZlcnRpY2FsXCIsXG4gICAgICB9LCBsYWJlbDogdGhpcy5tZXNzYWdlcy5zdWJtZW51LCBsYXlvdXQ6IFwidmVydGljYWxcIiwgcm9sZTogXCJtZW51XCIgfSwgaChcInNsb3RcIiwgeyBuYW1lOiBcInN1Ym1lbnUtaXRlbVwiLCBvblNsb3RjaGFuZ2U6IHRoaXMuaGFuZGxlTWVudUl0ZW1TbG90Q2hhbmdlIH0pKSk7XG4gIH1cbiAgcmVuZGVySHJlZkljb24oZGlyKSB7XG4gICAgcmV0dXJuIChoKFwiY2FsY2l0ZS1pY29uXCIsIHsgY2xhc3M6IENTUy5ob3ZlckhyZWZJY29uLCBpY29uOiBkaXIgPT09IFwicnRsXCIgPyBcImFycm93LWxlZnRcIiA6IFwiYXJyb3ctcmlnaHRcIiwga2V5OiBDU1MuaG92ZXJIcmVmSWNvbiwgc2NhbGU6IFwic1wiIH0pKTtcbiAgfVxuICByZW5kZXJJdGVtQ29udGVudChkaXIpIHtcbiAgICBjb25zdCBoYXNIcmVmID0gdGhpcy5ocmVmICYmICh0aGlzLnRvcExldmVsTWVudUxheW91dCA9PT0gXCJ2ZXJ0aWNhbFwiIHx8ICF0aGlzLmlzVG9wTGV2ZWxJdGVtKTtcbiAgICByZXR1cm4gKGgoRnJhZ21lbnQsIG51bGwsIHRoaXMuaWNvblN0YXJ0ICYmIHRoaXMucmVuZGVySWNvblN0YXJ0KCksIGgoXCJkaXZcIiwgeyBjbGFzczogQ1NTLnRleHRDb250YWluZXIgfSwgaChcInNwYW5cIiwgbnVsbCwgdGhpcy50ZXh0KSksIGhhc0hyZWYgJiYgdGhpcy5yZW5kZXJIcmVmSWNvbihkaXIpLCB0aGlzLmljb25FbmQgJiYgdGhpcy5yZW5kZXJJY29uRW5kKCksIHRoaXMuYnJlYWRjcnVtYiA/IHRoaXMucmVuZGVyQnJlYWRjcnVtYkljb24oZGlyKSA6IG51bGwsICF0aGlzLmhyZWYgJiYgdGhpcy5oYXNTdWJtZW51ID8gdGhpcy5yZW5kZXJEcm9wZG93bkljb24oZGlyKSA6IG51bGwpKTtcbiAgfVxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgZGlyID0gZ2V0RWxlbWVudERpcih0aGlzLmVsKTtcbiAgICByZXR1cm4gKGgoSG9zdCwgeyBvbkJsdXI6IHRoaXMuYmx1ckhhbmRsZXIsIG9uRm9jdXM6IHRoaXMuZm9jdXNIYW5kbGVyIH0sIGgoXCJsaVwiLCB7IGNsYXNzOiB7XG4gICAgICAgIFtDU1MuY29udGFpbmVyXTogdHJ1ZSxcbiAgICAgICAgW0NTUy5pc1BhcmVudFZlcnRpY2FsXTogdGhpcy50b3BMZXZlbE1lbnVMYXlvdXQgPT09IFwidmVydGljYWxcIixcbiAgICAgIH0sIHJvbGU6IFwibm9uZVwiIH0sIGgoXCJkaXZcIiwgeyBjbGFzczogQ1NTLml0ZW1Db250ZW50IH0sIGgoXCJhXCIsIHsgXCJhcmlhLWN1cnJlbnRcIjogdGhpcy5pc0ZvY3VzZWQgPyBcInBhZ2VcIiA6IGZhbHNlLCBcImFyaWEtZXhwYW5kZWRcIjogdGhpcy5vcGVuLCBcImFyaWEtaGFzcG9wdXBcIjogdGhpcy5oYXNTdWJtZW51LCBcImFyaWEtbGFiZWxcIjogdGhpcy5sYWJlbCwgY2xhc3M6IHsgW0NTUy5sYXlvdXRWZXJ0aWNhbF06IHRoaXMubGF5b3V0ID09PSBcInZlcnRpY2FsXCIsIFtDU1MuY29udGVudF06IHRydWUgfSwgaHJlZjogdGhpcy5ocmVmLCBvbkNsaWNrOiB0aGlzLmNsaWNrSGFuZGxlciwgb25LZXlEb3duOiB0aGlzLmtleURvd25IYW5kbGVyLCByZWw6IHRoaXMucmVsLCByb2xlOiBcIm1lbnVpdGVtXCIsIHRhYkluZGV4OiB0aGlzLmlzVG9wTGV2ZWxJdGVtID8gMCA6IC0xLCB0YXJnZXQ6IHRoaXMudGFyZ2V0LFxuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0L2pzeC1zb3J0LXByb3BzIC0tIHJlZiBzaG91bGQgYmUgbGFzdCBzbyBub2RlIGF0dHJzL3Byb3BzIGFyZSBpbiBzeW5jIChzZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1kZXNpZ24tc3lzdGVtL3B1bGwvNjUzMClcbiAgICAgIHJlZjogKGVsKSA9PiAodGhpcy5hbmNob3JFbCA9IGVsKSB9LCB0aGlzLnJlbmRlckl0ZW1Db250ZW50KGRpcikpLCB0aGlzLmhyZWYgJiYgdGhpcy5oYXNTdWJtZW51ID8gdGhpcy5yZW5kZXJEcm9wZG93bkFjdGlvbihkaXIpIDogbnVsbCksIHRoaXMucmVuZGVyU3VibWVudUl0ZW1zKGRpcikpKSk7XG4gIH1cbiAgc3RhdGljIGdldCBhc3NldHNEaXJzKCkgeyByZXR1cm4gW1wiYXNzZXRzXCJdOyB9XG4gIGdldCBlbCgpIHsgcmV0dXJuIHRoaXM7IH1cbiAgc3RhdGljIGdldCB3YXRjaGVycygpIHsgcmV0dXJuIHtcbiAgICBcIm1lc3NhZ2VPdmVycmlkZXNcIjogW1wib25NZXNzYWdlc0NoYW5nZVwiXSxcbiAgICBcImVmZmVjdGl2ZUxvY2FsZVwiOiBbXCJlZmZlY3RpdmVMb2NhbGVDaGFuZ2VcIl1cbiAgfTsgfVxuICBzdGF0aWMgZ2V0IHN0eWxlKCkgeyByZXR1cm4gbWVudUl0ZW1Dc3M7IH1cbn0sIFsxLCBcImNhbGNpdGUtbWVudS1pdGVtXCIsIHtcbiAgICBcImFjdGl2ZVwiOiBbNTE2XSxcbiAgICBcImJyZWFkY3J1bWJcIjogWzUxNl0sXG4gICAgXCJocmVmXCI6IFsxXSxcbiAgICBcImljb25FbmRcIjogWzUxMywgXCJpY29uLWVuZFwiXSxcbiAgICBcImljb25GbGlwUnRsXCI6IFs1MTMsIFwiaWNvbi1mbGlwLXJ0bFwiXSxcbiAgICBcImljb25TdGFydFwiOiBbNTEzLCBcImljb24tc3RhcnRcIl0sXG4gICAgXCJpc1RvcExldmVsSXRlbVwiOiBbNCwgXCJpcy10b3AtbGV2ZWwtaXRlbVwiXSxcbiAgICBcImxhYmVsXCI6IFsxXSxcbiAgICBcImxheW91dFwiOiBbNTEzXSxcbiAgICBcIm1lc3NhZ2VPdmVycmlkZXNcIjogWzEwNDBdLFxuICAgIFwibWVzc2FnZXNcIjogWzEwNDBdLFxuICAgIFwib3BlblwiOiBbMTU0MF0sXG4gICAgXCJyZWxcIjogWzUxM10sXG4gICAgXCJ0YXJnZXRcIjogWzUxM10sXG4gICAgXCJ0ZXh0XCI6IFsxXSxcbiAgICBcInRvcExldmVsTWVudUxheW91dFwiOiBbMSwgXCJ0b3AtbGV2ZWwtbWVudS1sYXlvdXRcIl0sXG4gICAgXCJkZWZhdWx0TWVzc2FnZXNcIjogWzMyXSxcbiAgICBcImVmZmVjdGl2ZUxvY2FsZVwiOiBbMzJdLFxuICAgIFwiaGFzU3VibWVudVwiOiBbMzJdLFxuICAgIFwic3VibWVudUl0ZW1zXCI6IFszMl0sXG4gICAgXCJzZXRGb2N1c1wiOiBbNjRdXG4gIH0sIFtbOCwgXCJjbGlja1wiLCBcImhhbmRsZUNsaWNrT3V0XCJdLCBbMCwgXCJmb2N1c291dFwiLCBcImhhbmRsZUZvY3VzT3V0XCJdXV0pO1xuZnVuY3Rpb24gZGVmaW5lQ3VzdG9tRWxlbWVudCQxKCkge1xuICBpZiAodHlwZW9mIGN1c3RvbUVsZW1lbnRzID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGNvbXBvbmVudHMgPSBbXCJjYWxjaXRlLW1lbnUtaXRlbVwiLCBcImNhbGNpdGUtYWN0aW9uXCIsIFwiY2FsY2l0ZS1pY29uXCIsIFwiY2FsY2l0ZS1sb2FkZXJcIiwgXCJjYWxjaXRlLW1lbnVcIl07XG4gIGNvbXBvbmVudHMuZm9yRWFjaCh0YWdOYW1lID0+IHsgc3dpdGNoICh0YWdOYW1lKSB7XG4gICAgY2FzZSBcImNhbGNpdGUtbWVudS1pdGVtXCI6XG4gICAgICBpZiAoIWN1c3RvbUVsZW1lbnRzLmdldCh0YWdOYW1lKSkge1xuICAgICAgICBjdXN0b21FbGVtZW50cy5kZWZpbmUodGFnTmFtZSwgQ2FsY2l0ZU1lbnVJdGVtJDEpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImNhbGNpdGUtYWN0aW9uXCI6XG4gICAgICBpZiAoIWN1c3RvbUVsZW1lbnRzLmdldCh0YWdOYW1lKSkge1xuICAgICAgICBkZWZpbmVDdXN0b21FbGVtZW50JDUoKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJjYWxjaXRlLWljb25cIjpcbiAgICAgIGlmICghY3VzdG9tRWxlbWVudHMuZ2V0KHRhZ05hbWUpKSB7XG4gICAgICAgIGRlZmluZUN1c3RvbUVsZW1lbnQkNCgpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImNhbGNpdGUtbG9hZGVyXCI6XG4gICAgICBpZiAoIWN1c3RvbUVsZW1lbnRzLmdldCh0YWdOYW1lKSkge1xuICAgICAgICBkZWZpbmVDdXN0b21FbGVtZW50JDMoKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJjYWxjaXRlLW1lbnVcIjpcbiAgICAgIGlmICghY3VzdG9tRWxlbWVudHMuZ2V0KHRhZ05hbWUpKSB7XG4gICAgICAgIGRlZmluZUN1c3RvbUVsZW1lbnQkMigpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gIH0gfSk7XG59XG5kZWZpbmVDdXN0b21FbGVtZW50JDEoKTtcblxuY29uc3QgQ2FsY2l0ZU1lbnVJdGVtID0gQ2FsY2l0ZU1lbnVJdGVtJDE7XG5jb25zdCBkZWZpbmVDdXN0b21FbGVtZW50ID0gZGVmaW5lQ3VzdG9tRWxlbWVudCQxO1xuXG5leHBvcnQgeyBDYWxjaXRlTWVudUl0ZW0sIGRlZmluZUN1c3RvbUVsZW1lbnQgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWRlc2lnbi1zeXN0ZW0vYmxvYi9tYWluL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2MS43LjBcbiAqL1xuaW1wb3J0IHsgcHJveHlDdXN0b21FbGVtZW50LCBIVE1MRWxlbWVudCwgaCwgSG9zdCB9IGZyb20gJ0BzdGVuY2lsL2NvcmUvaW50ZXJuYWwvY2xpZW50L2luZGV4LmpzJztcbmltcG9ydCB7IHMgYXMgc2xvdENoYW5nZUdldEFzc2lnbmVkRWxlbWVudHMsIGkgYXMgZm9jdXNFbGVtZW50SW5Hcm91cCwgayBhcyBmb2N1c0VsZW1lbnQgfSBmcm9tICcuL2RvbS5qcyc7XG5pbXBvcnQgeyBhIGFzIHNldFVwTG9hZGFibGVDb21wb25lbnQsIHMgYXMgc2V0Q29tcG9uZW50TG9hZGVkLCBjIGFzIGNvbXBvbmVudEZvY3VzYWJsZSB9IGZyb20gJy4vbG9hZGFibGUuanMnO1xuaW1wb3J0IHsgYyBhcyBjb25uZWN0TG9jYWxpemVkLCBkIGFzIGRpc2Nvbm5lY3RMb2NhbGl6ZWQgfSBmcm9tICcuL2xvY2FsZS5qcyc7XG5pbXBvcnQgeyB1IGFzIHVwZGF0ZU1lc3NhZ2VzLCBjIGFzIGNvbm5lY3RNZXNzYWdlcywgcyBhcyBzZXRVcE1lc3NhZ2VzLCBkIGFzIGRpc2Nvbm5lY3RNZXNzYWdlcyB9IGZyb20gJy4vdDluLmpzJztcbmltcG9ydCB7IGMgYXMgY3JlYXRlT2JzZXJ2ZXIgfSBmcm9tICcuL29ic2VydmVycy5qcyc7XG5cbmNvbnN0IGFsbG93ZWRHbG9iYWxBdHRyaWJ1dGVzID0gW1wibGFuZ1wiLCBcInJvbGVcIl07XG5jb25zdCBlbGVtZW50VG9Db21wb25lbnRBbmRPYnNlcnZlck9wdGlvbnNNYXAgPSBuZXcgTWFwKCk7XG5sZXQgbXV0YXRpb25PYnNlcnZlcjtcbmZ1bmN0aW9uIHVwZGF0ZUdsb2JhbEF0dHJpYnV0ZXMoY29tcG9uZW50LCBhdHRyaWJ1dGVGaWx0ZXIsIHJldXNlQXR0cmlidXRlcyA9IGZhbHNlKSB7XG4gIGNvbnN0IHsgZWwgfSA9IGNvbXBvbmVudDtcbiAgY29uc3QgdXBkYXRlZEF0dHJpYnV0ZXMgPSByZXVzZUF0dHJpYnV0ZXMgPyBjb21wb25lbnQuZ2xvYmFsQXR0cmlidXRlcyA6IHt9O1xuICBhdHRyaWJ1dGVGaWx0ZXJcbiAgICAuZmlsdGVyKChhdHRyKSA9PiAhIWFsbG93ZWRHbG9iYWxBdHRyaWJ1dGVzLmluY2x1ZGVzKGF0dHIpICYmICEhZWwuaGFzQXR0cmlidXRlKGF0dHIpKVxuICAgIC5mb3JFYWNoKChhdHRyKSA9PiB7XG4gICAgY29uc3QgdmFsdWUgPSBlbC5nZXRBdHRyaWJ1dGUoYXR0cik7XG4gICAgaWYgKHZhbHVlICE9PSBudWxsKSB7XG4gICAgICB1cGRhdGVkQXR0cmlidXRlc1thdHRyXSA9IHZhbHVlO1xuICAgIH1cbiAgfSk7XG4gIGNvbXBvbmVudC5nbG9iYWxBdHRyaWJ1dGVzID0gdXBkYXRlZEF0dHJpYnV0ZXM7XG59XG5mdW5jdGlvbiBwcm9jZXNzTXV0YXRpb25zKG11dGF0aW9ucykge1xuICBtdXRhdGlvbnMuZm9yRWFjaCgoeyB0YXJnZXQgfSkgPT4ge1xuICAgIGNvbnN0IFtjb21wb25lbnQsIG9wdGlvbnNdID0gZWxlbWVudFRvQ29tcG9uZW50QW5kT2JzZXJ2ZXJPcHRpb25zTWFwLmdldCh0YXJnZXQpO1xuICAgIHVwZGF0ZUdsb2JhbEF0dHJpYnV0ZXMoY29tcG9uZW50LCBvcHRpb25zLmF0dHJpYnV0ZUZpbHRlcik7XG4gIH0pO1xufVxuLyoqXG4gKiBIZWxwZXIgdG8gc2V0IHVwIGxpc3RlbmluZyBmb3IgY2hhbmdlcyB0byBnbG9iYWwgYXR0cmlidXRlcy5cbiAqXG4gKiByZW5kZXIoKTogVk5vZGUge1xuICogcmV0dXJuICg8SG9zdD5cbiAqIDx1bCB7Li4udGhpcy5nbG9iYWxBdHRyaWJ1dGVzfT48L2Rpdj5cbiAqIDwvSG9zdD4pO1xuICogfVxuICpcbiAqIEBwYXJhbSBjb21wb25lbnRcbiAqIEBwYXJhbSBhdHRyaWJ1dGVGaWx0ZXJcbiAqL1xuZnVuY3Rpb24gd2F0Y2hHbG9iYWxBdHRyaWJ1dGVzKGNvbXBvbmVudCwgYXR0cmlidXRlRmlsdGVyKSB7XG4gIGNvbnN0IHsgZWwgfSA9IGNvbXBvbmVudDtcbiAgY29uc3Qgb2JzZXJ2ZXJPcHRpb25zID0geyBhdHRyaWJ1dGVGaWx0ZXIgfTtcbiAgZWxlbWVudFRvQ29tcG9uZW50QW5kT2JzZXJ2ZXJPcHRpb25zTWFwLnNldChlbCwgW2NvbXBvbmVudCwgb2JzZXJ2ZXJPcHRpb25zXSk7XG4gIHVwZGF0ZUdsb2JhbEF0dHJpYnV0ZXMoY29tcG9uZW50LCBhdHRyaWJ1dGVGaWx0ZXIsIHRydWUpO1xuICBpZiAoIW11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgICBtdXRhdGlvbk9ic2VydmVyID0gY3JlYXRlT2JzZXJ2ZXIoXCJtdXRhdGlvblwiLCBwcm9jZXNzTXV0YXRpb25zKTtcbiAgfVxuICBtdXRhdGlvbk9ic2VydmVyLm9ic2VydmUoZWwsIG9ic2VydmVyT3B0aW9ucyk7XG59XG4vKipcbiAqIEhlbHBlciByZW1vdmUgbGlzdGVuaW5nIGZvciBjaGFuZ2VzIHRvIGluaGVyaXRlZCBhdHRyaWJ1dGVzLlxuICpcbiAqIEBwYXJhbSBjb21wb25lbnRcbiAqL1xuZnVuY3Rpb24gdW53YXRjaEdsb2JhbEF0dHJpYnV0ZXMoY29tcG9uZW50KSB7XG4gIGVsZW1lbnRUb0NvbXBvbmVudEFuZE9ic2VydmVyT3B0aW9uc01hcC5kZWxldGUoY29tcG9uZW50LmVsKTtcbiAgLy8gd2UgZXhwbGljaXRseSBwcm9jZXNzIHF1ZXVlZCBtdXRhdGlvbnMgYW5kIGRpc2Nvbm5lY3QgYW5kIHJlY29ubmVjdFxuICAvLyB0aGUgb2JzZXJ2ZXIgdW50aWwgTXV0YXRpb25PYnNlcnZlciBnZXRzIGFuIGB1bm9ic2VydmVgIG1ldGhvZFxuICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3doYXR3Zy9kb20vaXNzdWVzLzEyNlxuICBwcm9jZXNzTXV0YXRpb25zKG11dGF0aW9uT2JzZXJ2ZXIudGFrZVJlY29yZHMoKSk7XG4gIG11dGF0aW9uT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICBmb3IgKGNvbnN0IFtlbGVtZW50LCBbLCBvYnNlcnZlck9wdGlvbnNdXSBvZiBlbGVtZW50VG9Db21wb25lbnRBbmRPYnNlcnZlck9wdGlvbnNNYXAuZW50cmllcygpKSB7XG4gICAgbXV0YXRpb25PYnNlcnZlci5vYnNlcnZlKGVsZW1lbnQsIG9ic2VydmVyT3B0aW9ucyk7XG4gIH1cbn1cblxuY29uc3QgbWVudUNzcyA9IFwiOmhvc3R7ZGlzcGxheTpmbGV4fXVse21hcmdpbjowcHg7ZGlzcGxheTppbmxpbmUtZmxleDtibG9jay1zaXplOjEwMCU7YWxpZ24taXRlbXM6Y2VudGVyO3BhZGRpbmc6MHB4fTpob3N0KFtsYXlvdXQ9dmVydGljYWxdKSB1bHtkaXNwbGF5OmZsZXg7aW5saW5lLXNpemU6MTAwJTtmbGV4LWRpcmVjdGlvbjpjb2x1bW59Omhvc3QoW2hpZGRlbl0pe2Rpc3BsYXk6bm9uZX1baGlkZGVuXXtkaXNwbGF5Om5vbmV9XCI7XG5cbmNvbnN0IENhbGNpdGVNZW51ID0gLypAX19QVVJFX18qLyBwcm94eUN1c3RvbUVsZW1lbnQoY2xhc3MgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5fX3JlZ2lzdGVySG9zdCgpO1xuICAgIHRoaXMuX19hdHRhY2hTaGFkb3coKTtcbiAgICB0aGlzLm1lbnVJdGVtcyA9IFtdO1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvL1xuICAgIC8vICBQcml2YXRlIE1ldGhvZHNcbiAgICAvL1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICB0aGlzLmhhbmRsZU1lbnVTbG90Q2hhbmdlID0gKGV2ZW50KSA9PiB7XG4gICAgICB0aGlzLm1lbnVJdGVtcyA9IHNsb3RDaGFuZ2VHZXRBc3NpZ25lZEVsZW1lbnRzKGV2ZW50KTtcbiAgICAgIHRoaXMuc2V0TWVudUl0ZW1MYXlvdXQodGhpcy5tZW51SXRlbXMsIHRoaXMubGF5b3V0KTtcbiAgICB9O1xuICAgIHRoaXMubGFiZWwgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5sYXlvdXQgPSBcImhvcml6b250YWxcIjtcbiAgICB0aGlzLm1lc3NhZ2VPdmVycmlkZXMgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5tZXNzYWdlcyA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmRlZmF1bHRNZXNzYWdlcyA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmVmZmVjdGl2ZUxvY2FsZSA9IFwiXCI7XG4gICAgdGhpcy5nbG9iYWxBdHRyaWJ1dGVzID0ge1xuICAgICAgcm9sZTogXCJtZW51YmFyXCIsXG4gICAgfTtcbiAgfVxuICBoYW5kbGVMYXlvdXRDaGFuZ2UodmFsdWUpIHtcbiAgICB0aGlzLnNldE1lbnVJdGVtTGF5b3V0KHRoaXMubWVudUl0ZW1zLCB2YWx1ZSk7XG4gIH1cbiAgb25NZXNzYWdlc0NoYW5nZSgpIHtcbiAgICAvKiB3aXJlZCB1cCBieSB0OW4gdXRpbCAqL1xuICB9XG4gIGVmZmVjdGl2ZUxvY2FsZUNoYW5nZSgpIHtcbiAgICB1cGRhdGVNZXNzYWdlcyh0aGlzLCB0aGlzLmVmZmVjdGl2ZUxvY2FsZSk7XG4gIH1cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgTGlmZWN5Y2xlXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgY29ubmVjdExvY2FsaXplZCh0aGlzKTtcbiAgICBjb25uZWN0TWVzc2FnZXModGhpcyk7XG4gICAgd2F0Y2hHbG9iYWxBdHRyaWJ1dGVzKHRoaXMsIFtcInJvbGVcIl0pO1xuICB9XG4gIGFzeW5jIGNvbXBvbmVudFdpbGxMb2FkKCkge1xuICAgIHNldFVwTG9hZGFibGVDb21wb25lbnQodGhpcyk7XG4gICAgYXdhaXQgc2V0VXBNZXNzYWdlcyh0aGlzKTtcbiAgfVxuICBjb21wb25lbnREaWRMb2FkKCkge1xuICAgIHNldENvbXBvbmVudExvYWRlZCh0aGlzKTtcbiAgfVxuICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICBkaXNjb25uZWN0TG9jYWxpemVkKHRoaXMpO1xuICAgIGRpc2Nvbm5lY3RNZXNzYWdlcyh0aGlzKTtcbiAgICB1bndhdGNoR2xvYmFsQXR0cmlidXRlcyh0aGlzKTtcbiAgfVxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBQdWJsaWMgTWV0aG9kc1xuICAvL1xuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8qKiBTZXRzIGZvY3VzIG9uIHRoZSBjb21wb25lbnQncyBmaXJzdCBmb2N1c2FibGUgZWxlbWVudC4gKi9cbiAgYXN5bmMgc2V0Rm9jdXMoKSB7XG4gICAgYXdhaXQgY29tcG9uZW50Rm9jdXNhYmxlKHRoaXMpO1xuICAgIHRoaXMuZWwuZm9jdXMoKTtcbiAgfVxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBFdmVudCBMaXN0ZW5lcnNcbiAgLy9cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBjYWxjaXRlSW50ZXJuYWxOYXZNZW51SXRlbUtleUV2ZW50KGV2ZW50KSB7XG4gICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuICAgIGNvbnN0IHN1Ym1lbnVJdGVtcyA9IGV2ZW50LmRldGFpbC5jaGlsZHJlbjtcbiAgICBjb25zdCBrZXkgPSBldmVudC5kZXRhaWwuZXZlbnQua2V5O1xuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIGlmIChrZXkgPT09IFwiQXJyb3dEb3duXCIpIHtcbiAgICAgIGlmICh0YXJnZXQubGF5b3V0ID09PSBcInZlcnRpY2FsXCIpIHtcbiAgICAgICAgZm9jdXNFbGVtZW50SW5Hcm91cCh0aGlzLm1lbnVJdGVtcywgdGFyZ2V0LCBcIm5leHRcIiwgZmFsc2UpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGlmIChldmVudC5kZXRhaWwuaXNTdWJtZW51T3Blbikge1xuICAgICAgICAgIHN1Ym1lbnVJdGVtc1swXS5zZXRGb2N1cygpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGtleSA9PT0gXCJBcnJvd1VwXCIpIHtcbiAgICAgIGlmICh0aGlzLmxheW91dCA9PT0gXCJ2ZXJ0aWNhbFwiKSB7XG4gICAgICAgIGZvY3VzRWxlbWVudEluR3JvdXAodGhpcy5tZW51SXRlbXMsIHRhcmdldCwgXCJwcmV2aW91c1wiLCBmYWxzZSk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgaWYgKGV2ZW50LmRldGFpbC5pc1N1Ym1lbnVPcGVuKSB7XG4gICAgICAgICAgc3VibWVudUl0ZW1zW3N1Ym1lbnVJdGVtcy5sZW5ndGggLSAxXS5zZXRGb2N1cygpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGtleSA9PT0gXCJBcnJvd1JpZ2h0XCIpIHtcbiAgICAgIGlmICh0aGlzLmxheW91dCA9PT0gXCJob3Jpem9udGFsXCIpIHtcbiAgICAgICAgZm9jdXNFbGVtZW50SW5Hcm91cCh0aGlzLm1lbnVJdGVtcywgdGFyZ2V0LCBcIm5leHRcIiwgZmFsc2UpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGlmIChldmVudC5kZXRhaWwuaXNTdWJtZW51T3Blbikge1xuICAgICAgICAgIHN1Ym1lbnVJdGVtc1swXS5zZXRGb2N1cygpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGtleSA9PT0gXCJBcnJvd0xlZnRcIikge1xuICAgICAgaWYgKHRoaXMubGF5b3V0ID09PSBcImhvcml6b250YWxcIikge1xuICAgICAgICBmb2N1c0VsZW1lbnRJbkdyb3VwKHRoaXMubWVudUl0ZW1zLCB0YXJnZXQsIFwicHJldmlvdXNcIiwgZmFsc2UpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGlmIChldmVudC5kZXRhaWwuaXNTdWJtZW51T3Blbikge1xuICAgICAgICAgIHRoaXMuZm9jdXNQYXJlbnRFbGVtZW50KGV2ZW50LnRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoa2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmZvY3VzUGFyZW50RWxlbWVudChldmVudC50YXJnZXQpO1xuICAgIH1cbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICB9XG4gIGZvY3VzUGFyZW50RWxlbWVudChlbCkge1xuICAgIGNvbnN0IHBhcmVudEVsID0gZWwucGFyZW50RWxlbWVudDtcbiAgICBpZiAocGFyZW50RWwpIHtcbiAgICAgIGZvY3VzRWxlbWVudChwYXJlbnRFbCk7XG4gICAgICBwYXJlbnRFbC5vcGVuID0gZmFsc2U7XG4gICAgfVxuICB9XG4gIHNldE1lbnVJdGVtTGF5b3V0KGl0ZW1zLCBsYXlvdXQpIHtcbiAgICBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBpdGVtLmxheW91dCA9IGxheW91dDtcbiAgICAgIGlmICh0aGlzLmdsb2JhbEF0dHJpYnV0ZXMucm9sZSA9PT0gXCJtZW51YmFyXCIpIHtcbiAgICAgICAgaXRlbS5pc1RvcExldmVsSXRlbSA9IHRydWU7XG4gICAgICAgIGl0ZW0udG9wTGV2ZWxNZW51TGF5b3V0ID0gdGhpcy5sYXlvdXQ7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gIFJlbmRlciBNZXRob2RzXG4gIC8vXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gKGgoSG9zdCwgbnVsbCwgaChcInVsXCIsIHsgXCJhcmlhLWxhYmVsXCI6IHRoaXMubGFiZWwsIC4uLnRoaXMuZ2xvYmFsQXR0cmlidXRlcyB9LCBoKFwic2xvdFwiLCB7IG9uU2xvdGNoYW5nZTogdGhpcy5oYW5kbGVNZW51U2xvdENoYW5nZSB9KSkpKTtcbiAgfVxuICBzdGF0aWMgZ2V0IGRlbGVnYXRlc0ZvY3VzKCkgeyByZXR1cm4gdHJ1ZTsgfVxuICBzdGF0aWMgZ2V0IGFzc2V0c0RpcnMoKSB7IHJldHVybiBbXCJhc3NldHNcIl07IH1cbiAgZ2V0IGVsKCkgeyByZXR1cm4gdGhpczsgfVxuICBzdGF0aWMgZ2V0IHdhdGNoZXJzKCkgeyByZXR1cm4ge1xuICAgIFwibGF5b3V0XCI6IFtcImhhbmRsZUxheW91dENoYW5nZVwiXSxcbiAgICBcIm1lc3NhZ2VPdmVycmlkZXNcIjogW1wib25NZXNzYWdlc0NoYW5nZVwiXSxcbiAgICBcImVmZmVjdGl2ZUxvY2FsZVwiOiBbXCJlZmZlY3RpdmVMb2NhbGVDaGFuZ2VcIl1cbiAgfTsgfVxuICBzdGF0aWMgZ2V0IHN0eWxlKCkgeyByZXR1cm4gbWVudUNzczsgfVxufSwgWzE3LCBcImNhbGNpdGUtbWVudVwiLCB7XG4gICAgXCJsYWJlbFwiOiBbMV0sXG4gICAgXCJsYXlvdXRcIjogWzUxM10sXG4gICAgXCJtZXNzYWdlT3ZlcnJpZGVzXCI6IFsxMDQwXSxcbiAgICBcIm1lc3NhZ2VzXCI6IFsxMDQwXSxcbiAgICBcImRlZmF1bHRNZXNzYWdlc1wiOiBbMzJdLFxuICAgIFwiZWZmZWN0aXZlTG9jYWxlXCI6IFszMl0sXG4gICAgXCJnbG9iYWxBdHRyaWJ1dGVzXCI6IFszMl0sXG4gICAgXCJzZXRGb2N1c1wiOiBbNjRdXG4gIH0sIFtbMCwgXCJjYWxjaXRlSW50ZXJuYWxNZW51SXRlbUtleUV2ZW50XCIsIFwiY2FsY2l0ZUludGVybmFsTmF2TWVudUl0ZW1LZXlFdmVudFwiXV1dKTtcbmZ1bmN0aW9uIGRlZmluZUN1c3RvbUVsZW1lbnQoKSB7XG4gIGlmICh0eXBlb2YgY3VzdG9tRWxlbWVudHMgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgY29tcG9uZW50cyA9IFtcImNhbGNpdGUtbWVudVwiXTtcbiAgY29tcG9uZW50cy5mb3JFYWNoKHRhZ05hbWUgPT4geyBzd2l0Y2ggKHRhZ05hbWUpIHtcbiAgICBjYXNlIFwiY2FsY2l0ZS1tZW51XCI6XG4gICAgICBpZiAoIWN1c3RvbUVsZW1lbnRzLmdldCh0YWdOYW1lKSkge1xuICAgICAgICBjdXN0b21FbGVtZW50cy5kZWZpbmUodGFnTmFtZSwgQ2FsY2l0ZU1lbnUpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gIH0gfSk7XG59XG5kZWZpbmVDdXN0b21FbGVtZW50KCk7XG5cbmV4cG9ydCB7IENhbGNpdGVNZW51IGFzIEMsIGRlZmluZUN1c3RvbUVsZW1lbnQgYXMgZCB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9
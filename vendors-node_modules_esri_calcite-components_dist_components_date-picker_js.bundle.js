"use strict";
(self["webpackChunksynview"] = self["webpackChunksynview"] || []).push([["vendors-node_modules_esri_calcite-components_dist_components_date-picker_js"],{

/***/ "./node_modules/@esri/calcite-components/dist/components/date-picker.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/components/date-picker.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   D: () => (/* binding */ DatePicker),
/* harmony export */   a: () => (/* binding */ getLocaleData),
/* harmony export */   d: () => (/* binding */ defineCustomElement),
/* harmony export */   g: () => (/* binding */ getValueAsDateRange)
/* harmony export */ });
/* harmony import */ var _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @stencil/core/internal/client/index.js */ "./node_modules/@stencil/core/internal/client/index.js");
/* harmony import */ var _date_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./date.js */ "./node_modules/@esri/calcite-components/dist/components/date.js");
/* harmony import */ var _loadable_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./loadable.js */ "./node_modules/@esri/calcite-components/dist/components/loadable.js");
/* harmony import */ var _locale_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./locale.js */ "./node_modules/@esri/calcite-components/dist/components/locale.js");
/* harmony import */ var _t9n_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./t9n.js */ "./node_modules/@esri/calcite-components/dist/components/t9n.js");
/* harmony import */ var _date_picker_day_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./date-picker-day.js */ "./node_modules/@esri/calcite-components/dist/components/date-picker-day.js");
/* harmony import */ var _date_picker_month_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./date-picker-month.js */ "./node_modules/@esri/calcite-components/dist/components/date-picker-month.js");
/* harmony import */ var _date_picker_month_header_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./date-picker-month-header.js */ "./node_modules/@esri/calcite-components/dist/components/date-picker-month-header.js");
/* harmony import */ var _icon_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./icon.js */ "./node_modules/@esri/calcite-components/dist/components/icon.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v1.7.0
 */










const HEADING_LEVEL = 2;
const DATE_PICKER_FORMAT_OPTIONS = { dateStyle: "full" };

/**
 * CLDR cache.
 * Exported for testing purposes.
 *
 * @private
 */
const translationCache = {};
/**
 * CLDR request cache.
 * Exported for testing purposes.
 *
 * @private
 */
const requestCache = {};
/**
 * Fetch calendar data for a given locale from list of supported languages
 *
 * @param lang
 * @public
 */
async function getLocaleData(lang) {
  const locale = (0,_locale_js__WEBPACK_IMPORTED_MODULE_2__.g)(lang);
  if (translationCache[locale]) {
    return translationCache[locale];
  }
  if (!requestCache[locale]) {
    requestCache[locale] = fetch((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.getAssetPath)(`./assets/date-picker/nls/${locale}.json`))
      .then((resp) => resp.json())
      .catch(() => {
      console.error(`Translations for "${locale}" not found or invalid, falling back to english`);
      return getLocaleData("en");
    });
  }
  const data = await requestCache[locale];
  translationCache[locale] = data;
  return data;
}
/**
 *  Maps value to valueAsDate
 *
 * @param value
 */
function getValueAsDateRange(value) {
  return value.map((v, index) => (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.e)(v, index === 1));
}

const datePickerCss = ":host{position:relative;display:inline-block;inline-size:100%;overflow:visible;border-radius:0px;border-width:1px;border-style:solid;border-color:var(--calcite-ui-border-1);background-color:var(--calcite-ui-foreground-1);vertical-align:top}:host([scale=s]){max-inline-size:216px}:host([scale=m]){max-inline-size:286px}:host([scale=l]){max-inline-size:398px}:host([hidden]){display:none}[hidden]{display:none}";

const DatePicker = /*@__PURE__*/ (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.proxyCustomElement)(class extends _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.HTMLElement {
  constructor() {
    super();
    this.__registerHost();
    this.__attachShadow();
    this.calciteDatePickerChange = (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.createEvent)(this, "calciteDatePickerChange", 6);
    this.calciteDatePickerRangeChange = (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.createEvent)(this, "calciteDatePickerRangeChange", 6);
    //--------------------------------------------------------------------------
    //
    //  Private Methods
    //
    //--------------------------------------------------------------------------
    this.keyDownHandler = (event) => {
      if (event.key === "Escape") {
        this.resetActiveDates();
      }
    };
    this.monthHeaderSelectChange = (event) => {
      const date = new Date(event.detail);
      if (!this.range) {
        this.activeDate = date;
      }
      else {
        if (this.activeRange === "end") {
          this.activeEndDate = date;
        }
        else {
          this.activeStartDate = date;
        }
        this.mostRecentRangeValue = date;
      }
    };
    this.monthActiveDateChange = (event) => {
      const date = new Date(event.detail);
      if (!this.range) {
        this.activeDate = date;
      }
      else {
        if (this.activeRange === "end") {
          this.activeEndDate = date;
        }
        else {
          this.activeStartDate = date;
        }
        this.mostRecentRangeValue = date;
      }
    };
    this.monthHoverChange = (event) => {
      if (!this.range) {
        this.hoverRange = undefined;
        return;
      }
      const { valueAsDate } = this;
      const start = Array.isArray(valueAsDate) && valueAsDate[0];
      const end = Array.isArray(valueAsDate) && valueAsDate[1];
      const date = new Date(event.detail);
      this.hoverRange = {
        focused: this.activeRange || "start",
        start,
        end,
      };
      if (!this.proximitySelectionDisabled) {
        if (end) {
          const startDiff = (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.g)(date, start);
          const endDiff = (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.g)(date, end);
          if (endDiff > 0) {
            this.hoverRange.end = date;
            this.hoverRange.focused = "end";
          }
          else if (startDiff < 0) {
            this.hoverRange.start = date;
            this.hoverRange.focused = "start";
          }
          else if (startDiff > endDiff) {
            this.hoverRange.start = date;
            this.hoverRange.focused = "start";
          }
          else {
            this.hoverRange.end = date;
            this.hoverRange.focused = "end";
          }
        }
        else {
          if (start) {
            if (date < start) {
              this.hoverRange = {
                focused: "start",
                start: date,
                end: start,
              };
            }
            else {
              this.hoverRange.end = date;
              this.hoverRange.focused = "end";
            }
          }
        }
      }
      else {
        if (!end) {
          if (date < start) {
            this.hoverRange = {
              focused: "start",
              start: date,
              end: start,
            };
          }
          else {
            this.hoverRange.end = date;
            this.hoverRange.focused = "end";
          }
        }
        else {
          this.hoverRange = undefined;
        }
      }
      event.stopPropagation();
    };
    this.monthMouseOutChange = () => {
      if (this.hoverRange) {
        this.hoverRange = undefined;
      }
    };
    this.resetActiveDates = () => {
      const { valueAsDate } = this;
      if (!Array.isArray(valueAsDate) && valueAsDate && valueAsDate !== this.activeDate) {
        this.activeDate = new Date(valueAsDate);
      }
      if (Array.isArray(valueAsDate)) {
        if (valueAsDate[0] && valueAsDate[0] !== this.activeStartDate) {
          this.activeStartDate = new Date(valueAsDate[0]);
        }
        if (valueAsDate[1] && valueAsDate[1] !== this.activeEndDate) {
          this.activeEndDate = new Date(valueAsDate[1]);
        }
      }
    };
    /**
     * Event handler for when the selected date changes
     *
     * @param event
     */
    this.monthDateChange = (event) => {
      const date = new Date(event.detail);
      const isoDate = (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.c)(date);
      if (!this.range && isoDate === (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.c)(this.valueAsDate)) {
        return;
      }
      if (!this.range) {
        this.value = isoDate || "";
        this.valueAsDate = date || null;
        this.activeDate = date || null;
        this.calciteDatePickerChange.emit();
        return;
      }
      const start = this.getStartDate();
      const end = this.getEndDate();
      if (!start || (!end && date < start)) {
        if (start) {
          this.setEndDate(new Date(start));
        }
        if (this.activeRange == "end") {
          this.setEndDate(date);
        }
        else {
          this.setStartDate(date);
        }
      }
      else if (!end) {
        this.setEndDate(date);
      }
      else {
        if (!this.proximitySelectionDisabled) {
          if (this.activeRange) {
            if (this.activeRange == "end") {
              this.setEndDate(date);
            }
            else {
              this.setStartDate(date);
            }
          }
          else {
            const startDiff = (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.g)(date, start);
            const endDiff = (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.g)(date, end);
            if (endDiff === 0 || startDiff < 0) {
              this.setStartDate(date);
            }
            else if (startDiff === 0 || endDiff < 0) {
              this.setEndDate(date);
            }
            else if (startDiff < endDiff) {
              this.setStartDate(date);
            }
            else {
              this.setEndDate(date);
            }
          }
        }
        else {
          this.setStartDate(date);
        }
      }
      this.calciteDatePickerChange.emit();
    };
    this.activeDate = undefined;
    this.activeRange = undefined;
    this.value = undefined;
    this.headingLevel = undefined;
    this.valueAsDate = undefined;
    this.minAsDate = undefined;
    this.maxAsDate = undefined;
    this.min = undefined;
    this.max = undefined;
    this.numberingSystem = undefined;
    this.scale = "m";
    this.range = false;
    this.proximitySelectionDisabled = false;
    this.messageOverrides = undefined;
    this.messages = undefined;
    this.activeEndDate = undefined;
    this.activeStartDate = undefined;
    this.dateTimeFormat = undefined;
    this.defaultMessages = undefined;
    this.effectiveLocale = "";
    this.endAsDate = undefined;
    this.hoverRange = undefined;
    this.localeData = undefined;
    this.mostRecentRangeValue = undefined;
    this.startAsDate = undefined;
  }
  activeDateWatcher(newActiveDate) {
    if (this.activeRange === "end") {
      this.activeEndDate = newActiveDate;
    }
  }
  valueAsDateWatcher(newValueAsDate) {
    if (this.range && Array.isArray(newValueAsDate)) {
      const { activeStartDate, activeEndDate } = this;
      const newActiveStartDate = newValueAsDate[0];
      const newActiveEndDate = newValueAsDate[1];
      this.activeStartDate = activeStartDate !== newActiveStartDate && newActiveStartDate;
      this.activeEndDate = activeEndDate !== newActiveEndDate && newActiveEndDate;
    }
    else if (newValueAsDate && newValueAsDate !== this.activeDate) {
      this.activeDate = newValueAsDate;
    }
  }
  onMinChanged(min) {
    if (min) {
      this.minAsDate = (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.e)(min);
    }
  }
  onMaxChanged(max) {
    if (max) {
      this.maxAsDate = (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.e)(max);
    }
  }
  onMessagesChange() {
    /* wired up by t9n util */
  }
  //--------------------------------------------------------------------------
  //
  //  Public Methods
  //
  //--------------------------------------------------------------------------
  /** Sets focus on the component's first focusable element. */
  async setFocus() {
    await (0,_loadable_js__WEBPACK_IMPORTED_MODULE_1__.c)(this);
    this.el.focus();
  }
  /**
   * Resets active date state.
   * @internal
   */
  async reset() {
    this.resetActiveDates();
    this.mostRecentRangeValue = undefined;
  }
  // --------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  // --------------------------------------------------------------------------
  connectedCallback() {
    (0,_locale_js__WEBPACK_IMPORTED_MODULE_2__.c)(this);
    (0,_t9n_js__WEBPACK_IMPORTED_MODULE_3__.c)(this);
    if (Array.isArray(this.value)) {
      this.valueAsDate = getValueAsDateRange(this.value);
    }
    else if (this.value) {
      this.valueAsDate = (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.e)(this.value);
    }
    if (this.min) {
      this.minAsDate = (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.e)(this.min);
    }
    if (this.max) {
      this.maxAsDate = (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.e)(this.max);
    }
  }
  disconnectedCallback() {
    (0,_locale_js__WEBPACK_IMPORTED_MODULE_2__.d)(this);
    (0,_t9n_js__WEBPACK_IMPORTED_MODULE_3__.d)(this);
  }
  async componentWillLoad() {
    (0,_loadable_js__WEBPACK_IMPORTED_MODULE_1__.a)(this);
    await this.loadLocaleData();
    this.onMinChanged(this.min);
    this.onMaxChanged(this.max);
    await (0,_t9n_js__WEBPACK_IMPORTED_MODULE_3__.s)(this);
  }
  componentDidLoad() {
    (0,_loadable_js__WEBPACK_IMPORTED_MODULE_1__.s)(this);
  }
  render() {
    const date = (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.f)(this.range && Array.isArray(this.valueAsDate) ? this.valueAsDate[0] : this.valueAsDate, this.minAsDate, this.maxAsDate);
    let activeDate = this.getActiveDate(date, this.minAsDate, this.maxAsDate);
    const endDate = this.range && Array.isArray(this.valueAsDate)
      ? (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.f)(this.valueAsDate[1], this.minAsDate, this.maxAsDate)
      : null;
    const activeEndDate = this.getActiveEndDate(endDate, this.minAsDate, this.maxAsDate);
    if ((this.activeRange === "end" ||
      (this.hoverRange?.focused === "end" && (!this.proximitySelectionDisabled || endDate))) &&
      activeEndDate) {
      activeDate = activeEndDate;
    }
    if (this.range && this.mostRecentRangeValue) {
      activeDate = this.mostRecentRangeValue;
    }
    const minDate = this.range && this.activeRange
      ? this.activeRange === "start"
        ? this.minAsDate
        : date || this.minAsDate
      : this.minAsDate;
    const maxDate = this.range && this.activeRange
      ? this.activeRange === "start"
        ? endDate || this.maxAsDate
        : this.maxAsDate
      : this.maxAsDate;
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.h)(_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.Host, { onBlur: this.resetActiveDates, onKeyDown: this.keyDownHandler }, this.renderCalendar(activeDate, maxDate, minDate, date, endDate)));
  }
  effectiveLocaleChange() {
    (0,_t9n_js__WEBPACK_IMPORTED_MODULE_3__.u)(this, this.effectiveLocale);
  }
  valueHandler(value) {
    if (Array.isArray(value)) {
      this.valueAsDate = getValueAsDateRange(value);
    }
    else if (value) {
      this.valueAsDate = (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.e)(value);
    }
  }
  async loadLocaleData() {
    if (!_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.Build.isBrowser) {
      return;
    }
    _locale_js__WEBPACK_IMPORTED_MODULE_2__.n.numberFormatOptions = {
      numberingSystem: this.numberingSystem,
      locale: this.effectiveLocale,
      useGrouping: false,
    };
    this.localeData = await getLocaleData(this.effectiveLocale);
    this.dateTimeFormat = (0,_locale_js__WEBPACK_IMPORTED_MODULE_2__.a)(this.effectiveLocale, DATE_PICKER_FORMAT_OPTIONS);
  }
  /**
   * Render calcite-date-picker-month-header and calcite-date-picker-month
   *
   * @param activeDate
   * @param maxDate
   * @param minDate
   * @param date
   * @param endDate
   */
  renderCalendar(activeDate, maxDate, minDate, date, endDate) {
    return (this.localeData && [
      (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.h)("calcite-date-picker-month-header", { activeDate: activeDate, headingLevel: this.headingLevel || HEADING_LEVEL, localeData: this.localeData, max: maxDate, messages: this.messages, min: minDate, onCalciteInternalDatePickerSelect: this.monthHeaderSelectChange, scale: this.scale, selectedDate: this.activeRange === "end" ? endDate : date || new Date() }),
      (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_8__.h)("calcite-date-picker-month", { activeDate: activeDate, dateTimeFormat: this.dateTimeFormat, endDate: this.range ? endDate : undefined, hoverRange: this.hoverRange, localeData: this.localeData, max: maxDate, min: minDate, onCalciteInternalDatePickerActiveDateChange: this.monthActiveDateChange, onCalciteInternalDatePickerHover: this.monthHoverChange, onCalciteInternalDatePickerMouseOut: this.monthMouseOutChange, onCalciteInternalDatePickerSelect: this.monthDateChange, scale: this.scale, selectedDate: this.activeRange === "end" ? endDate : date, startDate: this.range ? date : undefined }),
    ]);
  }
  getEndDate() {
    return (Array.isArray(this.valueAsDate) && this.valueAsDate[1]) || undefined;
  }
  setEndDate(date) {
    const startDate = this.getStartDate();
    const newEndDate = date ? (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.s)(date) : date;
    this.value = [(0,_date_js__WEBPACK_IMPORTED_MODULE_0__.c)(startDate), (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.c)(date)];
    this.valueAsDate = [startDate, date];
    this.mostRecentRangeValue = newEndDate;
    this.calciteDatePickerRangeChange.emit();
    this.activeEndDate = date || null;
  }
  getStartDate() {
    return Array.isArray(this.valueAsDate) && this.valueAsDate[0];
  }
  setStartDate(date) {
    const endDate = this.getEndDate();
    this.value = [(0,_date_js__WEBPACK_IMPORTED_MODULE_0__.c)(date), (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.c)(endDate)];
    this.valueAsDate = [date, endDate];
    this.mostRecentRangeValue = date;
    this.calciteDatePickerRangeChange.emit();
    this.activeStartDate = date || null;
  }
  /**
   * Get an active date using the value, or current date as default
   *
   * @param value
   * @param min
   * @param max
   */
  getActiveDate(value, min, max) {
    return (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.f)(this.activeDate, min, max) || value || (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.f)(new Date(), min, max);
  }
  getActiveEndDate(value, min, max) {
    return ((0,_date_js__WEBPACK_IMPORTED_MODULE_0__.f)(this.activeEndDate, min, max) || value || (0,_date_js__WEBPACK_IMPORTED_MODULE_0__.f)(new Date(), min, max));
  }
  static get delegatesFocus() { return true; }
  static get assetsDirs() { return ["assets"]; }
  get el() { return this; }
  static get watchers() { return {
    "activeDate": ["activeDateWatcher"],
    "valueAsDate": ["valueAsDateWatcher"],
    "min": ["onMinChanged"],
    "max": ["onMaxChanged"],
    "messageOverrides": ["onMessagesChange"],
    "effectiveLocale": ["effectiveLocaleChange", "loadLocaleData"],
    "value": ["valueHandler"]
  }; }
  static get style() { return datePickerCss; }
}, [17, "calcite-date-picker", {
    "activeDate": [1040],
    "activeRange": [513, "active-range"],
    "value": [1025],
    "headingLevel": [514, "heading-level"],
    "valueAsDate": [1040],
    "minAsDate": [1040],
    "maxAsDate": [1040],
    "min": [513],
    "max": [513],
    "numberingSystem": [513, "numbering-system"],
    "scale": [513],
    "range": [516],
    "proximitySelectionDisabled": [516, "proximity-selection-disabled"],
    "messageOverrides": [1040],
    "messages": [1040],
    "activeEndDate": [32],
    "activeStartDate": [32],
    "dateTimeFormat": [32],
    "defaultMessages": [32],
    "effectiveLocale": [32],
    "endAsDate": [32],
    "hoverRange": [32],
    "localeData": [32],
    "mostRecentRangeValue": [32],
    "startAsDate": [32],
    "setFocus": [64],
    "reset": [64]
  }]);
function defineCustomElement() {
  if (typeof customElements === "undefined") {
    return;
  }
  const components = ["calcite-date-picker", "calcite-date-picker-day", "calcite-date-picker-month", "calcite-date-picker-month-header", "calcite-icon"];
  components.forEach(tagName => { switch (tagName) {
    case "calcite-date-picker":
      if (!customElements.get(tagName)) {
        customElements.define(tagName, DatePicker);
      }
      break;
    case "calcite-date-picker-day":
      if (!customElements.get(tagName)) {
        (0,_date_picker_day_js__WEBPACK_IMPORTED_MODULE_4__.d)();
      }
      break;
    case "calcite-date-picker-month":
      if (!customElements.get(tagName)) {
        (0,_date_picker_month_js__WEBPACK_IMPORTED_MODULE_5__.d)();
      }
      break;
    case "calcite-date-picker-month-header":
      if (!customElements.get(tagName)) {
        (0,_date_picker_month_header_js__WEBPACK_IMPORTED_MODULE_6__.d)();
      }
      break;
    case "calcite-icon":
      if (!customElements.get(tagName)) {
        (0,_icon_js__WEBPACK_IMPORTED_MODULE_7__.d)();
      }
      break;
  } });
}
defineCustomElement();




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfZXNyaV9jYWxjaXRlLWNvbXBvbmVudHNfZGlzdF9jb21wb25lbnRzX2RhdGUtcGlja2VyX2pzLmJ1bmRsZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNvSTtBQUNmO0FBQ1A7QUFDNkM7QUFDekM7QUFDaEQ7QUFDRTtBQUNPO0FBQ3BCOztBQUV2RDtBQUNBLHFDQUFxQzs7QUFFckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLDZDQUFrQjtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxvRkFBWSw2QkFBNkIsT0FBTztBQUNqRjtBQUNBO0FBQ0EseUNBQXlDLE9BQU87QUFDaEQ7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQywyQ0FBVztBQUM1Qzs7QUFFQSw2QkFBNkIsa0JBQWtCLHFCQUFxQixpQkFBaUIsaUJBQWlCLGtCQUFrQixpQkFBaUIsbUJBQW1CLHdDQUF3QyxnREFBZ0QsbUJBQW1CLGlCQUFpQixzQkFBc0IsaUJBQWlCLHNCQUFzQixpQkFBaUIsc0JBQXNCLGdCQUFnQixhQUFhLFNBQVMsYUFBYTs7QUFFL2EsaUNBQWlDLDBGQUFrQixlQUFlLCtFQUFXO0FBQzdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLG1GQUFXO0FBQzlDLHdDQUF3QyxtRkFBVztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLGNBQWM7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsMkNBQVc7QUFDdkMsMEJBQTBCLDJDQUFXO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLGNBQWM7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsMkNBQVM7QUFDL0IscUNBQXFDLDJDQUFTO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QiwyQ0FBVztBQUN6Qyw0QkFBNEIsMkNBQVc7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsc0RBQXFCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSx3REFBcUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLCtEQUFxQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsMkNBQXFCO0FBQzdCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFbUciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zeW52aWV3Ly4vbm9kZV9tb2R1bGVzL0Blc3JpL2NhbGNpdGUtY29tcG9uZW50cy9kaXN0L2NvbXBvbmVudHMvZGF0ZS1waWNrZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtZGVzaWduLXN5c3RlbS9ibG9iL21haW4vTElDRU5TRS5tZCBmb3IgZGV0YWlscy5cbiAqIHYxLjcuMFxuICovXG5pbXBvcnQgeyBnZXRBc3NldFBhdGgsIHByb3h5Q3VzdG9tRWxlbWVudCwgSFRNTEVsZW1lbnQsIGNyZWF0ZUV2ZW50LCBoLCBIb3N0LCBCdWlsZCB9IGZyb20gJ0BzdGVuY2lsL2NvcmUvaW50ZXJuYWwvY2xpZW50L2luZGV4LmpzJztcbmltcG9ydCB7IGUgYXMgZGF0ZUZyb21JU08sIGcgYXMgZ2V0RGF5c0RpZmYsIGMgYXMgZGF0ZVRvSVNPLCBmIGFzIGRhdGVGcm9tUmFuZ2UsIHMgYXMgc2V0RW5kT2ZEYXkgfSBmcm9tICcuL2RhdGUuanMnO1xuaW1wb3J0IHsgYyBhcyBjb21wb25lbnRGb2N1c2FibGUsIGEgYXMgc2V0VXBMb2FkYWJsZUNvbXBvbmVudCwgcyBhcyBzZXRDb21wb25lbnRMb2FkZWQgfSBmcm9tICcuL2xvYWRhYmxlLmpzJztcbmltcG9ydCB7IGcgYXMgZ2V0U3VwcG9ydGVkTG9jYWxlLCBjIGFzIGNvbm5lY3RMb2NhbGl6ZWQsIGQgYXMgZGlzY29ubmVjdExvY2FsaXplZCwgbiBhcyBudW1iZXJTdHJpbmdGb3JtYXR0ZXIsIGEgYXMgZ2V0RGF0ZVRpbWVGb3JtYXQgfSBmcm9tICcuL2xvY2FsZS5qcyc7XG5pbXBvcnQgeyBjIGFzIGNvbm5lY3RNZXNzYWdlcywgZCBhcyBkaXNjb25uZWN0TWVzc2FnZXMsIHMgYXMgc2V0VXBNZXNzYWdlcywgdSBhcyB1cGRhdGVNZXNzYWdlcyB9IGZyb20gJy4vdDluLmpzJztcbmltcG9ydCB7IGQgYXMgZGVmaW5lQ3VzdG9tRWxlbWVudCQ0IH0gZnJvbSAnLi9kYXRlLXBpY2tlci1kYXkuanMnO1xuaW1wb3J0IHsgZCBhcyBkZWZpbmVDdXN0b21FbGVtZW50JDMgfSBmcm9tICcuL2RhdGUtcGlja2VyLW1vbnRoLmpzJztcbmltcG9ydCB7IGQgYXMgZGVmaW5lQ3VzdG9tRWxlbWVudCQyIH0gZnJvbSAnLi9kYXRlLXBpY2tlci1tb250aC1oZWFkZXIuanMnO1xuaW1wb3J0IHsgZCBhcyBkZWZpbmVDdXN0b21FbGVtZW50JDEgfSBmcm9tICcuL2ljb24uanMnO1xuXG5jb25zdCBIRUFESU5HX0xFVkVMID0gMjtcbmNvbnN0IERBVEVfUElDS0VSX0ZPUk1BVF9PUFRJT05TID0geyBkYXRlU3R5bGU6IFwiZnVsbFwiIH07XG5cbi8qKlxuICogQ0xEUiBjYWNoZS5cbiAqIEV4cG9ydGVkIGZvciB0ZXN0aW5nIHB1cnBvc2VzLlxuICpcbiAqIEBwcml2YXRlXG4gKi9cbmNvbnN0IHRyYW5zbGF0aW9uQ2FjaGUgPSB7fTtcbi8qKlxuICogQ0xEUiByZXF1ZXN0IGNhY2hlLlxuICogRXhwb3J0ZWQgZm9yIHRlc3RpbmcgcHVycG9zZXMuXG4gKlxuICogQHByaXZhdGVcbiAqL1xuY29uc3QgcmVxdWVzdENhY2hlID0ge307XG4vKipcbiAqIEZldGNoIGNhbGVuZGFyIGRhdGEgZm9yIGEgZ2l2ZW4gbG9jYWxlIGZyb20gbGlzdCBvZiBzdXBwb3J0ZWQgbGFuZ3VhZ2VzXG4gKlxuICogQHBhcmFtIGxhbmdcbiAqIEBwdWJsaWNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0TG9jYWxlRGF0YShsYW5nKSB7XG4gIGNvbnN0IGxvY2FsZSA9IGdldFN1cHBvcnRlZExvY2FsZShsYW5nKTtcbiAgaWYgKHRyYW5zbGF0aW9uQ2FjaGVbbG9jYWxlXSkge1xuICAgIHJldHVybiB0cmFuc2xhdGlvbkNhY2hlW2xvY2FsZV07XG4gIH1cbiAgaWYgKCFyZXF1ZXN0Q2FjaGVbbG9jYWxlXSkge1xuICAgIHJlcXVlc3RDYWNoZVtsb2NhbGVdID0gZmV0Y2goZ2V0QXNzZXRQYXRoKGAuL2Fzc2V0cy9kYXRlLXBpY2tlci9ubHMvJHtsb2NhbGV9Lmpzb25gKSlcbiAgICAgIC50aGVuKChyZXNwKSA9PiByZXNwLmpzb24oKSlcbiAgICAgIC5jYXRjaCgoKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGBUcmFuc2xhdGlvbnMgZm9yIFwiJHtsb2NhbGV9XCIgbm90IGZvdW5kIG9yIGludmFsaWQsIGZhbGxpbmcgYmFjayB0byBlbmdsaXNoYCk7XG4gICAgICByZXR1cm4gZ2V0TG9jYWxlRGF0YShcImVuXCIpO1xuICAgIH0pO1xuICB9XG4gIGNvbnN0IGRhdGEgPSBhd2FpdCByZXF1ZXN0Q2FjaGVbbG9jYWxlXTtcbiAgdHJhbnNsYXRpb25DYWNoZVtsb2NhbGVdID0gZGF0YTtcbiAgcmV0dXJuIGRhdGE7XG59XG4vKipcbiAqICBNYXBzIHZhbHVlIHRvIHZhbHVlQXNEYXRlXG4gKlxuICogQHBhcmFtIHZhbHVlXG4gKi9cbmZ1bmN0aW9uIGdldFZhbHVlQXNEYXRlUmFuZ2UodmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlLm1hcCgodiwgaW5kZXgpID0+IGRhdGVGcm9tSVNPKHYsIGluZGV4ID09PSAxKSk7XG59XG5cbmNvbnN0IGRhdGVQaWNrZXJDc3MgPSBcIjpob3N0e3Bvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6aW5saW5lLWJsb2NrO2lubGluZS1zaXplOjEwMCU7b3ZlcmZsb3c6dmlzaWJsZTtib3JkZXItcmFkaXVzOjBweDtib3JkZXItd2lkdGg6MXB4O2JvcmRlci1zdHlsZTpzb2xpZDtib3JkZXItY29sb3I6dmFyKC0tY2FsY2l0ZS11aS1ib3JkZXItMSk7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jYWxjaXRlLXVpLWZvcmVncm91bmQtMSk7dmVydGljYWwtYWxpZ246dG9wfTpob3N0KFtzY2FsZT1zXSl7bWF4LWlubGluZS1zaXplOjIxNnB4fTpob3N0KFtzY2FsZT1tXSl7bWF4LWlubGluZS1zaXplOjI4NnB4fTpob3N0KFtzY2FsZT1sXSl7bWF4LWlubGluZS1zaXplOjM5OHB4fTpob3N0KFtoaWRkZW5dKXtkaXNwbGF5Om5vbmV9W2hpZGRlbl17ZGlzcGxheTpub25lfVwiO1xuXG5jb25zdCBEYXRlUGlja2VyID0gLypAX19QVVJFX18qLyBwcm94eUN1c3RvbUVsZW1lbnQoY2xhc3MgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5fX3JlZ2lzdGVySG9zdCgpO1xuICAgIHRoaXMuX19hdHRhY2hTaGFkb3coKTtcbiAgICB0aGlzLmNhbGNpdGVEYXRlUGlja2VyQ2hhbmdlID0gY3JlYXRlRXZlbnQodGhpcywgXCJjYWxjaXRlRGF0ZVBpY2tlckNoYW5nZVwiLCA2KTtcbiAgICB0aGlzLmNhbGNpdGVEYXRlUGlja2VyUmFuZ2VDaGFuZ2UgPSBjcmVhdGVFdmVudCh0aGlzLCBcImNhbGNpdGVEYXRlUGlja2VyUmFuZ2VDaGFuZ2VcIiwgNik7XG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vXG4gICAgLy8gIFByaXZhdGUgTWV0aG9kc1xuICAgIC8vXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIHRoaXMua2V5RG93bkhhbmRsZXIgPSAoZXZlbnQpID0+IHtcbiAgICAgIGlmIChldmVudC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgICAgdGhpcy5yZXNldEFjdGl2ZURhdGVzKCk7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLm1vbnRoSGVhZGVyU2VsZWN0Q2hhbmdlID0gKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoZXZlbnQuZGV0YWlsKTtcbiAgICAgIGlmICghdGhpcy5yYW5nZSkge1xuICAgICAgICB0aGlzLmFjdGl2ZURhdGUgPSBkYXRlO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZVJhbmdlID09PSBcImVuZFwiKSB7XG4gICAgICAgICAgdGhpcy5hY3RpdmVFbmREYXRlID0gZGF0ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICB0aGlzLmFjdGl2ZVN0YXJ0RGF0ZSA9IGRhdGU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tb3N0UmVjZW50UmFuZ2VWYWx1ZSA9IGRhdGU7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLm1vbnRoQWN0aXZlRGF0ZUNoYW5nZSA9IChldmVudCkgPT4ge1xuICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGV2ZW50LmRldGFpbCk7XG4gICAgICBpZiAoIXRoaXMucmFuZ2UpIHtcbiAgICAgICAgdGhpcy5hY3RpdmVEYXRlID0gZGF0ZTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBpZiAodGhpcy5hY3RpdmVSYW5nZSA9PT0gXCJlbmRcIikge1xuICAgICAgICAgIHRoaXMuYWN0aXZlRW5kRGF0ZSA9IGRhdGU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgdGhpcy5hY3RpdmVTdGFydERhdGUgPSBkYXRlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubW9zdFJlY2VudFJhbmdlVmFsdWUgPSBkYXRlO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5tb250aEhvdmVyQ2hhbmdlID0gKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoIXRoaXMucmFuZ2UpIHtcbiAgICAgICAgdGhpcy5ob3ZlclJhbmdlID0gdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCB7IHZhbHVlQXNEYXRlIH0gPSB0aGlzO1xuICAgICAgY29uc3Qgc3RhcnQgPSBBcnJheS5pc0FycmF5KHZhbHVlQXNEYXRlKSAmJiB2YWx1ZUFzRGF0ZVswXTtcbiAgICAgIGNvbnN0IGVuZCA9IEFycmF5LmlzQXJyYXkodmFsdWVBc0RhdGUpICYmIHZhbHVlQXNEYXRlWzFdO1xuICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGV2ZW50LmRldGFpbCk7XG4gICAgICB0aGlzLmhvdmVyUmFuZ2UgPSB7XG4gICAgICAgIGZvY3VzZWQ6IHRoaXMuYWN0aXZlUmFuZ2UgfHwgXCJzdGFydFwiLFxuICAgICAgICBzdGFydCxcbiAgICAgICAgZW5kLFxuICAgICAgfTtcbiAgICAgIGlmICghdGhpcy5wcm94aW1pdHlTZWxlY3Rpb25EaXNhYmxlZCkge1xuICAgICAgICBpZiAoZW5kKSB7XG4gICAgICAgICAgY29uc3Qgc3RhcnREaWZmID0gZ2V0RGF5c0RpZmYoZGF0ZSwgc3RhcnQpO1xuICAgICAgICAgIGNvbnN0IGVuZERpZmYgPSBnZXREYXlzRGlmZihkYXRlLCBlbmQpO1xuICAgICAgICAgIGlmIChlbmREaWZmID4gMCkge1xuICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlLmVuZCA9IGRhdGU7XG4gICAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UuZm9jdXNlZCA9IFwiZW5kXCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKHN0YXJ0RGlmZiA8IDApIHtcbiAgICAgICAgICAgIHRoaXMuaG92ZXJSYW5nZS5zdGFydCA9IGRhdGU7XG4gICAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UuZm9jdXNlZCA9IFwic3RhcnRcIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZiAoc3RhcnREaWZmID4gZW5kRGlmZikge1xuICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlLnN0YXJ0ID0gZGF0ZTtcbiAgICAgICAgICAgIHRoaXMuaG92ZXJSYW5nZS5mb2N1c2VkID0gXCJzdGFydFwiO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaG92ZXJSYW5nZS5lbmQgPSBkYXRlO1xuICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlLmZvY3VzZWQgPSBcImVuZFwiO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBpZiAoc3RhcnQpIHtcbiAgICAgICAgICAgIGlmIChkYXRlIDwgc3RhcnQpIHtcbiAgICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlID0ge1xuICAgICAgICAgICAgICAgIGZvY3VzZWQ6IFwic3RhcnRcIixcbiAgICAgICAgICAgICAgICBzdGFydDogZGF0ZSxcbiAgICAgICAgICAgICAgICBlbmQ6IHN0YXJ0LFxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMuaG92ZXJSYW5nZS5lbmQgPSBkYXRlO1xuICAgICAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UuZm9jdXNlZCA9IFwiZW5kXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgaWYgKCFlbmQpIHtcbiAgICAgICAgICBpZiAoZGF0ZSA8IHN0YXJ0KSB7XG4gICAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UgPSB7XG4gICAgICAgICAgICAgIGZvY3VzZWQ6IFwic3RhcnRcIixcbiAgICAgICAgICAgICAgc3RhcnQ6IGRhdGUsXG4gICAgICAgICAgICAgIGVuZDogc3RhcnQsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaG92ZXJSYW5nZS5lbmQgPSBkYXRlO1xuICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlLmZvY3VzZWQgPSBcImVuZFwiO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIH07XG4gICAgdGhpcy5tb250aE1vdXNlT3V0Q2hhbmdlID0gKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuaG92ZXJSYW5nZSkge1xuICAgICAgICB0aGlzLmhvdmVyUmFuZ2UgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLnJlc2V0QWN0aXZlRGF0ZXMgPSAoKSA9PiB7XG4gICAgICBjb25zdCB7IHZhbHVlQXNEYXRlIH0gPSB0aGlzO1xuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlQXNEYXRlKSAmJiB2YWx1ZUFzRGF0ZSAmJiB2YWx1ZUFzRGF0ZSAhPT0gdGhpcy5hY3RpdmVEYXRlKSB7XG4gICAgICAgIHRoaXMuYWN0aXZlRGF0ZSA9IG5ldyBEYXRlKHZhbHVlQXNEYXRlKTtcbiAgICAgIH1cbiAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlQXNEYXRlKSkge1xuICAgICAgICBpZiAodmFsdWVBc0RhdGVbMF0gJiYgdmFsdWVBc0RhdGVbMF0gIT09IHRoaXMuYWN0aXZlU3RhcnREYXRlKSB7XG4gICAgICAgICAgdGhpcy5hY3RpdmVTdGFydERhdGUgPSBuZXcgRGF0ZSh2YWx1ZUFzRGF0ZVswXSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlQXNEYXRlWzFdICYmIHZhbHVlQXNEYXRlWzFdICE9PSB0aGlzLmFjdGl2ZUVuZERhdGUpIHtcbiAgICAgICAgICB0aGlzLmFjdGl2ZUVuZERhdGUgPSBuZXcgRGF0ZSh2YWx1ZUFzRGF0ZVsxXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEV2ZW50IGhhbmRsZXIgZm9yIHdoZW4gdGhlIHNlbGVjdGVkIGRhdGUgY2hhbmdlc1xuICAgICAqXG4gICAgICogQHBhcmFtIGV2ZW50XG4gICAgICovXG4gICAgdGhpcy5tb250aERhdGVDaGFuZ2UgPSAoZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShldmVudC5kZXRhaWwpO1xuICAgICAgY29uc3QgaXNvRGF0ZSA9IGRhdGVUb0lTTyhkYXRlKTtcbiAgICAgIGlmICghdGhpcy5yYW5nZSAmJiBpc29EYXRlID09PSBkYXRlVG9JU08odGhpcy52YWx1ZUFzRGF0ZSkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKCF0aGlzLnJhbmdlKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSBpc29EYXRlIHx8IFwiXCI7XG4gICAgICAgIHRoaXMudmFsdWVBc0RhdGUgPSBkYXRlIHx8IG51bGw7XG4gICAgICAgIHRoaXMuYWN0aXZlRGF0ZSA9IGRhdGUgfHwgbnVsbDtcbiAgICAgICAgdGhpcy5jYWxjaXRlRGF0ZVBpY2tlckNoYW5nZS5lbWl0KCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHN0YXJ0ID0gdGhpcy5nZXRTdGFydERhdGUoKTtcbiAgICAgIGNvbnN0IGVuZCA9IHRoaXMuZ2V0RW5kRGF0ZSgpO1xuICAgICAgaWYgKCFzdGFydCB8fCAoIWVuZCAmJiBkYXRlIDwgc3RhcnQpKSB7XG4gICAgICAgIGlmIChzdGFydCkge1xuICAgICAgICAgIHRoaXMuc2V0RW5kRGF0ZShuZXcgRGF0ZShzdGFydCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZVJhbmdlID09IFwiZW5kXCIpIHtcbiAgICAgICAgICB0aGlzLnNldEVuZERhdGUoZGF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgdGhpcy5zZXRTdGFydERhdGUoZGF0ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKCFlbmQpIHtcbiAgICAgICAgdGhpcy5zZXRFbmREYXRlKGRhdGUpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGlmICghdGhpcy5wcm94aW1pdHlTZWxlY3Rpb25EaXNhYmxlZCkge1xuICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZVJhbmdlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5hY3RpdmVSYW5nZSA9PSBcImVuZFwiKSB7XG4gICAgICAgICAgICAgIHRoaXMuc2V0RW5kRGF0ZShkYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICB0aGlzLnNldFN0YXJ0RGF0ZShkYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBzdGFydERpZmYgPSBnZXREYXlzRGlmZihkYXRlLCBzdGFydCk7XG4gICAgICAgICAgICBjb25zdCBlbmREaWZmID0gZ2V0RGF5c0RpZmYoZGF0ZSwgZW5kKTtcbiAgICAgICAgICAgIGlmIChlbmREaWZmID09PSAwIHx8IHN0YXJ0RGlmZiA8IDApIHtcbiAgICAgICAgICAgICAgdGhpcy5zZXRTdGFydERhdGUoZGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzdGFydERpZmYgPT09IDAgfHwgZW5kRGlmZiA8IDApIHtcbiAgICAgICAgICAgICAgdGhpcy5zZXRFbmREYXRlKGRhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc3RhcnREaWZmIDwgZW5kRGlmZikge1xuICAgICAgICAgICAgICB0aGlzLnNldFN0YXJ0RGF0ZShkYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICB0aGlzLnNldEVuZERhdGUoZGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHRoaXMuc2V0U3RhcnREYXRlKGRhdGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aGlzLmNhbGNpdGVEYXRlUGlja2VyQ2hhbmdlLmVtaXQoKTtcbiAgICB9O1xuICAgIHRoaXMuYWN0aXZlRGF0ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmFjdGl2ZVJhbmdlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMudmFsdWUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5oZWFkaW5nTGV2ZWwgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy52YWx1ZUFzRGF0ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1pbkFzRGF0ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1heEFzRGF0ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1pbiA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1heCA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm51bWJlcmluZ1N5c3RlbSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnNjYWxlID0gXCJtXCI7XG4gICAgdGhpcy5yYW5nZSA9IGZhbHNlO1xuICAgIHRoaXMucHJveGltaXR5U2VsZWN0aW9uRGlzYWJsZWQgPSBmYWxzZTtcbiAgICB0aGlzLm1lc3NhZ2VPdmVycmlkZXMgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5tZXNzYWdlcyA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmFjdGl2ZUVuZERhdGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5hY3RpdmVTdGFydERhdGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5kYXRlVGltZUZvcm1hdCA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmRlZmF1bHRNZXNzYWdlcyA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmVmZmVjdGl2ZUxvY2FsZSA9IFwiXCI7XG4gICAgdGhpcy5lbmRBc0RhdGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5ob3ZlclJhbmdlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMubG9jYWxlRGF0YSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1vc3RSZWNlbnRSYW5nZVZhbHVlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuc3RhcnRBc0RhdGUgPSB1bmRlZmluZWQ7XG4gIH1cbiAgYWN0aXZlRGF0ZVdhdGNoZXIobmV3QWN0aXZlRGF0ZSkge1xuICAgIGlmICh0aGlzLmFjdGl2ZVJhbmdlID09PSBcImVuZFwiKSB7XG4gICAgICB0aGlzLmFjdGl2ZUVuZERhdGUgPSBuZXdBY3RpdmVEYXRlO1xuICAgIH1cbiAgfVxuICB2YWx1ZUFzRGF0ZVdhdGNoZXIobmV3VmFsdWVBc0RhdGUpIHtcbiAgICBpZiAodGhpcy5yYW5nZSAmJiBBcnJheS5pc0FycmF5KG5ld1ZhbHVlQXNEYXRlKSkge1xuICAgICAgY29uc3QgeyBhY3RpdmVTdGFydERhdGUsIGFjdGl2ZUVuZERhdGUgfSA9IHRoaXM7XG4gICAgICBjb25zdCBuZXdBY3RpdmVTdGFydERhdGUgPSBuZXdWYWx1ZUFzRGF0ZVswXTtcbiAgICAgIGNvbnN0IG5ld0FjdGl2ZUVuZERhdGUgPSBuZXdWYWx1ZUFzRGF0ZVsxXTtcbiAgICAgIHRoaXMuYWN0aXZlU3RhcnREYXRlID0gYWN0aXZlU3RhcnREYXRlICE9PSBuZXdBY3RpdmVTdGFydERhdGUgJiYgbmV3QWN0aXZlU3RhcnREYXRlO1xuICAgICAgdGhpcy5hY3RpdmVFbmREYXRlID0gYWN0aXZlRW5kRGF0ZSAhPT0gbmV3QWN0aXZlRW5kRGF0ZSAmJiBuZXdBY3RpdmVFbmREYXRlO1xuICAgIH1cbiAgICBlbHNlIGlmIChuZXdWYWx1ZUFzRGF0ZSAmJiBuZXdWYWx1ZUFzRGF0ZSAhPT0gdGhpcy5hY3RpdmVEYXRlKSB7XG4gICAgICB0aGlzLmFjdGl2ZURhdGUgPSBuZXdWYWx1ZUFzRGF0ZTtcbiAgICB9XG4gIH1cbiAgb25NaW5DaGFuZ2VkKG1pbikge1xuICAgIGlmIChtaW4pIHtcbiAgICAgIHRoaXMubWluQXNEYXRlID0gZGF0ZUZyb21JU08obWluKTtcbiAgICB9XG4gIH1cbiAgb25NYXhDaGFuZ2VkKG1heCkge1xuICAgIGlmIChtYXgpIHtcbiAgICAgIHRoaXMubWF4QXNEYXRlID0gZGF0ZUZyb21JU08obWF4KTtcbiAgICB9XG4gIH1cbiAgb25NZXNzYWdlc0NoYW5nZSgpIHtcbiAgICAvKiB3aXJlZCB1cCBieSB0OW4gdXRpbCAqL1xuICB9XG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gIFB1YmxpYyBNZXRob2RzXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLyoqIFNldHMgZm9jdXMgb24gdGhlIGNvbXBvbmVudCdzIGZpcnN0IGZvY3VzYWJsZSBlbGVtZW50LiAqL1xuICBhc3luYyBzZXRGb2N1cygpIHtcbiAgICBhd2FpdCBjb21wb25lbnRGb2N1c2FibGUodGhpcyk7XG4gICAgdGhpcy5lbC5mb2N1cygpO1xuICB9XG4gIC8qKlxuICAgKiBSZXNldHMgYWN0aXZlIGRhdGUgc3RhdGUuXG4gICAqIEBpbnRlcm5hbFxuICAgKi9cbiAgYXN5bmMgcmVzZXQoKSB7XG4gICAgdGhpcy5yZXNldEFjdGl2ZURhdGVzKCk7XG4gICAgdGhpcy5tb3N0UmVjZW50UmFuZ2VWYWx1ZSA9IHVuZGVmaW5lZDtcbiAgfVxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgTGlmZWN5Y2xlXG4gIC8vXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIGNvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIGNvbm5lY3RMb2NhbGl6ZWQodGhpcyk7XG4gICAgY29ubmVjdE1lc3NhZ2VzKHRoaXMpO1xuICAgIGlmIChBcnJheS5pc0FycmF5KHRoaXMudmFsdWUpKSB7XG4gICAgICB0aGlzLnZhbHVlQXNEYXRlID0gZ2V0VmFsdWVBc0RhdGVSYW5nZSh0aGlzLnZhbHVlKTtcbiAgICB9XG4gICAgZWxzZSBpZiAodGhpcy52YWx1ZSkge1xuICAgICAgdGhpcy52YWx1ZUFzRGF0ZSA9IGRhdGVGcm9tSVNPKHRoaXMudmFsdWUpO1xuICAgIH1cbiAgICBpZiAodGhpcy5taW4pIHtcbiAgICAgIHRoaXMubWluQXNEYXRlID0gZGF0ZUZyb21JU08odGhpcy5taW4pO1xuICAgIH1cbiAgICBpZiAodGhpcy5tYXgpIHtcbiAgICAgIHRoaXMubWF4QXNEYXRlID0gZGF0ZUZyb21JU08odGhpcy5tYXgpO1xuICAgIH1cbiAgfVxuICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICBkaXNjb25uZWN0TG9jYWxpemVkKHRoaXMpO1xuICAgIGRpc2Nvbm5lY3RNZXNzYWdlcyh0aGlzKTtcbiAgfVxuICBhc3luYyBjb21wb25lbnRXaWxsTG9hZCgpIHtcbiAgICBzZXRVcExvYWRhYmxlQ29tcG9uZW50KHRoaXMpO1xuICAgIGF3YWl0IHRoaXMubG9hZExvY2FsZURhdGEoKTtcbiAgICB0aGlzLm9uTWluQ2hhbmdlZCh0aGlzLm1pbik7XG4gICAgdGhpcy5vbk1heENoYW5nZWQodGhpcy5tYXgpO1xuICAgIGF3YWl0IHNldFVwTWVzc2FnZXModGhpcyk7XG4gIH1cbiAgY29tcG9uZW50RGlkTG9hZCgpIHtcbiAgICBzZXRDb21wb25lbnRMb2FkZWQodGhpcyk7XG4gIH1cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IGRhdGUgPSBkYXRlRnJvbVJhbmdlKHRoaXMucmFuZ2UgJiYgQXJyYXkuaXNBcnJheSh0aGlzLnZhbHVlQXNEYXRlKSA/IHRoaXMudmFsdWVBc0RhdGVbMF0gOiB0aGlzLnZhbHVlQXNEYXRlLCB0aGlzLm1pbkFzRGF0ZSwgdGhpcy5tYXhBc0RhdGUpO1xuICAgIGxldCBhY3RpdmVEYXRlID0gdGhpcy5nZXRBY3RpdmVEYXRlKGRhdGUsIHRoaXMubWluQXNEYXRlLCB0aGlzLm1heEFzRGF0ZSk7XG4gICAgY29uc3QgZW5kRGF0ZSA9IHRoaXMucmFuZ2UgJiYgQXJyYXkuaXNBcnJheSh0aGlzLnZhbHVlQXNEYXRlKVxuICAgICAgPyBkYXRlRnJvbVJhbmdlKHRoaXMudmFsdWVBc0RhdGVbMV0sIHRoaXMubWluQXNEYXRlLCB0aGlzLm1heEFzRGF0ZSlcbiAgICAgIDogbnVsbDtcbiAgICBjb25zdCBhY3RpdmVFbmREYXRlID0gdGhpcy5nZXRBY3RpdmVFbmREYXRlKGVuZERhdGUsIHRoaXMubWluQXNEYXRlLCB0aGlzLm1heEFzRGF0ZSk7XG4gICAgaWYgKCh0aGlzLmFjdGl2ZVJhbmdlID09PSBcImVuZFwiIHx8XG4gICAgICAodGhpcy5ob3ZlclJhbmdlPy5mb2N1c2VkID09PSBcImVuZFwiICYmICghdGhpcy5wcm94aW1pdHlTZWxlY3Rpb25EaXNhYmxlZCB8fCBlbmREYXRlKSkpICYmXG4gICAgICBhY3RpdmVFbmREYXRlKSB7XG4gICAgICBhY3RpdmVEYXRlID0gYWN0aXZlRW5kRGF0ZTtcbiAgICB9XG4gICAgaWYgKHRoaXMucmFuZ2UgJiYgdGhpcy5tb3N0UmVjZW50UmFuZ2VWYWx1ZSkge1xuICAgICAgYWN0aXZlRGF0ZSA9IHRoaXMubW9zdFJlY2VudFJhbmdlVmFsdWU7XG4gICAgfVxuICAgIGNvbnN0IG1pbkRhdGUgPSB0aGlzLnJhbmdlICYmIHRoaXMuYWN0aXZlUmFuZ2VcbiAgICAgID8gdGhpcy5hY3RpdmVSYW5nZSA9PT0gXCJzdGFydFwiXG4gICAgICAgID8gdGhpcy5taW5Bc0RhdGVcbiAgICAgICAgOiBkYXRlIHx8IHRoaXMubWluQXNEYXRlXG4gICAgICA6IHRoaXMubWluQXNEYXRlO1xuICAgIGNvbnN0IG1heERhdGUgPSB0aGlzLnJhbmdlICYmIHRoaXMuYWN0aXZlUmFuZ2VcbiAgICAgID8gdGhpcy5hY3RpdmVSYW5nZSA9PT0gXCJzdGFydFwiXG4gICAgICAgID8gZW5kRGF0ZSB8fCB0aGlzLm1heEFzRGF0ZVxuICAgICAgICA6IHRoaXMubWF4QXNEYXRlXG4gICAgICA6IHRoaXMubWF4QXNEYXRlO1xuICAgIHJldHVybiAoaChIb3N0LCB7IG9uQmx1cjogdGhpcy5yZXNldEFjdGl2ZURhdGVzLCBvbktleURvd246IHRoaXMua2V5RG93bkhhbmRsZXIgfSwgdGhpcy5yZW5kZXJDYWxlbmRhcihhY3RpdmVEYXRlLCBtYXhEYXRlLCBtaW5EYXRlLCBkYXRlLCBlbmREYXRlKSkpO1xuICB9XG4gIGVmZmVjdGl2ZUxvY2FsZUNoYW5nZSgpIHtcbiAgICB1cGRhdGVNZXNzYWdlcyh0aGlzLCB0aGlzLmVmZmVjdGl2ZUxvY2FsZSk7XG4gIH1cbiAgdmFsdWVIYW5kbGVyKHZhbHVlKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICB0aGlzLnZhbHVlQXNEYXRlID0gZ2V0VmFsdWVBc0RhdGVSYW5nZSh2YWx1ZSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHZhbHVlKSB7XG4gICAgICB0aGlzLnZhbHVlQXNEYXRlID0gZGF0ZUZyb21JU08odmFsdWUpO1xuICAgIH1cbiAgfVxuICBhc3luYyBsb2FkTG9jYWxlRGF0YSgpIHtcbiAgICBpZiAoIUJ1aWxkLmlzQnJvd3Nlcikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBudW1iZXJTdHJpbmdGb3JtYXR0ZXIubnVtYmVyRm9ybWF0T3B0aW9ucyA9IHtcbiAgICAgIG51bWJlcmluZ1N5c3RlbTogdGhpcy5udW1iZXJpbmdTeXN0ZW0sXG4gICAgICBsb2NhbGU6IHRoaXMuZWZmZWN0aXZlTG9jYWxlLFxuICAgICAgdXNlR3JvdXBpbmc6IGZhbHNlLFxuICAgIH07XG4gICAgdGhpcy5sb2NhbGVEYXRhID0gYXdhaXQgZ2V0TG9jYWxlRGF0YSh0aGlzLmVmZmVjdGl2ZUxvY2FsZSk7XG4gICAgdGhpcy5kYXRlVGltZUZvcm1hdCA9IGdldERhdGVUaW1lRm9ybWF0KHRoaXMuZWZmZWN0aXZlTG9jYWxlLCBEQVRFX1BJQ0tFUl9GT1JNQVRfT1BUSU9OUyk7XG4gIH1cbiAgLyoqXG4gICAqIFJlbmRlciBjYWxjaXRlLWRhdGUtcGlja2VyLW1vbnRoLWhlYWRlciBhbmQgY2FsY2l0ZS1kYXRlLXBpY2tlci1tb250aFxuICAgKlxuICAgKiBAcGFyYW0gYWN0aXZlRGF0ZVxuICAgKiBAcGFyYW0gbWF4RGF0ZVxuICAgKiBAcGFyYW0gbWluRGF0ZVxuICAgKiBAcGFyYW0gZGF0ZVxuICAgKiBAcGFyYW0gZW5kRGF0ZVxuICAgKi9cbiAgcmVuZGVyQ2FsZW5kYXIoYWN0aXZlRGF0ZSwgbWF4RGF0ZSwgbWluRGF0ZSwgZGF0ZSwgZW5kRGF0ZSkge1xuICAgIHJldHVybiAodGhpcy5sb2NhbGVEYXRhICYmIFtcbiAgICAgIGgoXCJjYWxjaXRlLWRhdGUtcGlja2VyLW1vbnRoLWhlYWRlclwiLCB7IGFjdGl2ZURhdGU6IGFjdGl2ZURhdGUsIGhlYWRpbmdMZXZlbDogdGhpcy5oZWFkaW5nTGV2ZWwgfHwgSEVBRElOR19MRVZFTCwgbG9jYWxlRGF0YTogdGhpcy5sb2NhbGVEYXRhLCBtYXg6IG1heERhdGUsIG1lc3NhZ2VzOiB0aGlzLm1lc3NhZ2VzLCBtaW46IG1pbkRhdGUsIG9uQ2FsY2l0ZUludGVybmFsRGF0ZVBpY2tlclNlbGVjdDogdGhpcy5tb250aEhlYWRlclNlbGVjdENoYW5nZSwgc2NhbGU6IHRoaXMuc2NhbGUsIHNlbGVjdGVkRGF0ZTogdGhpcy5hY3RpdmVSYW5nZSA9PT0gXCJlbmRcIiA/IGVuZERhdGUgOiBkYXRlIHx8IG5ldyBEYXRlKCkgfSksXG4gICAgICBoKFwiY2FsY2l0ZS1kYXRlLXBpY2tlci1tb250aFwiLCB7IGFjdGl2ZURhdGU6IGFjdGl2ZURhdGUsIGRhdGVUaW1lRm9ybWF0OiB0aGlzLmRhdGVUaW1lRm9ybWF0LCBlbmREYXRlOiB0aGlzLnJhbmdlID8gZW5kRGF0ZSA6IHVuZGVmaW5lZCwgaG92ZXJSYW5nZTogdGhpcy5ob3ZlclJhbmdlLCBsb2NhbGVEYXRhOiB0aGlzLmxvY2FsZURhdGEsIG1heDogbWF4RGF0ZSwgbWluOiBtaW5EYXRlLCBvbkNhbGNpdGVJbnRlcm5hbERhdGVQaWNrZXJBY3RpdmVEYXRlQ2hhbmdlOiB0aGlzLm1vbnRoQWN0aXZlRGF0ZUNoYW5nZSwgb25DYWxjaXRlSW50ZXJuYWxEYXRlUGlja2VySG92ZXI6IHRoaXMubW9udGhIb3ZlckNoYW5nZSwgb25DYWxjaXRlSW50ZXJuYWxEYXRlUGlja2VyTW91c2VPdXQ6IHRoaXMubW9udGhNb3VzZU91dENoYW5nZSwgb25DYWxjaXRlSW50ZXJuYWxEYXRlUGlja2VyU2VsZWN0OiB0aGlzLm1vbnRoRGF0ZUNoYW5nZSwgc2NhbGU6IHRoaXMuc2NhbGUsIHNlbGVjdGVkRGF0ZTogdGhpcy5hY3RpdmVSYW5nZSA9PT0gXCJlbmRcIiA/IGVuZERhdGUgOiBkYXRlLCBzdGFydERhdGU6IHRoaXMucmFuZ2UgPyBkYXRlIDogdW5kZWZpbmVkIH0pLFxuICAgIF0pO1xuICB9XG4gIGdldEVuZERhdGUoKSB7XG4gICAgcmV0dXJuIChBcnJheS5pc0FycmF5KHRoaXMudmFsdWVBc0RhdGUpICYmIHRoaXMudmFsdWVBc0RhdGVbMV0pIHx8IHVuZGVmaW5lZDtcbiAgfVxuICBzZXRFbmREYXRlKGRhdGUpIHtcbiAgICBjb25zdCBzdGFydERhdGUgPSB0aGlzLmdldFN0YXJ0RGF0ZSgpO1xuICAgIGNvbnN0IG5ld0VuZERhdGUgPSBkYXRlID8gc2V0RW5kT2ZEYXkoZGF0ZSkgOiBkYXRlO1xuICAgIHRoaXMudmFsdWUgPSBbZGF0ZVRvSVNPKHN0YXJ0RGF0ZSksIGRhdGVUb0lTTyhkYXRlKV07XG4gICAgdGhpcy52YWx1ZUFzRGF0ZSA9IFtzdGFydERhdGUsIGRhdGVdO1xuICAgIHRoaXMubW9zdFJlY2VudFJhbmdlVmFsdWUgPSBuZXdFbmREYXRlO1xuICAgIHRoaXMuY2FsY2l0ZURhdGVQaWNrZXJSYW5nZUNoYW5nZS5lbWl0KCk7XG4gICAgdGhpcy5hY3RpdmVFbmREYXRlID0gZGF0ZSB8fCBudWxsO1xuICB9XG4gIGdldFN0YXJ0RGF0ZSgpIHtcbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheSh0aGlzLnZhbHVlQXNEYXRlKSAmJiB0aGlzLnZhbHVlQXNEYXRlWzBdO1xuICB9XG4gIHNldFN0YXJ0RGF0ZShkYXRlKSB7XG4gICAgY29uc3QgZW5kRGF0ZSA9IHRoaXMuZ2V0RW5kRGF0ZSgpO1xuICAgIHRoaXMudmFsdWUgPSBbZGF0ZVRvSVNPKGRhdGUpLCBkYXRlVG9JU08oZW5kRGF0ZSldO1xuICAgIHRoaXMudmFsdWVBc0RhdGUgPSBbZGF0ZSwgZW5kRGF0ZV07XG4gICAgdGhpcy5tb3N0UmVjZW50UmFuZ2VWYWx1ZSA9IGRhdGU7XG4gICAgdGhpcy5jYWxjaXRlRGF0ZVBpY2tlclJhbmdlQ2hhbmdlLmVtaXQoKTtcbiAgICB0aGlzLmFjdGl2ZVN0YXJ0RGF0ZSA9IGRhdGUgfHwgbnVsbDtcbiAgfVxuICAvKipcbiAgICogR2V0IGFuIGFjdGl2ZSBkYXRlIHVzaW5nIHRoZSB2YWx1ZSwgb3IgY3VycmVudCBkYXRlIGFzIGRlZmF1bHRcbiAgICpcbiAgICogQHBhcmFtIHZhbHVlXG4gICAqIEBwYXJhbSBtaW5cbiAgICogQHBhcmFtIG1heFxuICAgKi9cbiAgZ2V0QWN0aXZlRGF0ZSh2YWx1ZSwgbWluLCBtYXgpIHtcbiAgICByZXR1cm4gZGF0ZUZyb21SYW5nZSh0aGlzLmFjdGl2ZURhdGUsIG1pbiwgbWF4KSB8fCB2YWx1ZSB8fCBkYXRlRnJvbVJhbmdlKG5ldyBEYXRlKCksIG1pbiwgbWF4KTtcbiAgfVxuICBnZXRBY3RpdmVFbmREYXRlKHZhbHVlLCBtaW4sIG1heCkge1xuICAgIHJldHVybiAoZGF0ZUZyb21SYW5nZSh0aGlzLmFjdGl2ZUVuZERhdGUsIG1pbiwgbWF4KSB8fCB2YWx1ZSB8fCBkYXRlRnJvbVJhbmdlKG5ldyBEYXRlKCksIG1pbiwgbWF4KSk7XG4gIH1cbiAgc3RhdGljIGdldCBkZWxlZ2F0ZXNGb2N1cygpIHsgcmV0dXJuIHRydWU7IH1cbiAgc3RhdGljIGdldCBhc3NldHNEaXJzKCkgeyByZXR1cm4gW1wiYXNzZXRzXCJdOyB9XG4gIGdldCBlbCgpIHsgcmV0dXJuIHRoaXM7IH1cbiAgc3RhdGljIGdldCB3YXRjaGVycygpIHsgcmV0dXJuIHtcbiAgICBcImFjdGl2ZURhdGVcIjogW1wiYWN0aXZlRGF0ZVdhdGNoZXJcIl0sXG4gICAgXCJ2YWx1ZUFzRGF0ZVwiOiBbXCJ2YWx1ZUFzRGF0ZVdhdGNoZXJcIl0sXG4gICAgXCJtaW5cIjogW1wib25NaW5DaGFuZ2VkXCJdLFxuICAgIFwibWF4XCI6IFtcIm9uTWF4Q2hhbmdlZFwiXSxcbiAgICBcIm1lc3NhZ2VPdmVycmlkZXNcIjogW1wib25NZXNzYWdlc0NoYW5nZVwiXSxcbiAgICBcImVmZmVjdGl2ZUxvY2FsZVwiOiBbXCJlZmZlY3RpdmVMb2NhbGVDaGFuZ2VcIiwgXCJsb2FkTG9jYWxlRGF0YVwiXSxcbiAgICBcInZhbHVlXCI6IFtcInZhbHVlSGFuZGxlclwiXVxuICB9OyB9XG4gIHN0YXRpYyBnZXQgc3R5bGUoKSB7IHJldHVybiBkYXRlUGlja2VyQ3NzOyB9XG59LCBbMTcsIFwiY2FsY2l0ZS1kYXRlLXBpY2tlclwiLCB7XG4gICAgXCJhY3RpdmVEYXRlXCI6IFsxMDQwXSxcbiAgICBcImFjdGl2ZVJhbmdlXCI6IFs1MTMsIFwiYWN0aXZlLXJhbmdlXCJdLFxuICAgIFwidmFsdWVcIjogWzEwMjVdLFxuICAgIFwiaGVhZGluZ0xldmVsXCI6IFs1MTQsIFwiaGVhZGluZy1sZXZlbFwiXSxcbiAgICBcInZhbHVlQXNEYXRlXCI6IFsxMDQwXSxcbiAgICBcIm1pbkFzRGF0ZVwiOiBbMTA0MF0sXG4gICAgXCJtYXhBc0RhdGVcIjogWzEwNDBdLFxuICAgIFwibWluXCI6IFs1MTNdLFxuICAgIFwibWF4XCI6IFs1MTNdLFxuICAgIFwibnVtYmVyaW5nU3lzdGVtXCI6IFs1MTMsIFwibnVtYmVyaW5nLXN5c3RlbVwiXSxcbiAgICBcInNjYWxlXCI6IFs1MTNdLFxuICAgIFwicmFuZ2VcIjogWzUxNl0sXG4gICAgXCJwcm94aW1pdHlTZWxlY3Rpb25EaXNhYmxlZFwiOiBbNTE2LCBcInByb3hpbWl0eS1zZWxlY3Rpb24tZGlzYWJsZWRcIl0sXG4gICAgXCJtZXNzYWdlT3ZlcnJpZGVzXCI6IFsxMDQwXSxcbiAgICBcIm1lc3NhZ2VzXCI6IFsxMDQwXSxcbiAgICBcImFjdGl2ZUVuZERhdGVcIjogWzMyXSxcbiAgICBcImFjdGl2ZVN0YXJ0RGF0ZVwiOiBbMzJdLFxuICAgIFwiZGF0ZVRpbWVGb3JtYXRcIjogWzMyXSxcbiAgICBcImRlZmF1bHRNZXNzYWdlc1wiOiBbMzJdLFxuICAgIFwiZWZmZWN0aXZlTG9jYWxlXCI6IFszMl0sXG4gICAgXCJlbmRBc0RhdGVcIjogWzMyXSxcbiAgICBcImhvdmVyUmFuZ2VcIjogWzMyXSxcbiAgICBcImxvY2FsZURhdGFcIjogWzMyXSxcbiAgICBcIm1vc3RSZWNlbnRSYW5nZVZhbHVlXCI6IFszMl0sXG4gICAgXCJzdGFydEFzRGF0ZVwiOiBbMzJdLFxuICAgIFwic2V0Rm9jdXNcIjogWzY0XSxcbiAgICBcInJlc2V0XCI6IFs2NF1cbiAgfV0pO1xuZnVuY3Rpb24gZGVmaW5lQ3VzdG9tRWxlbWVudCgpIHtcbiAgaWYgKHR5cGVvZiBjdXN0b21FbGVtZW50cyA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBjb21wb25lbnRzID0gW1wiY2FsY2l0ZS1kYXRlLXBpY2tlclwiLCBcImNhbGNpdGUtZGF0ZS1waWNrZXItZGF5XCIsIFwiY2FsY2l0ZS1kYXRlLXBpY2tlci1tb250aFwiLCBcImNhbGNpdGUtZGF0ZS1waWNrZXItbW9udGgtaGVhZGVyXCIsIFwiY2FsY2l0ZS1pY29uXCJdO1xuICBjb21wb25lbnRzLmZvckVhY2godGFnTmFtZSA9PiB7IHN3aXRjaCAodGFnTmFtZSkge1xuICAgIGNhc2UgXCJjYWxjaXRlLWRhdGUtcGlja2VyXCI6XG4gICAgICBpZiAoIWN1c3RvbUVsZW1lbnRzLmdldCh0YWdOYW1lKSkge1xuICAgICAgICBjdXN0b21FbGVtZW50cy5kZWZpbmUodGFnTmFtZSwgRGF0ZVBpY2tlcik7XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwiY2FsY2l0ZS1kYXRlLXBpY2tlci1kYXlcIjpcbiAgICAgIGlmICghY3VzdG9tRWxlbWVudHMuZ2V0KHRhZ05hbWUpKSB7XG4gICAgICAgIGRlZmluZUN1c3RvbUVsZW1lbnQkNCgpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImNhbGNpdGUtZGF0ZS1waWNrZXItbW9udGhcIjpcbiAgICAgIGlmICghY3VzdG9tRWxlbWVudHMuZ2V0KHRhZ05hbWUpKSB7XG4gICAgICAgIGRlZmluZUN1c3RvbUVsZW1lbnQkMygpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImNhbGNpdGUtZGF0ZS1waWNrZXItbW9udGgtaGVhZGVyXCI6XG4gICAgICBpZiAoIWN1c3RvbUVsZW1lbnRzLmdldCh0YWdOYW1lKSkge1xuICAgICAgICBkZWZpbmVDdXN0b21FbGVtZW50JDIoKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJjYWxjaXRlLWljb25cIjpcbiAgICAgIGlmICghY3VzdG9tRWxlbWVudHMuZ2V0KHRhZ05hbWUpKSB7XG4gICAgICAgIGRlZmluZUN1c3RvbUVsZW1lbnQkMSgpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gIH0gfSk7XG59XG5kZWZpbmVDdXN0b21FbGVtZW50KCk7XG5cbmV4cG9ydCB7IERhdGVQaWNrZXIgYXMgRCwgZ2V0TG9jYWxlRGF0YSBhcyBhLCBkZWZpbmVDdXN0b21FbGVtZW50IGFzIGQsIGdldFZhbHVlQXNEYXRlUmFuZ2UgYXMgZyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9
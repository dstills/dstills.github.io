"use strict";
(self["webpackChunksynview"] = self["webpackChunksynview"] || []).push([["node_modules_esri_calcite-components_dist_components_calcite-stepper_js"],{

/***/ "./node_modules/@esri/calcite-components/dist/components/calcite-stepper.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/components/calcite-stepper.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   CalciteStepper: () => (/* binding */ CalciteStepper),
/* harmony export */   defineCustomElement: () => (/* binding */ defineCustomElement)
/* harmony export */ });
/* harmony import */ var _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @stencil/core/internal/client/index.js */ "./node_modules/@stencil/core/internal/client/index.js");
/* harmony import */ var _dom_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dom.js */ "./node_modules/@esri/calcite-components/dist/components/dom.js");
/* harmony import */ var _observers_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./observers.js */ "./node_modules/@esri/calcite-components/dist/components/observers.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v1.7.0
 */




const stepperCss = ":host{position:relative;display:flex;inline-size:100%;min-inline-size:-moz-fit-content;min-inline-size:fit-content;flex-direction:row;flex-wrap:wrap;align-items:stretch;justify-content:space-between}:host([layout=vertical]){flex:1 1 auto;flex-direction:column}:host([layout=horizontal]){display:grid;grid-template-areas:\"items\" \"content\"}:host([hidden]){display:none}[hidden]{display:none}";

const Stepper = /*@__PURE__*/ (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_2__.proxyCustomElement)(class extends _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_2__.HTMLElement {
  constructor() {
    super();
    this.__registerHost();
    this.__attachShadow();
    this.calciteStepperItemChange = (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_2__.createEvent)(this, "calciteStepperItemChange", 6);
    this.calciteInternalStepperItemChange = (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_2__.createEvent)(this, "calciteInternalStepperItemChange", 6);
    this.itemMap = new Map();
    /** list of sorted Stepper items */
    this.items = [];
    /** list of enabled Stepper items */
    this.enabledItems = [];
    this.mutationObserver = (0,_observers_js__WEBPACK_IMPORTED_MODULE_1__.c)("mutation", () => this.updateItems());
    this.icon = false;
    this.layout = "horizontal";
    this.numbered = false;
    this.scale = "m";
    this.numberingSystem = undefined;
    this.selectedItem = null;
  }
  handleItemPropChange() {
    this.updateItems();
  }
  numberingSystemChange() {
    this.setStepperItemNumberingSystem();
  }
  //--------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  //--------------------------------------------------------------------------
  connectedCallback() {
    this.mutationObserver?.observe(this.el, { childList: true });
    this.updateItems();
  }
  componentDidLoad() {
    // if no stepper items are set as active, default to the first one
    if (typeof this.currentPosition !== "number") {
      this.calciteInternalStepperItemChange.emit({
        position: 0,
      });
    }
  }
  render() {
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_2__.h)("slot", { onSlotchange: (event) => {
        const items = event.currentTarget
          .assignedElements()
          .filter((el) => el?.tagName === "CALCITE-STEPPER-ITEM");
        const spacing = Array(items.length).fill("1fr").join(" ");
        this.el.style.gridTemplateAreas = spacing;
        this.el.style.gridTemplateColumns = spacing;
        this.setStepperItemNumberingSystem();
      } }));
  }
  //--------------------------------------------------------------------------
  //
  //  Event Listeners
  //
  //--------------------------------------------------------------------------
  calciteInternalStepperItemKeyEvent(event) {
    const item = event.detail.item;
    const itemToFocus = event.target;
    switch (item.key) {
      case "ArrowDown":
      case "ArrowRight":
        (0,_dom_js__WEBPACK_IMPORTED_MODULE_0__.i)(this.enabledItems, itemToFocus, "next");
        break;
      case "ArrowUp":
      case "ArrowLeft":
        (0,_dom_js__WEBPACK_IMPORTED_MODULE_0__.i)(this.enabledItems, itemToFocus, "previous");
        break;
      case "Home":
        (0,_dom_js__WEBPACK_IMPORTED_MODULE_0__.i)(this.enabledItems, itemToFocus, "first");
        break;
      case "End":
        (0,_dom_js__WEBPACK_IMPORTED_MODULE_0__.i)(this.enabledItems, itemToFocus, "last");
        break;
    }
    event.stopPropagation();
  }
  registerItem(event) {
    const item = event.target;
    const { content, position } = event.detail;
    this.itemMap.set(item, { position, content });
    this.items = this.sortItems();
    this.enabledItems = this.filterItems();
    event.stopPropagation();
  }
  updateItem(event) {
    const { position } = event.detail;
    if (typeof position === "number") {
      this.currentPosition = position;
      this.selectedItem = event.target;
    }
    this.calciteInternalStepperItemChange.emit({
      position,
    });
  }
  handleUserRequestedStepperItemSelect() {
    this.calciteStepperItemChange.emit();
  }
  //--------------------------------------------------------------------------
  //
  //  Public Methods
  //
  //--------------------------------------------------------------------------
  /** Set the next `calcite-stepper-item` as active. */
  async nextStep() {
    const enabledStepIndex = this.getEnabledStepIndex(this.currentPosition + 1, "next");
    if (typeof enabledStepIndex !== "number") {
      return;
    }
    this.updateStep(enabledStepIndex);
  }
  /** Set the previous `calcite-stepper-item` as active. */
  async prevStep() {
    const enabledStepIndex = this.getEnabledStepIndex(this.currentPosition - 1, "previous");
    if (typeof enabledStepIndex !== "number") {
      return;
    }
    this.updateStep(enabledStepIndex);
  }
  /**
   * Set a specified `calcite-stepper-item` as active.
   *
   * @param step
   */
  async goToStep(step) {
    const position = step - 1;
    if (this.currentPosition !== position) {
      this.updateStep(position);
    }
  }
  /** Set the first `calcite-stepper-item` as active. */
  async startStep() {
    const enabledStepIndex = this.getEnabledStepIndex(0, "next");
    if (typeof enabledStepIndex !== "number") {
      return;
    }
    this.updateStep(enabledStepIndex);
  }
  /** Set the last `calcite-stepper-item` as active. */
  async endStep() {
    const enabledStepIndex = this.getEnabledStepIndex(this.items.length - 1, "previous");
    if (typeof enabledStepIndex !== "number") {
      return;
    }
    this.updateStep(enabledStepIndex);
  }
  updateItems() {
    this.el.querySelectorAll("calcite-stepper-item").forEach((item) => {
      item.icon = this.icon;
      item.numbered = this.numbered;
      item.layout = this.layout;
      item.scale = this.scale;
    });
  }
  //--------------------------------------------------------------------------
  //
  //  Private Methods
  //
  //--------------------------------------------------------------------------
  getEnabledStepIndex(startIndex, direction = "next") {
    const { items, currentPosition } = this;
    let newIndex = startIndex;
    while (items[newIndex]?.disabled) {
      newIndex = newIndex + (direction === "previous" ? -1 : 1);
    }
    return newIndex !== currentPosition && newIndex < items.length && newIndex >= 0
      ? newIndex
      : null;
  }
  updateStep(position) {
    this.currentPosition = position;
    this.calciteInternalStepperItemChange.emit({
      position,
    });
  }
  sortItems() {
    const { itemMap } = this;
    return Array.from(itemMap.keys()).sort((a, b) => itemMap.get(a).position - itemMap.get(b).position);
  }
  filterItems() {
    return this.items.filter((item) => !item.disabled);
  }
  setStepperItemNumberingSystem() {
    this.items.forEach((item) => {
      item.numberingSystem = this.numberingSystem;
    });
  }
  get el() { return this; }
  static get watchers() { return {
    "icon": ["handleItemPropChange"],
    "layout": ["handleItemPropChange"],
    "numbered": ["handleItemPropChange"],
    "scale": ["handleItemPropChange"],
    "numberingSystem": ["numberingSystemChange"]
  }; }
  static get style() { return stepperCss; }
}, [1, "calcite-stepper", {
    "icon": [516],
    "layout": [513],
    "numbered": [516],
    "scale": [513],
    "numberingSystem": [513, "numbering-system"],
    "selectedItem": [1040],
    "nextStep": [64],
    "prevStep": [64],
    "goToStep": [64],
    "startStep": [64],
    "endStep": [64]
  }, [[0, "calciteInternalStepperItemKeyEvent", "calciteInternalStepperItemKeyEvent"], [0, "calciteInternalStepperItemRegister", "registerItem"], [0, "calciteInternalStepperItemSelect", "updateItem"], [0, "calciteInternalUserRequestedStepperItemSelect", "handleUserRequestedStepperItemSelect"]]]);
function defineCustomElement$1() {
  if (typeof customElements === "undefined") {
    return;
  }
  const components = ["calcite-stepper"];
  components.forEach(tagName => { switch (tagName) {
    case "calcite-stepper":
      if (!customElements.get(tagName)) {
        customElements.define(tagName, Stepper);
      }
      break;
  } });
}
defineCustomElement$1();

const CalciteStepper = Stepper;
const defineCustomElement = defineCustomElement$1;




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9kZV9tb2R1bGVzX2VzcmlfY2FsY2l0ZS1jb21wb25lbnRzX2Rpc3RfY29tcG9uZW50c19jYWxjaXRlLXN0ZXBwZXJfanMuYnVuZGxlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUN5RztBQUNyRDtBQUNDOztBQUVyRCwwQkFBMEIsa0JBQWtCLGFBQWEsaUJBQWlCLGlDQUFpQyw0QkFBNEIsbUJBQW1CLGVBQWUsb0JBQW9CLDhCQUE4Qix5QkFBeUIsY0FBYyxzQkFBc0IsMkJBQTJCLGFBQWEsMENBQTBDLGdCQUFnQixhQUFhLFNBQVMsYUFBYTs7QUFFN1osOEJBQThCLDBGQUFrQixlQUFlLCtFQUFXO0FBQzFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLG1GQUFXO0FBQy9DLDRDQUE0QyxtRkFBVztBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLGdEQUFjO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGlCQUFpQjtBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxZQUFZLHlFQUFDLFdBQVc7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSwwQ0FBbUI7QUFDM0I7QUFDQTtBQUNBO0FBQ0EsUUFBUSwwQ0FBbUI7QUFDM0I7QUFDQTtBQUNBLFFBQVEsMENBQW1CO0FBQzNCO0FBQ0E7QUFDQSxRQUFRLDBDQUFtQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLG9CQUFvQjtBQUNoQyw2QkFBNkIsbUJBQW1CO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLFdBQVc7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx5QkFBeUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZLFVBQVU7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGFBQWE7QUFDYiwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7O0FBRStDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3ludmlldy8uL25vZGVfbW9kdWxlcy9AZXNyaS9jYWxjaXRlLWNvbXBvbmVudHMvZGlzdC9jb21wb25lbnRzL2NhbGNpdGUtc3RlcHBlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1kZXNpZ24tc3lzdGVtL2Jsb2IvbWFpbi9MSUNFTlNFLm1kIGZvciBkZXRhaWxzLlxuICogdjEuNy4wXG4gKi9cbmltcG9ydCB7IHByb3h5Q3VzdG9tRWxlbWVudCwgSFRNTEVsZW1lbnQsIGNyZWF0ZUV2ZW50LCBoIH0gZnJvbSAnQHN0ZW5jaWwvY29yZS9pbnRlcm5hbC9jbGllbnQvaW5kZXguanMnO1xuaW1wb3J0IHsgaSBhcyBmb2N1c0VsZW1lbnRJbkdyb3VwIH0gZnJvbSAnLi9kb20uanMnO1xuaW1wb3J0IHsgYyBhcyBjcmVhdGVPYnNlcnZlciB9IGZyb20gJy4vb2JzZXJ2ZXJzLmpzJztcblxuY29uc3Qgc3RlcHBlckNzcyA9IFwiOmhvc3R7cG9zaXRpb246cmVsYXRpdmU7ZGlzcGxheTpmbGV4O2lubGluZS1zaXplOjEwMCU7bWluLWlubGluZS1zaXplOi1tb3otZml0LWNvbnRlbnQ7bWluLWlubGluZS1zaXplOmZpdC1jb250ZW50O2ZsZXgtZGlyZWN0aW9uOnJvdztmbGV4LXdyYXA6d3JhcDthbGlnbi1pdGVtczpzdHJldGNoO2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVufTpob3N0KFtsYXlvdXQ9dmVydGljYWxdKXtmbGV4OjEgMSBhdXRvO2ZsZXgtZGlyZWN0aW9uOmNvbHVtbn06aG9zdChbbGF5b3V0PWhvcml6b250YWxdKXtkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1hcmVhczpcXFwiaXRlbXNcXFwiIFxcXCJjb250ZW50XFxcIn06aG9zdChbaGlkZGVuXSl7ZGlzcGxheTpub25lfVtoaWRkZW5de2Rpc3BsYXk6bm9uZX1cIjtcblxuY29uc3QgU3RlcHBlciA9IC8qQF9fUFVSRV9fKi8gcHJveHlDdXN0b21FbGVtZW50KGNsYXNzIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuX19yZWdpc3Rlckhvc3QoKTtcbiAgICB0aGlzLl9fYXR0YWNoU2hhZG93KCk7XG4gICAgdGhpcy5jYWxjaXRlU3RlcHBlckl0ZW1DaGFuZ2UgPSBjcmVhdGVFdmVudCh0aGlzLCBcImNhbGNpdGVTdGVwcGVySXRlbUNoYW5nZVwiLCA2KTtcbiAgICB0aGlzLmNhbGNpdGVJbnRlcm5hbFN0ZXBwZXJJdGVtQ2hhbmdlID0gY3JlYXRlRXZlbnQodGhpcywgXCJjYWxjaXRlSW50ZXJuYWxTdGVwcGVySXRlbUNoYW5nZVwiLCA2KTtcbiAgICB0aGlzLml0ZW1NYXAgPSBuZXcgTWFwKCk7XG4gICAgLyoqIGxpc3Qgb2Ygc29ydGVkIFN0ZXBwZXIgaXRlbXMgKi9cbiAgICB0aGlzLml0ZW1zID0gW107XG4gICAgLyoqIGxpc3Qgb2YgZW5hYmxlZCBTdGVwcGVyIGl0ZW1zICovXG4gICAgdGhpcy5lbmFibGVkSXRlbXMgPSBbXTtcbiAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIgPSBjcmVhdGVPYnNlcnZlcihcIm11dGF0aW9uXCIsICgpID0+IHRoaXMudXBkYXRlSXRlbXMoKSk7XG4gICAgdGhpcy5pY29uID0gZmFsc2U7XG4gICAgdGhpcy5sYXlvdXQgPSBcImhvcml6b250YWxcIjtcbiAgICB0aGlzLm51bWJlcmVkID0gZmFsc2U7XG4gICAgdGhpcy5zY2FsZSA9IFwibVwiO1xuICAgIHRoaXMubnVtYmVyaW5nU3lzdGVtID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuc2VsZWN0ZWRJdGVtID0gbnVsbDtcbiAgfVxuICBoYW5kbGVJdGVtUHJvcENoYW5nZSgpIHtcbiAgICB0aGlzLnVwZGF0ZUl0ZW1zKCk7XG4gIH1cbiAgbnVtYmVyaW5nU3lzdGVtQ2hhbmdlKCkge1xuICAgIHRoaXMuc2V0U3RlcHBlckl0ZW1OdW1iZXJpbmdTeXN0ZW0oKTtcbiAgfVxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBMaWZlY3ljbGVcbiAgLy9cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXI/Lm9ic2VydmUodGhpcy5lbCwgeyBjaGlsZExpc3Q6IHRydWUgfSk7XG4gICAgdGhpcy51cGRhdGVJdGVtcygpO1xuICB9XG4gIGNvbXBvbmVudERpZExvYWQoKSB7XG4gICAgLy8gaWYgbm8gc3RlcHBlciBpdGVtcyBhcmUgc2V0IGFzIGFjdGl2ZSwgZGVmYXVsdCB0byB0aGUgZmlyc3Qgb25lXG4gICAgaWYgKHR5cGVvZiB0aGlzLmN1cnJlbnRQb3NpdGlvbiAhPT0gXCJudW1iZXJcIikge1xuICAgICAgdGhpcy5jYWxjaXRlSW50ZXJuYWxTdGVwcGVySXRlbUNoYW5nZS5lbWl0KHtcbiAgICAgICAgcG9zaXRpb246IDAsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgcmVuZGVyKCkge1xuICAgIHJldHVybiAoaChcInNsb3RcIiwgeyBvblNsb3RjaGFuZ2U6IChldmVudCkgPT4ge1xuICAgICAgICBjb25zdCBpdGVtcyA9IGV2ZW50LmN1cnJlbnRUYXJnZXRcbiAgICAgICAgICAuYXNzaWduZWRFbGVtZW50cygpXG4gICAgICAgICAgLmZpbHRlcigoZWwpID0+IGVsPy50YWdOYW1lID09PSBcIkNBTENJVEUtU1RFUFBFUi1JVEVNXCIpO1xuICAgICAgICBjb25zdCBzcGFjaW5nID0gQXJyYXkoaXRlbXMubGVuZ3RoKS5maWxsKFwiMWZyXCIpLmpvaW4oXCIgXCIpO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLmdyaWRUZW1wbGF0ZUFyZWFzID0gc3BhY2luZztcbiAgICAgICAgdGhpcy5lbC5zdHlsZS5ncmlkVGVtcGxhdGVDb2x1bW5zID0gc3BhY2luZztcbiAgICAgICAgdGhpcy5zZXRTdGVwcGVySXRlbU51bWJlcmluZ1N5c3RlbSgpO1xuICAgICAgfSB9KSk7XG4gIH1cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgRXZlbnQgTGlzdGVuZXJzXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgY2FsY2l0ZUludGVybmFsU3RlcHBlckl0ZW1LZXlFdmVudChldmVudCkge1xuICAgIGNvbnN0IGl0ZW0gPSBldmVudC5kZXRhaWwuaXRlbTtcbiAgICBjb25zdCBpdGVtVG9Gb2N1cyA9IGV2ZW50LnRhcmdldDtcbiAgICBzd2l0Y2ggKGl0ZW0ua2V5KSB7XG4gICAgICBjYXNlIFwiQXJyb3dEb3duXCI6XG4gICAgICBjYXNlIFwiQXJyb3dSaWdodFwiOlxuICAgICAgICBmb2N1c0VsZW1lbnRJbkdyb3VwKHRoaXMuZW5hYmxlZEl0ZW1zLCBpdGVtVG9Gb2N1cywgXCJuZXh0XCIpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJBcnJvd1VwXCI6XG4gICAgICBjYXNlIFwiQXJyb3dMZWZ0XCI6XG4gICAgICAgIGZvY3VzRWxlbWVudEluR3JvdXAodGhpcy5lbmFibGVkSXRlbXMsIGl0ZW1Ub0ZvY3VzLCBcInByZXZpb3VzXCIpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJIb21lXCI6XG4gICAgICAgIGZvY3VzRWxlbWVudEluR3JvdXAodGhpcy5lbmFibGVkSXRlbXMsIGl0ZW1Ub0ZvY3VzLCBcImZpcnN0XCIpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJFbmRcIjpcbiAgICAgICAgZm9jdXNFbGVtZW50SW5Hcm91cCh0aGlzLmVuYWJsZWRJdGVtcywgaXRlbVRvRm9jdXMsIFwibGFzdFwiKTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICB9XG4gIHJlZ2lzdGVySXRlbShldmVudCkge1xuICAgIGNvbnN0IGl0ZW0gPSBldmVudC50YXJnZXQ7XG4gICAgY29uc3QgeyBjb250ZW50LCBwb3NpdGlvbiB9ID0gZXZlbnQuZGV0YWlsO1xuICAgIHRoaXMuaXRlbU1hcC5zZXQoaXRlbSwgeyBwb3NpdGlvbiwgY29udGVudCB9KTtcbiAgICB0aGlzLml0ZW1zID0gdGhpcy5zb3J0SXRlbXMoKTtcbiAgICB0aGlzLmVuYWJsZWRJdGVtcyA9IHRoaXMuZmlsdGVySXRlbXMoKTtcbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgfVxuICB1cGRhdGVJdGVtKGV2ZW50KSB7XG4gICAgY29uc3QgeyBwb3NpdGlvbiB9ID0gZXZlbnQuZGV0YWlsO1xuICAgIGlmICh0eXBlb2YgcG9zaXRpb24gPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIHRoaXMuY3VycmVudFBvc2l0aW9uID0gcG9zaXRpb247XG4gICAgICB0aGlzLnNlbGVjdGVkSXRlbSA9IGV2ZW50LnRhcmdldDtcbiAgICB9XG4gICAgdGhpcy5jYWxjaXRlSW50ZXJuYWxTdGVwcGVySXRlbUNoYW5nZS5lbWl0KHtcbiAgICAgIHBvc2l0aW9uLFxuICAgIH0pO1xuICB9XG4gIGhhbmRsZVVzZXJSZXF1ZXN0ZWRTdGVwcGVySXRlbVNlbGVjdCgpIHtcbiAgICB0aGlzLmNhbGNpdGVTdGVwcGVySXRlbUNoYW5nZS5lbWl0KCk7XG4gIH1cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgUHVibGljIE1ldGhvZHNcbiAgLy9cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvKiogU2V0IHRoZSBuZXh0IGBjYWxjaXRlLXN0ZXBwZXItaXRlbWAgYXMgYWN0aXZlLiAqL1xuICBhc3luYyBuZXh0U3RlcCgpIHtcbiAgICBjb25zdCBlbmFibGVkU3RlcEluZGV4ID0gdGhpcy5nZXRFbmFibGVkU3RlcEluZGV4KHRoaXMuY3VycmVudFBvc2l0aW9uICsgMSwgXCJuZXh0XCIpO1xuICAgIGlmICh0eXBlb2YgZW5hYmxlZFN0ZXBJbmRleCAhPT0gXCJudW1iZXJcIikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnVwZGF0ZVN0ZXAoZW5hYmxlZFN0ZXBJbmRleCk7XG4gIH1cbiAgLyoqIFNldCB0aGUgcHJldmlvdXMgYGNhbGNpdGUtc3RlcHBlci1pdGVtYCBhcyBhY3RpdmUuICovXG4gIGFzeW5jIHByZXZTdGVwKCkge1xuICAgIGNvbnN0IGVuYWJsZWRTdGVwSW5kZXggPSB0aGlzLmdldEVuYWJsZWRTdGVwSW5kZXgodGhpcy5jdXJyZW50UG9zaXRpb24gLSAxLCBcInByZXZpb3VzXCIpO1xuICAgIGlmICh0eXBlb2YgZW5hYmxlZFN0ZXBJbmRleCAhPT0gXCJudW1iZXJcIikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnVwZGF0ZVN0ZXAoZW5hYmxlZFN0ZXBJbmRleCk7XG4gIH1cbiAgLyoqXG4gICAqIFNldCBhIHNwZWNpZmllZCBgY2FsY2l0ZS1zdGVwcGVyLWl0ZW1gIGFzIGFjdGl2ZS5cbiAgICpcbiAgICogQHBhcmFtIHN0ZXBcbiAgICovXG4gIGFzeW5jIGdvVG9TdGVwKHN0ZXApIHtcbiAgICBjb25zdCBwb3NpdGlvbiA9IHN0ZXAgLSAxO1xuICAgIGlmICh0aGlzLmN1cnJlbnRQb3NpdGlvbiAhPT0gcG9zaXRpb24pIHtcbiAgICAgIHRoaXMudXBkYXRlU3RlcChwb3NpdGlvbik7XG4gICAgfVxuICB9XG4gIC8qKiBTZXQgdGhlIGZpcnN0IGBjYWxjaXRlLXN0ZXBwZXItaXRlbWAgYXMgYWN0aXZlLiAqL1xuICBhc3luYyBzdGFydFN0ZXAoKSB7XG4gICAgY29uc3QgZW5hYmxlZFN0ZXBJbmRleCA9IHRoaXMuZ2V0RW5hYmxlZFN0ZXBJbmRleCgwLCBcIm5leHRcIik7XG4gICAgaWYgKHR5cGVvZiBlbmFibGVkU3RlcEluZGV4ICE9PSBcIm51bWJlclwiKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMudXBkYXRlU3RlcChlbmFibGVkU3RlcEluZGV4KTtcbiAgfVxuICAvKiogU2V0IHRoZSBsYXN0IGBjYWxjaXRlLXN0ZXBwZXItaXRlbWAgYXMgYWN0aXZlLiAqL1xuICBhc3luYyBlbmRTdGVwKCkge1xuICAgIGNvbnN0IGVuYWJsZWRTdGVwSW5kZXggPSB0aGlzLmdldEVuYWJsZWRTdGVwSW5kZXgodGhpcy5pdGVtcy5sZW5ndGggLSAxLCBcInByZXZpb3VzXCIpO1xuICAgIGlmICh0eXBlb2YgZW5hYmxlZFN0ZXBJbmRleCAhPT0gXCJudW1iZXJcIikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnVwZGF0ZVN0ZXAoZW5hYmxlZFN0ZXBJbmRleCk7XG4gIH1cbiAgdXBkYXRlSXRlbXMoKSB7XG4gICAgdGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiY2FsY2l0ZS1zdGVwcGVyLWl0ZW1cIikuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgaXRlbS5pY29uID0gdGhpcy5pY29uO1xuICAgICAgaXRlbS5udW1iZXJlZCA9IHRoaXMubnVtYmVyZWQ7XG4gICAgICBpdGVtLmxheW91dCA9IHRoaXMubGF5b3V0O1xuICAgICAgaXRlbS5zY2FsZSA9IHRoaXMuc2NhbGU7XG4gICAgfSk7XG4gIH1cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgUHJpdmF0ZSBNZXRob2RzXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgZ2V0RW5hYmxlZFN0ZXBJbmRleChzdGFydEluZGV4LCBkaXJlY3Rpb24gPSBcIm5leHRcIikge1xuICAgIGNvbnN0IHsgaXRlbXMsIGN1cnJlbnRQb3NpdGlvbiB9ID0gdGhpcztcbiAgICBsZXQgbmV3SW5kZXggPSBzdGFydEluZGV4O1xuICAgIHdoaWxlIChpdGVtc1tuZXdJbmRleF0/LmRpc2FibGVkKSB7XG4gICAgICBuZXdJbmRleCA9IG5ld0luZGV4ICsgKGRpcmVjdGlvbiA9PT0gXCJwcmV2aW91c1wiID8gLTEgOiAxKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ld0luZGV4ICE9PSBjdXJyZW50UG9zaXRpb24gJiYgbmV3SW5kZXggPCBpdGVtcy5sZW5ndGggJiYgbmV3SW5kZXggPj0gMFxuICAgICAgPyBuZXdJbmRleFxuICAgICAgOiBudWxsO1xuICB9XG4gIHVwZGF0ZVN0ZXAocG9zaXRpb24pIHtcbiAgICB0aGlzLmN1cnJlbnRQb3NpdGlvbiA9IHBvc2l0aW9uO1xuICAgIHRoaXMuY2FsY2l0ZUludGVybmFsU3RlcHBlckl0ZW1DaGFuZ2UuZW1pdCh7XG4gICAgICBwb3NpdGlvbixcbiAgICB9KTtcbiAgfVxuICBzb3J0SXRlbXMoKSB7XG4gICAgY29uc3QgeyBpdGVtTWFwIH0gPSB0aGlzO1xuICAgIHJldHVybiBBcnJheS5mcm9tKGl0ZW1NYXAua2V5cygpKS5zb3J0KChhLCBiKSA9PiBpdGVtTWFwLmdldChhKS5wb3NpdGlvbiAtIGl0ZW1NYXAuZ2V0KGIpLnBvc2l0aW9uKTtcbiAgfVxuICBmaWx0ZXJJdGVtcygpIHtcbiAgICByZXR1cm4gdGhpcy5pdGVtcy5maWx0ZXIoKGl0ZW0pID0+ICFpdGVtLmRpc2FibGVkKTtcbiAgfVxuICBzZXRTdGVwcGVySXRlbU51bWJlcmluZ1N5c3RlbSgpIHtcbiAgICB0aGlzLml0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIGl0ZW0ubnVtYmVyaW5nU3lzdGVtID0gdGhpcy5udW1iZXJpbmdTeXN0ZW07XG4gICAgfSk7XG4gIH1cbiAgZ2V0IGVsKCkgeyByZXR1cm4gdGhpczsgfVxuICBzdGF0aWMgZ2V0IHdhdGNoZXJzKCkgeyByZXR1cm4ge1xuICAgIFwiaWNvblwiOiBbXCJoYW5kbGVJdGVtUHJvcENoYW5nZVwiXSxcbiAgICBcImxheW91dFwiOiBbXCJoYW5kbGVJdGVtUHJvcENoYW5nZVwiXSxcbiAgICBcIm51bWJlcmVkXCI6IFtcImhhbmRsZUl0ZW1Qcm9wQ2hhbmdlXCJdLFxuICAgIFwic2NhbGVcIjogW1wiaGFuZGxlSXRlbVByb3BDaGFuZ2VcIl0sXG4gICAgXCJudW1iZXJpbmdTeXN0ZW1cIjogW1wibnVtYmVyaW5nU3lzdGVtQ2hhbmdlXCJdXG4gIH07IH1cbiAgc3RhdGljIGdldCBzdHlsZSgpIHsgcmV0dXJuIHN0ZXBwZXJDc3M7IH1cbn0sIFsxLCBcImNhbGNpdGUtc3RlcHBlclwiLCB7XG4gICAgXCJpY29uXCI6IFs1MTZdLFxuICAgIFwibGF5b3V0XCI6IFs1MTNdLFxuICAgIFwibnVtYmVyZWRcIjogWzUxNl0sXG4gICAgXCJzY2FsZVwiOiBbNTEzXSxcbiAgICBcIm51bWJlcmluZ1N5c3RlbVwiOiBbNTEzLCBcIm51bWJlcmluZy1zeXN0ZW1cIl0sXG4gICAgXCJzZWxlY3RlZEl0ZW1cIjogWzEwNDBdLFxuICAgIFwibmV4dFN0ZXBcIjogWzY0XSxcbiAgICBcInByZXZTdGVwXCI6IFs2NF0sXG4gICAgXCJnb1RvU3RlcFwiOiBbNjRdLFxuICAgIFwic3RhcnRTdGVwXCI6IFs2NF0sXG4gICAgXCJlbmRTdGVwXCI6IFs2NF1cbiAgfSwgW1swLCBcImNhbGNpdGVJbnRlcm5hbFN0ZXBwZXJJdGVtS2V5RXZlbnRcIiwgXCJjYWxjaXRlSW50ZXJuYWxTdGVwcGVySXRlbUtleUV2ZW50XCJdLCBbMCwgXCJjYWxjaXRlSW50ZXJuYWxTdGVwcGVySXRlbVJlZ2lzdGVyXCIsIFwicmVnaXN0ZXJJdGVtXCJdLCBbMCwgXCJjYWxjaXRlSW50ZXJuYWxTdGVwcGVySXRlbVNlbGVjdFwiLCBcInVwZGF0ZUl0ZW1cIl0sIFswLCBcImNhbGNpdGVJbnRlcm5hbFVzZXJSZXF1ZXN0ZWRTdGVwcGVySXRlbVNlbGVjdFwiLCBcImhhbmRsZVVzZXJSZXF1ZXN0ZWRTdGVwcGVySXRlbVNlbGVjdFwiXV1dKTtcbmZ1bmN0aW9uIGRlZmluZUN1c3RvbUVsZW1lbnQkMSgpIHtcbiAgaWYgKHR5cGVvZiBjdXN0b21FbGVtZW50cyA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBjb21wb25lbnRzID0gW1wiY2FsY2l0ZS1zdGVwcGVyXCJdO1xuICBjb21wb25lbnRzLmZvckVhY2godGFnTmFtZSA9PiB7IHN3aXRjaCAodGFnTmFtZSkge1xuICAgIGNhc2UgXCJjYWxjaXRlLXN0ZXBwZXJcIjpcbiAgICAgIGlmICghY3VzdG9tRWxlbWVudHMuZ2V0KHRhZ05hbWUpKSB7XG4gICAgICAgIGN1c3RvbUVsZW1lbnRzLmRlZmluZSh0YWdOYW1lLCBTdGVwcGVyKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICB9IH0pO1xufVxuZGVmaW5lQ3VzdG9tRWxlbWVudCQxKCk7XG5cbmNvbnN0IENhbGNpdGVTdGVwcGVyID0gU3RlcHBlcjtcbmNvbnN0IGRlZmluZUN1c3RvbUVsZW1lbnQgPSBkZWZpbmVDdXN0b21FbGVtZW50JDE7XG5cbmV4cG9ydCB7IENhbGNpdGVTdGVwcGVyLCBkZWZpbmVDdXN0b21FbGVtZW50IH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=
"use strict";
(self["webpackChunksynview"] = self["webpackChunksynview"] || []).push([["vendors-node_modules_arcgis_core_webdoc_webdocSaveUtils_js"],{

/***/ "./node_modules/@arcgis/core/core/accessorSupport/originUtils.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@arcgis/core/core/accessorSupport/originUtils.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   updateOrigins: () => (/* binding */ i)
/* harmony export */ });
/* harmony import */ var _multiOriginJSONSupportUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../multiOriginJSONSupportUtils.js */ "./node_modules/@arcgis/core/core/multiOriginJSONSupportUtils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function i(i){i?.writtenProperties&&i.writtenProperties.forEach((({target:i,propName:t,newOrigin:e})=>{(0,_multiOriginJSONSupportUtils_js__WEBPACK_IMPORTED_MODULE_0__.isMultiOriginJSONMixin)(i)&&e&&i.originOf(t)!==e&&i.updateOrigin(t,e)}))}


/***/ }),

/***/ "./node_modules/@arcgis/core/core/multiOriginJSONSupportUtils.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@arcgis/core/core/multiOriginJSONSupportUtils.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isMultiOriginJSONMixin: () => (/* binding */ i)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function i(i){return i&&"getAtOrigin"in i&&"originOf"in i}


/***/ }),

/***/ "./node_modules/@arcgis/core/portal/support/resourceUtils.js":
/*!*******************************************************************!*\
  !*** ./node_modules/@arcgis/core/portal/support/resourceUtils.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   addOrUpdateResource: () => (/* binding */ s),
/* harmony export */   contentToBlob: () => (/* binding */ p),
/* harmony export */   fetchResources: () => (/* binding */ o),
/* harmony export */   getSiblingOfSameType: () => (/* binding */ d),
/* harmony export */   getSiblingOfSameTypeI: () => (/* binding */ m),
/* harmony export */   removeAllResources: () => (/* binding */ l),
/* harmony export */   removeResource: () => (/* binding */ n),
/* harmony export */   splitPrefixFileNameAndExtension: () => (/* binding */ c)
/* harmony export */ });
/* harmony import */ var _request_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../request.js */ "./node_modules/@arcgis/core/request.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/urlUtils.js */ "./node_modules/@arcgis/core/core/urlUtils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
async function o(e,t={},a){await e.load(a);const o=(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.join)(e.itemUrl,"resources"),{start:s=1,num:n=10,sortOrder:l="asc",sortField:u="created"}=t,c={query:{start:s,num:n,sortOrder:l,sortField:u,token:e.apiKey},signal:a?.signal},i=await e.portal.request(o,c);return{total:i.total,nextStart:i.nextStart,resources:i.resources.map((({created:t,size:r,resource:a})=>({created:new Date(t),size:r,resource:e.resourceFromPath(a)})))}}async function s(e,a,o,s){if(!e.hasPath())throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"](`portal-item-resource-${a}:invalid-path`,"Resource does not have a valid path");const n=e.portalItem;await n.load(s);const l=(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.join)(n.userItemUrl,"add"===a?"addResources":"updateResources"),[c,i]=u(e.path),p=new FormData;return c&&"."!==c&&p.append("resourcesPrefix",c),null!=s&&s.compress&&p.append("compress","true"),p.append("fileName",i),p.append("file",o,i),p.append("f","json"),s?.access&&p.append("access",s.access),await n.portal.request(l,{method:"post",body:p,signal:s?.signal}),e}async function n(e,a,o){if(!a.hasPath())throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("portal-item-resources-remove:invalid-path","Resource does not have a valid path");await e.load(o);const s=(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.join)(e.userItemUrl,"removeResources");await e.portal.request(s,{method:"post",query:{resource:a.path},signal:o?.signal}),a.portalItem=null}async function l(e,t){await e.load(t);const a=(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.join)(e.userItemUrl,"removeResources");return e.portal.request(a,{method:"post",query:{deleteAll:!0},signal:t?.signal})}function u(e){const t=e.lastIndexOf("/");return-1===t?[".",e]:[e.slice(0,t),e.slice(t+1)]}function c(e){const[t,r]=i(e),[a,o]=u(t);return[a,o,r]}function i(e){const t=(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.getPathExtension)(e);return null==t?[e,""]:[e.slice(0,e.length-t.length-1),`.${t}`]}async function p(t){if("blob"===t.type)return t.blob;if("json"===t.type)return new Blob([t.jsonString],{type:"application/json"});return(await (0,_request_js__WEBPACK_IMPORTED_MODULE_0__["default"])(t.url,{responseType:"blob"})).data}function d(e,t){if(!e.hasPath())return null;const[a,,o]=c(e.path);return e.portalItem.resourceFromPath((0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.join)(a,t+o))}function m(e,t){if(!e.hasPath())return null;const[a,,o]=c(e.path);return e.portalItem.resourceFromPath((0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.join)(a,t+o))}


/***/ }),

/***/ "./node_modules/@arcgis/core/webdoc/saveAPIKeyUtils.js":
/*!*************************************************************!*\
  !*** ./node_modules/@arcgis/core/webdoc/saveAPIKeyUtils.js ***!
  \*************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   validateSaveAPIKey: () => (/* binding */ i)
/* harmony export */ });
/* harmony import */ var _config_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../config.js */ "./node_modules/@arcgis/core/config.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _support_apiKeyUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../support/apiKeyUtils.js */ "./node_modules/@arcgis/core/support/apiKeyUtils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function i(i){if(_config_js__WEBPACK_IMPORTED_MODULE_0__["default"].apiKey&&(0,_support_apiKeyUtils_js__WEBPACK_IMPORTED_MODULE_2__.supportsApiKey)(i.portal.url))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("save-api-key-utils:api-key-not-supported",`Saving is not supported on ${i.portal.url} when using an api key`)}


/***/ }),

/***/ "./node_modules/@arcgis/core/webdoc/support/saveUtils.js":
/*!***************************************************************!*\
  !*** ./node_modules/@arcgis/core/webdoc/support/saveUtils.js ***!
  \***************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   beforeSave: () => (/* binding */ m),
/* harmony export */   saveResources: () => (/* binding */ u),
/* harmony export */   updateItemWithResources: () => (/* binding */ p)
/* harmony export */ });
/* harmony import */ var _core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/asyncUtils.js */ "./node_modules/@arcgis/core/core/asyncUtils.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_uuid_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/uuid.js */ "./node_modules/@arcgis/core/core/uuid.js");
/* harmony import */ var _portal_support_resourceUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../portal/support/resourceUtils.js */ "./node_modules/@arcgis/core/portal/support/resourceUtils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
async function u(e,r,o=null){const t=await i(e,r,o);await h(t,r,o)}async function p(e,r,o,t,s=null){const a=await i(o,t,s);await e.update({data:r}),await h(a,t,s)}async function i(e,s,n=null){if(!s?.resources)return;const u=s.portalItem===e.portalItem?new Set(e.paths):new Set;e.paths.length=0,e.portalItem=s.portalItem;const p=new Set(s.resources.toKeep.map((e=>e.resource.path))),i=new Set,h=[];p.forEach((r=>{u.delete(r),e.paths.push(r)}));for(const r of s.resources.toUpdate)if(u.delete(r.resource.path),p.has(r.resource.path)||i.has(r.resource.path)){const{resource:o,content:t,finish:s,error:u}=r,p=(0,_portal_support_resourceUtils_js__WEBPACK_IMPORTED_MODULE_4__.getSiblingOfSameTypeI)(o,(0,_core_uuid_js__WEBPACK_IMPORTED_MODULE_3__.generateUUID)());e.paths.push(p.path),h.push(f({resource:p,content:t,compress:r.compress,finish:s,error:u},n))}else e.paths.push(r.resource.path),h.push(l(r,n)),i.add(r.resource.path);for(const r of s.resources.toAdd)e.paths.push(r.resource.path),u.has(r.resource.path)?u.delete(r.resource.path):h.push(f(r,n));if(0===h.length)return u;const m=await (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__.allSettledErrors)(h);if((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__.throwIfAborted)(n),m.length>0)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("save:resources","Failed to save one or more resources",{errors:m});return u}async function h(e,r,o=null){if(!e||!r.portalItem)return;const t=[];for(const s of e){const e=r.portalItem.resourceFromPath(s);t.push(e.portalItem.removeResource(e,o))}await (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__.eachAlways)(t)}async function f(r,o){const t={...null!=o?o:{},compress:r.compress},s=await (0,_core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_0__.result)(r.resource.portalItem.addResource(r.resource,await (0,_portal_support_resourceUtils_js__WEBPACK_IMPORTED_MODULE_4__.contentToBlob)(r.content),t));if(!0!==s.ok)throw r.error?.(s.error),s.error;r.finish?.(r.resource)}async function l(r,o){const t=await (0,_core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_0__.result)(r.resource.update(await (0,_portal_support_resourceUtils_js__WEBPACK_IMPORTED_MODULE_4__.contentToBlob)(r.content),o));if(!0!==t.ok)throw r.error?.(t.error),t.error;r.finish?.(r.resource)}async function m(e){const r=[];for(const o of e.allLayers)if("beforeSave"in o&&"function"==typeof o.beforeSave){const e=o.beforeSave();e&&r.push(e)}await Promise.allSettled(r)}


/***/ }),

/***/ "./node_modules/@arcgis/core/webdoc/webdocSaveUtils.js":
/*!*************************************************************!*\
  !*** ./node_modules/@arcgis/core/webdoc/webdocSaveUtils.js ***!
  \*************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   save: () => (/* binding */ j),
/* harmony export */   saveAs: () => (/* binding */ A)
/* harmony export */ });
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_MultiOriginJSONSupport_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/MultiOriginJSONSupport.js */ "./node_modules/@arcgis/core/core/MultiOriginJSONSupport.js");
/* harmony import */ var _core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../core/reactiveUtils.js */ "./node_modules/@arcgis/core/core/reactiveUtils.js");
/* harmony import */ var _core_urlUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/urlUtils.js */ "./node_modules/@arcgis/core/core/urlUtils.js");
/* harmony import */ var _core_accessorSupport_originUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../core/accessorSupport/originUtils.js */ "./node_modules/@arcgis/core/core/accessorSupport/originUtils.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/* harmony import */ var _geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../geometry/support/spatialReferenceUtils.js */ "./node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js");
/* harmony import */ var _geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../geometry/support/webMercatorUtils.js */ "./node_modules/@arcgis/core/geometry/support/webMercatorUtils.js");
/* harmony import */ var _layers_support_arcgisLayerUrl_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../layers/support/arcgisLayerUrl.js */ "./node_modules/@arcgis/core/layers/support/arcgisLayerUrl.js");
/* harmony import */ var _layers_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../layers/support/layerUtils.js */ "./node_modules/@arcgis/core/layers/support/layerUtils.js");
/* harmony import */ var _portal_Portal_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../portal/Portal.js */ "./node_modules/@arcgis/core/portal/Portal.js");
/* harmony import */ var _portal_PortalItem_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../portal/PortalItem.js */ "./node_modules/@arcgis/core/portal/PortalItem.js");
/* harmony import */ var _portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../portal/support/portalItemUtils.js */ "./node_modules/@arcgis/core/portal/support/portalItemUtils.js");
/* harmony import */ var _rest_geometryService_project_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../rest/geometryService/project.js */ "./node_modules/@arcgis/core/rest/geometryService/project.js");
/* harmony import */ var _rest_support_ProjectParameters_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../rest/support/ProjectParameters.js */ "./node_modules/@arcgis/core/rest/support/ProjectParameters.js");
/* harmony import */ var _support_basemapUtils_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../support/basemapUtils.js */ "./node_modules/@arcgis/core/support/basemapUtils.js");
/* harmony import */ var _saveAPIKeyUtils_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./saveAPIKeyUtils.js */ "./node_modules/@arcgis/core/webdoc/saveAPIKeyUtils.js");
/* harmony import */ var _support_saveUtils_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./support/saveUtils.js */ "./node_modules/@arcgis/core/webdoc/support/saveUtils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const I=["NatGeo_World_Map","Ocean_Basemap","USA_Topo_Maps","World_Imagery","World_Street_Map","World_Terrain_Base","World_Topo_Map","World_Hillshade","Canvas/World_Light_Gray_Base","Canvas/World_Light_Gray_Reference","Canvas/World_Dark_Gray_Base","Canvas/World_Dark_Gray_Reference","Ocean/World_Ocean_Base","Ocean/World_Ocean_Reference","Reference/World_Boundaries_and_Places","Reference/World_Reference_Overlay","Reference/World_Transportation"].map((e=>e.toLowerCase()));async function j(e,t,a){a??={},S(e,t),await (0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_2__.whenOnce)((()=>!t.updatingFromView)),await t.load(),await k(t),await (0,_support_saveUtils_js__WEBPACK_IMPORTED_MODULE_17__.beforeSave)(t),await T(e,t);const i=t.portalItem,n=(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_3__.urlToObject)(i.itemUrl),s={origin:"web-map",messages:[],writtenProperties:[],url:n,portal:i.portal||_portal_Portal_js__WEBPACK_IMPORTED_MODULE_10__["default"].getDefault(),portalItem:i,verifyItemRelativeUrls:n?{rootPath:n.path,writtenUrls:[]}:null,blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},l=t.write({},s);return await Promise.all(s.resources.pendingOperations),D(e,s,a),await E(t,i),await ue(e,t,i,l,s),await Promise.all([t.updateItemThumbnail(),(0,_support_saveUtils_js__WEBPACK_IMPORTED_MODULE_17__.saveResources)(t.resourceReferences,s,null)]),i}async function A(e,t,o,a){a??={};const i=M(e,o);await (0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_2__.whenOnce)((()=>!t.updatingFromView)),await t.load(),await k(t),await (0,_support_saveUtils_js__WEBPACK_IMPORTED_MODULE_17__.beforeSave)(t),await T(e,t);const n={origin:"web-map",messages:[],writtenProperties:[],url:null,portal:i.portal,portalItem:i,blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},s=t.write({},n);await Promise.all(n.resources.pendingOperations),D(e,n,a),await z(t,i);const l=t.getThumbnailState();return await me(e,t,i,s,n,a)&&(t.resourceReferences.portalItem=i),t.restoreThumbnailFromState(l),await Promise.all([t.updateItemThumbnail(),(0,_support_saveUtils_js__WEBPACK_IMPORTED_MODULE_17__.saveResources)(t.resourceReferences,n,null)]),i}function S(t,r){if(!r.portalItem)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__["default"](`${t.name}:portal-item-not-set`,"Portal item to save to has not been set on the WebMap");(0,_saveAPIKeyUtils_js__WEBPACK_IMPORTED_MODULE_16__.validateSaveAPIKey)(r.portalItem),O(t,r.portalItem)}function O(t,r){if(r.type!==t.itemType)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__["default"](`${t.name}:portal-item-wrong-type`,`Portal item needs to have type "${t.itemType}"`)}async function T(t,o){if(!o.basemap?.baseLayers.length)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__["default"](`${t.name}:save`,"Map does not have a valid basemap with a base layer.");let a=null;if(await (0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_2__.whenOnce)((()=>{const e=(0,_support_basemapUtils_js__WEBPACK_IMPORTED_MODULE_15__.findSpatialReference)(o.initialViewProperties,o.basemap);return a=e.spatialReference,!e.updating})),!(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_6__.equals)(a,o.initialViewProperties.spatialReference))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__["default"](`${t.name}:save`,"The spatial reference of the basemap is not compatible with the one from the map.",{expected:o.initialViewProperties.spatialReference,actual:a})}function M(e,t){let r=_portal_PortalItem_js__WEBPACK_IMPORTED_MODULE_11__["default"].from(t);return r.id&&(r=r.clone(),r.id=null),r.type||(r.type=e.itemType),r.portal||(r.portal=_portal_Portal_js__WEBPACK_IMPORTED_MODULE_10__["default"].getDefault()),(0,_saveAPIKeyUtils_js__WEBPACK_IMPORTED_MODULE_16__.validateSaveAPIKey)(r),O(e,r),r}function k(e){const t=[];return e.basemap&&t.push(e.basemap.load()),e.ground&&t.push(e.ground.load()),Promise.allSettled(t).then((()=>{}))}function D(t,r,o){let a=(r.messages??[]).filter((e=>"error"===e.type)).map((t=>new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__["default"](t.name,t.message,t.details)));if(r.blockedRelativeUrls&&(a=a.concat(r.blockedRelativeUrls.map((t=>new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__["default"]("url:unsupported",`Relative url '${t}' is not supported in Web Map`))))),o.ignoreUnsupported&&(a=a.filter((e=>"layer:unsupported"!==e.name&&"symbol:unsupported"!==e.name&&"symbol-layer:unsupported"!==e.name&&"property:unsupported"!==e.name&&"url:unsupported"!==e.name))),a.length>0)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__["default"](`${t.name}:save`,"Failed to save webmap due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:a})}async function E(e,t){t.extent=await ne(e.portalItem,e.initialViewProperties.viewpoint.targetGeometry),await Q(e,t)}const V=_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.TypeKeyword.JSAPI,C="CollectorDisabled",G="Collector",L="Data Editing",$="OfflineDisabled",B="Offline",K="Workforce Project",x="Workforce Worker",F="Workforce Dispatcher",N="Offline Map Areas",H="FieldMapsDisabled",J=_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.TypeKeyword.DEVELOPER_BASEMAP,q="UtilityNetwork";async function z(e,t){(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.removeTypeKeyword)(t,C),(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.removeTypeKeyword)(t,H),(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.removeTypeKeyword)(t,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.TypeKeyword.METADATA),(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.removeTypeKeyword)(t,$),(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.removeTypeKeyword)(t,N),(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.removeTypeKeyword)(t,F),(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.removeTypeKeyword)(t,K),(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.removeTypeKeyword)(t,x),await E(e,t)}async function Q(e,t){(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.addTypeKeyword)(t,V),await X(e),te(e,t),re(e,t),oe(e,t),ae(e,t),ie(e,t),t.typeKeywords&&(t.typeKeywords=t.typeKeywords.filter(((e,t,r)=>r.indexOf(e)===t)))}function X(e){const t=Y(e).map((e=>e.load())).toArray();return Promise.allSettled(t).then((()=>{}))}function Y(e){return e.allLayers.concat(e.allTables)}function Z(e){return Y(e).some((e=>e.loaded&&(0,_layers_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_9__.isLayerWithFeatureLayerSource)(e)&&e.capabilities.operations.supportsEditing&&e.editingEnabled&&("subtype-group"!==e.type||e.sublayers.some((e=>e.editingEnabled)))))}function ee(e){return Y(e).filter((e=>"group"!==e.type)).every((t=>t.loaded&&pe(e,t)))}function te(e,t){(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.hasTypeKeyword)(t,C)||(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.hasTypeKeyword)(t,K)||(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.hasTypeKeyword)(t,x)||(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.hasTypeKeyword)(t,F)||!Z(e)?(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.removeTypeKeyword)(t,G):(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.addTypeKeyword)(t,G)}function re(e,t){Z(e)?(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.addTypeKeyword)(t,L):(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.removeTypeKeyword)(t,L)}function oe(e,t){!(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.hasTypeKeyword)(t,$)&&ee(e)?(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.addTypeKeyword)(t,B):(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.removeTypeKeyword)(t,B)}function ae(e,t){(0,_support_basemapUtils_js__WEBPACK_IMPORTED_MODULE_15__.hasDeveloperBasemapLayer)(e.basemap)?(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.addTypeKeyword)(t,J):(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.removeTypeKeyword)(t,J)}function ie(e,t){e.utilityNetworks?.length?(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.addTypeKeyword)(t,q):(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_12__.removeTypeKeyword)(t,q)}async function ne(e,t){const r=t.clone().normalize();let o;if(r.length>1)for(const a of r)o?a.width>o.width&&(o=a):o=a;else o=r[0];return se(e,o)}async function se(e,t){const r=t.spatialReference;if(r.isWGS84)return t.clone();if(r.isWebMercator)return (0,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_7__.webMercatorToGeographic)(t);const{getGeometryServiceURL:o}=await __webpack_require__.e(/*! import() */ "node_modules_arcgis_core_portal_support_geometryServiceUtils_js-_f1400").then(__webpack_require__.bind(__webpack_require__, /*! ../portal/support/geometryServiceUtils.js */ "./node_modules/@arcgis/core/portal/support/geometryServiceUtils.js")),a=await o(e),i=new _rest_support_ProjectParameters_js__WEBPACK_IMPORTED_MODULE_14__["default"];i.geometries=[t],i.outSpatialReference=_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_5__["default"].WGS84;return(await (0,_rest_geometryService_project_js__WEBPACK_IMPORTED_MODULE_13__.project)(a,i))[0]}function le(e){return (0,_layers_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_9__.isFeatureCollectionLayer)(e)||"map-notes"===e.type||"route"===e.type}function pe(e,t){return (0,_layers_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_9__.isLayerWithFeatureLayerSource)(t)&&t.capabilities.operations.supportsSync||le(t)&&!t.portalItem||("tile"===t.type||"vector-tile"===t.type)&&(t.capabilities.operations.supportsExportTiles||ce(t)||(0,_support_basemapUtils_js__WEBPACK_IMPORTED_MODULE_15__.isDeveloperBasemapLayer)(t))&&t.spatialReference.equals(e.initialViewProperties.spatialReference)}function ce(e){return"tile"===e.type&&((0,_layers_support_arcgisLayerUrl_js__WEBPACK_IMPORTED_MODULE_8__.isServerOrServicesAGOLUrl)(e.url)&&I.some((t=>e.url?.toLowerCase().includes("/"+t+"/"))))}async function ue(e,t,r,o,a){await r.update({data:o}),we(e,t,r,o,a)}async function me(t,r,o,a,i,n){const s=r.portalItem,l={item:s,authenticated:!(!s?.id||!s.portal.user)},p=o.portal;await p.signIn();const{copyAllowed:c,itemReloaded:u}=await de(l,p);if(l.authenticated||=u,!c)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__["default"](`${t.name}:save-as-copy-not-allowed`,"Owner of this map does not allow others to save a copy");const m=await fe(o,l,a,n);return r.portalItem=o,we(t,r,o,a,i),m}async function de(e,t){const{item:r,authenticated:o}=e;return r?.id&&r.typeKeywords?.includes("useOnly")?r.portal.portalHostname!==t.portalHostname?{copyAllowed:!1,itemReloaded:!1}:(o||await r.reload(),{copyAllowed:"admin"===r.itemControl||"update"===r.itemControl,itemReloaded:!0}):{copyAllowed:!0,itemReloaded:!1}}async function fe(e,t,r,o){const i=e.portal,{item:n}=t,{folder:s,copyAllResources:l}=o;let p=!1;if(l&&n?.id&&(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_3__.hasSameCanonicalPortal)(n.portal.url,i.url)&&parseInt(n.portal.currentVersion,10)>=2023){const{total:e}=await n.fetchResources();p=!!e}if(p){const t=await n.copy({copyResources:"all",folder:s});e.id=t.id,e.portal=t.portal;const o=e.toJSON();await e.load(),e.read(o),await e.update({data:r})}else await(i.user?.addItem({item:e,folder:s,data:r}));return p}function we(e,r,a,n,s){_core_MultiOriginJSONSupport_js__WEBPACK_IMPORTED_MODULE_1__.MultiOriginJSONSupport.prototype.read.call(r,{version:n.version,authoringApp:n.authoringApp,authoringAppVersion:n.authoringAppVersion},{origin:e.origin,ignoreDefaults:!0,url:a.itemUrl?(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_3__.urlToObject)(a.itemUrl):void 0}),(0,_core_accessorSupport_originUtils_js__WEBPACK_IMPORTED_MODULE_4__.updateOrigins)(s),r.resourceInfo=n}


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfYXJjZ2lzX2NvcmVfd2ViZG9jX3dlYmRvY1NhdmVVdGlsc19qcy5idW5kbGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUMyRSxjQUFjLHFEQUFxRCxnQ0FBZ0MsSUFBSSx1RkFBQywrQ0FBK0MsR0FBOEI7Ozs7Ozs7Ozs7Ozs7OztBQ0poUTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsNENBQWdGOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDSjlGO0FBQ0E7QUFDQTtBQUNBO0FBQ3VJLHVCQUF1QixJQUFJLGdCQUFnQixRQUFRLHVEQUFDLHlCQUF5QiwyREFBMkQsTUFBTSxPQUFPLHFEQUFxRCxrQkFBa0IsK0JBQStCLE9BQU8saUVBQWlFLDRCQUE0QixLQUFLLDBEQUEwRCxLQUFLLDBCQUEwQiwwQkFBMEIsc0RBQUMseUJBQXlCLEVBQUUsc0RBQXNELHFCQUFxQixnQkFBZ0IsUUFBUSx1REFBQywwRkFBMEYsb09BQW9PLHNDQUFzQyxJQUFJLHdCQUF3QiwwQkFBMEIsc0RBQUMsb0ZBQW9GLGdCQUFnQixRQUFRLHVEQUFDLGtDQUFrQywwQkFBMEIscUJBQXFCLGdCQUFnQixrQkFBa0Isb0JBQW9CLHNCQUFzQixnQkFBZ0IsUUFBUSx1REFBQyxrQ0FBa0MsMkJBQTJCLHFCQUFxQixhQUFhLGtCQUFrQixFQUFFLGNBQWMsMkJBQTJCLGlEQUFpRCxjQUFjLDJCQUEyQixjQUFjLGNBQWMsUUFBUSxtRUFBQyxJQUFJLDBEQUEwRCxFQUFFLEdBQUcsb0JBQW9CLGlDQUFpQyxtREFBbUQsd0JBQXdCLEVBQUUsYUFBYSx1REFBQyxRQUFRLG9CQUFvQixRQUFRLGdCQUFnQiw0QkFBNEIsc0JBQXNCLHFDQUFxQyx1REFBQyxTQUFTLGdCQUFnQiw0QkFBNEIsc0JBQXNCLHFDQUFxQyx1REFBQyxTQUF1Tjs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDSjkxRTtBQUNBO0FBQ0E7QUFDQTtBQUN1SCxj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LDJCQUEyQiw4QkFBOEIsMEJBQTBCLDhGQUFDLElBQUksTUFBTSx3QkFBd0IsT0FBTywwUkFBbUQsb0JBQW9CLDJFQUFDLENBQUMsdUNBQXVDLHFFQUFDLE9BQU8sYUFBYSwwRUFBQyxVQUFVLGVBQWUsT0FBTyx1RkFBQyw0Q0FBNEMsaUJBQWlCLE9BQU8sNEZBQUMscUtBQXFLLGtGQUFDLDBFQUEwRSxlQUFlLHdCQUF3Qiw0RkFBQyxnRUFBZ0UsNkJBQTZCLGdCQUFnQixPQUFPLGdCQUFnQiwrQkFBK0Isd0JBQXdCLCtDQUErQyxZQUFZLGlCQUFpQixNQUFNLDZCQUE2QixlQUFlLG9DQUFvQyxzREFBQyxJQUFJLE9BQU8scUZBQXFGLDBCQUEwQixzQ0FBc0MsdUJBQXVCLE1BQU0sdUJBQXVCLEdBQUcsOEZBQThGLCtCQUErQix1QkFBdUIsOEVBQThFLEdBQUcsZ0NBQWdDLDJCQUEyQixrQkFBa0IsT0FBTyxJQUFJLDRCQUE0QixHQUFHLFNBQVMsYUFBYSx5RUFBQyxrRUFBa0UsTUFBTSxRQUFRLDBCQUEwQixNQUFNLE1BQU0sc0JBQXNCLDZCQUE2QixFQUFFLDRCQUE0QixtQkFBbUIseUNBQXlDLE9BQU8sRUFBRSw0QkFBNEIsdUJBQXVCLEdBQUcsU0FBUyx1QkFBdUIsbUZBQUMsd0JBQXdCLHdGQUF3RixFQUFFLGdEQUFnRCw4REFBQyxtQkFBbUIsRUFBRSxtRkFBQyxxQkFBbUQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zeW52aWV3Ly4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvY29yZS9jb3JlL2FjY2Vzc29yU3VwcG9ydC9vcmlnaW5VdGlscy5qcyIsIndlYnBhY2s6Ly9zeW52aWV3Ly4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvY29yZS9jb3JlL211bHRpT3JpZ2luSlNPTlN1cHBvcnRVdGlscy5qcyIsIndlYnBhY2s6Ly9zeW52aWV3Ly4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvY29yZS9wb3J0YWwvc3VwcG9ydC9yZXNvdXJjZVV0aWxzLmpzIiwid2VicGFjazovL3N5bnZpZXcvLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9jb3JlL3dlYmRvYy9zYXZlQVBJS2V5VXRpbHMuanMiLCJ3ZWJwYWNrOi8vc3ludmlldy8uL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2NvcmUvd2ViZG9jL3N1cHBvcnQvc2F2ZVV0aWxzLmpzIiwid2VicGFjazovL3N5bnZpZXcvLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9jb3JlL3dlYmRvYy93ZWJkb2NTYXZlVXRpbHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLypcbkFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMjgvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuKi9cbmltcG9ydHtpc011bHRpT3JpZ2luSlNPTk1peGluIGFzIHJ9ZnJvbVwiLi4vbXVsdGlPcmlnaW5KU09OU3VwcG9ydFV0aWxzLmpzXCI7ZnVuY3Rpb24gaShpKXtpPy53cml0dGVuUHJvcGVydGllcyYmaS53cml0dGVuUHJvcGVydGllcy5mb3JFYWNoKCgoe3RhcmdldDppLHByb3BOYW1lOnQsbmV3T3JpZ2luOmV9KT0+e3IoaSkmJmUmJmkub3JpZ2luT2YodCkhPT1lJiZpLnVwZGF0ZU9yaWdpbih0LGUpfSkpfWV4cG9ydHtpIGFzIHVwZGF0ZU9yaWdpbnN9O1xuIiwiLypcbkFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMjgvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuKi9cbmZ1bmN0aW9uIGkoaSl7cmV0dXJuIGkmJlwiZ2V0QXRPcmlnaW5cImluIGkmJlwib3JpZ2luT2ZcImluIGl9ZXhwb3J0e2kgYXMgaXNNdWx0aU9yaWdpbkpTT05NaXhpbn07XG4iLCIvKlxuQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cblNlZSBodHRwczovL2pzLmFyY2dpcy5jb20vNC4yOC9lc3JpL2NvcHlyaWdodC50eHQgZm9yIGRldGFpbHMuXG4qL1xuaW1wb3J0IGUgZnJvbVwiLi4vLi4vcmVxdWVzdC5qc1wiO2ltcG9ydCB0IGZyb21cIi4uLy4uL2NvcmUvRXJyb3IuanNcIjtpbXBvcnR7am9pbiBhcyByLGdldFBhdGhFeHRlbnNpb24gYXMgYX1mcm9tXCIuLi8uLi9jb3JlL3VybFV0aWxzLmpzXCI7YXN5bmMgZnVuY3Rpb24gbyhlLHQ9e30sYSl7YXdhaXQgZS5sb2FkKGEpO2NvbnN0IG89cihlLml0ZW1VcmwsXCJyZXNvdXJjZXNcIikse3N0YXJ0OnM9MSxudW06bj0xMCxzb3J0T3JkZXI6bD1cImFzY1wiLHNvcnRGaWVsZDp1PVwiY3JlYXRlZFwifT10LGM9e3F1ZXJ5OntzdGFydDpzLG51bTpuLHNvcnRPcmRlcjpsLHNvcnRGaWVsZDp1LHRva2VuOmUuYXBpS2V5fSxzaWduYWw6YT8uc2lnbmFsfSxpPWF3YWl0IGUucG9ydGFsLnJlcXVlc3QobyxjKTtyZXR1cm57dG90YWw6aS50b3RhbCxuZXh0U3RhcnQ6aS5uZXh0U3RhcnQscmVzb3VyY2VzOmkucmVzb3VyY2VzLm1hcCgoKHtjcmVhdGVkOnQsc2l6ZTpyLHJlc291cmNlOmF9KT0+KHtjcmVhdGVkOm5ldyBEYXRlKHQpLHNpemU6cixyZXNvdXJjZTplLnJlc291cmNlRnJvbVBhdGgoYSl9KSkpfX1hc3luYyBmdW5jdGlvbiBzKGUsYSxvLHMpe2lmKCFlLmhhc1BhdGgoKSl0aHJvdyBuZXcgdChgcG9ydGFsLWl0ZW0tcmVzb3VyY2UtJHthfTppbnZhbGlkLXBhdGhgLFwiUmVzb3VyY2UgZG9lcyBub3QgaGF2ZSBhIHZhbGlkIHBhdGhcIik7Y29uc3Qgbj1lLnBvcnRhbEl0ZW07YXdhaXQgbi5sb2FkKHMpO2NvbnN0IGw9cihuLnVzZXJJdGVtVXJsLFwiYWRkXCI9PT1hP1wiYWRkUmVzb3VyY2VzXCI6XCJ1cGRhdGVSZXNvdXJjZXNcIiksW2MsaV09dShlLnBhdGgpLHA9bmV3IEZvcm1EYXRhO3JldHVybiBjJiZcIi5cIiE9PWMmJnAuYXBwZW5kKFwicmVzb3VyY2VzUHJlZml4XCIsYyksbnVsbCE9cyYmcy5jb21wcmVzcyYmcC5hcHBlbmQoXCJjb21wcmVzc1wiLFwidHJ1ZVwiKSxwLmFwcGVuZChcImZpbGVOYW1lXCIsaSkscC5hcHBlbmQoXCJmaWxlXCIsbyxpKSxwLmFwcGVuZChcImZcIixcImpzb25cIikscz8uYWNjZXNzJiZwLmFwcGVuZChcImFjY2Vzc1wiLHMuYWNjZXNzKSxhd2FpdCBuLnBvcnRhbC5yZXF1ZXN0KGwse21ldGhvZDpcInBvc3RcIixib2R5OnAsc2lnbmFsOnM/LnNpZ25hbH0pLGV9YXN5bmMgZnVuY3Rpb24gbihlLGEsbyl7aWYoIWEuaGFzUGF0aCgpKXRocm93IG5ldyB0KFwicG9ydGFsLWl0ZW0tcmVzb3VyY2VzLXJlbW92ZTppbnZhbGlkLXBhdGhcIixcIlJlc291cmNlIGRvZXMgbm90IGhhdmUgYSB2YWxpZCBwYXRoXCIpO2F3YWl0IGUubG9hZChvKTtjb25zdCBzPXIoZS51c2VySXRlbVVybCxcInJlbW92ZVJlc291cmNlc1wiKTthd2FpdCBlLnBvcnRhbC5yZXF1ZXN0KHMse21ldGhvZDpcInBvc3RcIixxdWVyeTp7cmVzb3VyY2U6YS5wYXRofSxzaWduYWw6bz8uc2lnbmFsfSksYS5wb3J0YWxJdGVtPW51bGx9YXN5bmMgZnVuY3Rpb24gbChlLHQpe2F3YWl0IGUubG9hZCh0KTtjb25zdCBhPXIoZS51c2VySXRlbVVybCxcInJlbW92ZVJlc291cmNlc1wiKTtyZXR1cm4gZS5wb3J0YWwucmVxdWVzdChhLHttZXRob2Q6XCJwb3N0XCIscXVlcnk6e2RlbGV0ZUFsbDohMH0sc2lnbmFsOnQ/LnNpZ25hbH0pfWZ1bmN0aW9uIHUoZSl7Y29uc3QgdD1lLmxhc3RJbmRleE9mKFwiL1wiKTtyZXR1cm4tMT09PXQ/W1wiLlwiLGVdOltlLnNsaWNlKDAsdCksZS5zbGljZSh0KzEpXX1mdW5jdGlvbiBjKGUpe2NvbnN0W3Qscl09aShlKSxbYSxvXT11KHQpO3JldHVyblthLG8scl19ZnVuY3Rpb24gaShlKXtjb25zdCB0PWEoZSk7cmV0dXJuIG51bGw9PXQ/W2UsXCJcIl06W2Uuc2xpY2UoMCxlLmxlbmd0aC10Lmxlbmd0aC0xKSxgLiR7dH1gXX1hc3luYyBmdW5jdGlvbiBwKHQpe2lmKFwiYmxvYlwiPT09dC50eXBlKXJldHVybiB0LmJsb2I7aWYoXCJqc29uXCI9PT10LnR5cGUpcmV0dXJuIG5ldyBCbG9iKFt0Lmpzb25TdHJpbmddLHt0eXBlOlwiYXBwbGljYXRpb24vanNvblwifSk7cmV0dXJuKGF3YWl0IGUodC51cmwse3Jlc3BvbnNlVHlwZTpcImJsb2JcIn0pKS5kYXRhfWZ1bmN0aW9uIGQoZSx0KXtpZighZS5oYXNQYXRoKCkpcmV0dXJuIG51bGw7Y29uc3RbYSwsb109YyhlLnBhdGgpO3JldHVybiBlLnBvcnRhbEl0ZW0ucmVzb3VyY2VGcm9tUGF0aChyKGEsdCtvKSl9ZnVuY3Rpb24gbShlLHQpe2lmKCFlLmhhc1BhdGgoKSlyZXR1cm4gbnVsbDtjb25zdFthLCxvXT1jKGUucGF0aCk7cmV0dXJuIGUucG9ydGFsSXRlbS5yZXNvdXJjZUZyb21QYXRoKHIoYSx0K28pKX1leHBvcnR7cyBhcyBhZGRPclVwZGF0ZVJlc291cmNlLHAgYXMgY29udGVudFRvQmxvYixvIGFzIGZldGNoUmVzb3VyY2VzLGQgYXMgZ2V0U2libGluZ09mU2FtZVR5cGUsbSBhcyBnZXRTaWJsaW5nT2ZTYW1lVHlwZUksbCBhcyByZW1vdmVBbGxSZXNvdXJjZXMsbiBhcyByZW1vdmVSZXNvdXJjZSxjIGFzIHNwbGl0UHJlZml4RmlsZU5hbWVBbmRFeHRlbnNpb259O1xuIiwiLypcbkFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMjgvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuKi9cbmltcG9ydCBvIGZyb21cIi4uL2NvbmZpZy5qc1wiO2ltcG9ydCByIGZyb21cIi4uL2NvcmUvRXJyb3IuanNcIjtpbXBvcnR7c3VwcG9ydHNBcGlLZXkgYXMgcH1mcm9tXCIuLi9zdXBwb3J0L2FwaUtleVV0aWxzLmpzXCI7ZnVuY3Rpb24gaShpKXtpZihvLmFwaUtleSYmcChpLnBvcnRhbC51cmwpKXRocm93IG5ldyByKFwic2F2ZS1hcGkta2V5LXV0aWxzOmFwaS1rZXktbm90LXN1cHBvcnRlZFwiLGBTYXZpbmcgaXMgbm90IHN1cHBvcnRlZCBvbiAke2kucG9ydGFsLnVybH0gd2hlbiB1c2luZyBhbiBhcGkga2V5YCl9ZXhwb3J0e2kgYXMgdmFsaWRhdGVTYXZlQVBJS2V5fTtcbiIsIi8qXG5BbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuU2VlIGh0dHBzOi8vanMuYXJjZ2lzLmNvbS80LjI4L2VzcmkvY29weXJpZ2h0LnR4dCBmb3IgZGV0YWlscy5cbiovXG5pbXBvcnR7cmVzdWx0IGFzIGV9ZnJvbVwiLi4vLi4vY29yZS9hc3luY1V0aWxzLmpzXCI7aW1wb3J0IHIgZnJvbVwiLi4vLi4vY29yZS9FcnJvci5qc1wiO2ltcG9ydHthbGxTZXR0bGVkRXJyb3JzIGFzIG8sdGhyb3dJZkFib3J0ZWQgYXMgdCxlYWNoQWx3YXlzIGFzIHN9ZnJvbVwiLi4vLi4vY29yZS9wcm9taXNlVXRpbHMuanNcIjtpbXBvcnR7Z2VuZXJhdGVVVUlEIGFzIGF9ZnJvbVwiLi4vLi4vY29yZS91dWlkLmpzXCI7aW1wb3J0e2dldFNpYmxpbmdPZlNhbWVUeXBlSSBhcyBjLGNvbnRlbnRUb0Jsb2IgYXMgbn1mcm9tXCIuLi8uLi9wb3J0YWwvc3VwcG9ydC9yZXNvdXJjZVV0aWxzLmpzXCI7YXN5bmMgZnVuY3Rpb24gdShlLHIsbz1udWxsKXtjb25zdCB0PWF3YWl0IGkoZSxyLG8pO2F3YWl0IGgodCxyLG8pfWFzeW5jIGZ1bmN0aW9uIHAoZSxyLG8sdCxzPW51bGwpe2NvbnN0IGE9YXdhaXQgaShvLHQscyk7YXdhaXQgZS51cGRhdGUoe2RhdGE6cn0pLGF3YWl0IGgoYSx0LHMpfWFzeW5jIGZ1bmN0aW9uIGkoZSxzLG49bnVsbCl7aWYoIXM/LnJlc291cmNlcylyZXR1cm47Y29uc3QgdT1zLnBvcnRhbEl0ZW09PT1lLnBvcnRhbEl0ZW0/bmV3IFNldChlLnBhdGhzKTpuZXcgU2V0O2UucGF0aHMubGVuZ3RoPTAsZS5wb3J0YWxJdGVtPXMucG9ydGFsSXRlbTtjb25zdCBwPW5ldyBTZXQocy5yZXNvdXJjZXMudG9LZWVwLm1hcCgoZT0+ZS5yZXNvdXJjZS5wYXRoKSkpLGk9bmV3IFNldCxoPVtdO3AuZm9yRWFjaCgocj0+e3UuZGVsZXRlKHIpLGUucGF0aHMucHVzaChyKX0pKTtmb3IoY29uc3QgciBvZiBzLnJlc291cmNlcy50b1VwZGF0ZSlpZih1LmRlbGV0ZShyLnJlc291cmNlLnBhdGgpLHAuaGFzKHIucmVzb3VyY2UucGF0aCl8fGkuaGFzKHIucmVzb3VyY2UucGF0aCkpe2NvbnN0e3Jlc291cmNlOm8sY29udGVudDp0LGZpbmlzaDpzLGVycm9yOnV9PXIscD1jKG8sYSgpKTtlLnBhdGhzLnB1c2gocC5wYXRoKSxoLnB1c2goZih7cmVzb3VyY2U6cCxjb250ZW50OnQsY29tcHJlc3M6ci5jb21wcmVzcyxmaW5pc2g6cyxlcnJvcjp1fSxuKSl9ZWxzZSBlLnBhdGhzLnB1c2goci5yZXNvdXJjZS5wYXRoKSxoLnB1c2gobChyLG4pKSxpLmFkZChyLnJlc291cmNlLnBhdGgpO2Zvcihjb25zdCByIG9mIHMucmVzb3VyY2VzLnRvQWRkKWUucGF0aHMucHVzaChyLnJlc291cmNlLnBhdGgpLHUuaGFzKHIucmVzb3VyY2UucGF0aCk/dS5kZWxldGUoci5yZXNvdXJjZS5wYXRoKTpoLnB1c2goZihyLG4pKTtpZigwPT09aC5sZW5ndGgpcmV0dXJuIHU7Y29uc3QgbT1hd2FpdCBvKGgpO2lmKHQobiksbS5sZW5ndGg+MCl0aHJvdyBuZXcgcihcInNhdmU6cmVzb3VyY2VzXCIsXCJGYWlsZWQgdG8gc2F2ZSBvbmUgb3IgbW9yZSByZXNvdXJjZXNcIix7ZXJyb3JzOm19KTtyZXR1cm4gdX1hc3luYyBmdW5jdGlvbiBoKGUscixvPW51bGwpe2lmKCFlfHwhci5wb3J0YWxJdGVtKXJldHVybjtjb25zdCB0PVtdO2Zvcihjb25zdCBzIG9mIGUpe2NvbnN0IGU9ci5wb3J0YWxJdGVtLnJlc291cmNlRnJvbVBhdGgocyk7dC5wdXNoKGUucG9ydGFsSXRlbS5yZW1vdmVSZXNvdXJjZShlLG8pKX1hd2FpdCBzKHQpfWFzeW5jIGZ1bmN0aW9uIGYocixvKXtjb25zdCB0PXsuLi5udWxsIT1vP286e30sY29tcHJlc3M6ci5jb21wcmVzc30scz1hd2FpdCBlKHIucmVzb3VyY2UucG9ydGFsSXRlbS5hZGRSZXNvdXJjZShyLnJlc291cmNlLGF3YWl0IG4oci5jb250ZW50KSx0KSk7aWYoITAhPT1zLm9rKXRocm93IHIuZXJyb3I/LihzLmVycm9yKSxzLmVycm9yO3IuZmluaXNoPy4oci5yZXNvdXJjZSl9YXN5bmMgZnVuY3Rpb24gbChyLG8pe2NvbnN0IHQ9YXdhaXQgZShyLnJlc291cmNlLnVwZGF0ZShhd2FpdCBuKHIuY29udGVudCksbykpO2lmKCEwIT09dC5vayl0aHJvdyByLmVycm9yPy4odC5lcnJvciksdC5lcnJvcjtyLmZpbmlzaD8uKHIucmVzb3VyY2UpfWFzeW5jIGZ1bmN0aW9uIG0oZSl7Y29uc3Qgcj1bXTtmb3IoY29uc3QgbyBvZiBlLmFsbExheWVycylpZihcImJlZm9yZVNhdmVcImluIG8mJlwiZnVuY3Rpb25cIj09dHlwZW9mIG8uYmVmb3JlU2F2ZSl7Y29uc3QgZT1vLmJlZm9yZVNhdmUoKTtlJiZyLnB1c2goZSl9YXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKHIpfWV4cG9ydHttIGFzIGJlZm9yZVNhdmUsdSBhcyBzYXZlUmVzb3VyY2VzLHAgYXMgdXBkYXRlSXRlbVdpdGhSZXNvdXJjZXN9O1xuIiwiLypcbkFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMjgvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuKi9cbmltcG9ydCBlIGZyb21cIi4uL2NvcmUvRXJyb3IuanNcIjtpbXBvcnR7TXVsdGlPcmlnaW5KU09OU3VwcG9ydCBhcyB0fWZyb21cIi4uL2NvcmUvTXVsdGlPcmlnaW5KU09OU3VwcG9ydC5qc1wiO2ltcG9ydHt3aGVuT25jZSBhcyByfWZyb21cIi4uL2NvcmUvcmVhY3RpdmVVdGlscy5qc1wiO2ltcG9ydHt1cmxUb09iamVjdCBhcyBvLGhhc1NhbWVDYW5vbmljYWxQb3J0YWwgYXMgYX1mcm9tXCIuLi9jb3JlL3VybFV0aWxzLmpzXCI7aW1wb3J0e3VwZGF0ZU9yaWdpbnMgYXMgaX1mcm9tXCIuLi9jb3JlL2FjY2Vzc29yU3VwcG9ydC9vcmlnaW5VdGlscy5qc1wiO2ltcG9ydCBuIGZyb21cIi4uL2dlb21ldHJ5L1NwYXRpYWxSZWZlcmVuY2UuanNcIjtpbXBvcnR7ZXF1YWxzIGFzIHN9ZnJvbVwiLi4vZ2VvbWV0cnkvc3VwcG9ydC9zcGF0aWFsUmVmZXJlbmNlVXRpbHMuanNcIjtpbXBvcnR7d2ViTWVyY2F0b3JUb0dlb2dyYXBoaWMgYXMgbH1mcm9tXCIuLi9nZW9tZXRyeS9zdXBwb3J0L3dlYk1lcmNhdG9yVXRpbHMuanNcIjtpbXBvcnR7aXNTZXJ2ZXJPclNlcnZpY2VzQUdPTFVybCBhcyBwfWZyb21cIi4uL2xheWVycy9zdXBwb3J0L2FyY2dpc0xheWVyVXJsLmpzXCI7aW1wb3J0e2lzTGF5ZXJXaXRoRmVhdHVyZUxheWVyU291cmNlIGFzIGMsaXNGZWF0dXJlQ29sbGVjdGlvbkxheWVyIGFzIHV9ZnJvbVwiLi4vbGF5ZXJzL3N1cHBvcnQvbGF5ZXJVdGlscy5qc1wiO2ltcG9ydCBtIGZyb21cIi4uL3BvcnRhbC9Qb3J0YWwuanNcIjtpbXBvcnQgZCBmcm9tXCIuLi9wb3J0YWwvUG9ydGFsSXRlbS5qc1wiO2ltcG9ydHtUeXBlS2V5d29yZCBhcyBmLHJlbW92ZVR5cGVLZXl3b3JkIGFzIHcsYWRkVHlwZUtleXdvcmQgYXMgeSxoYXNUeXBlS2V5d29yZCBhcyBnfWZyb21cIi4uL3BvcnRhbC9zdXBwb3J0L3BvcnRhbEl0ZW1VdGlscy5qc1wiO2ltcG9ydHtwcm9qZWN0IGFzIGh9ZnJvbVwiLi4vcmVzdC9nZW9tZXRyeVNlcnZpY2UvcHJvamVjdC5qc1wiO2ltcG9ydCBiIGZyb21cIi4uL3Jlc3Qvc3VwcG9ydC9Qcm9qZWN0UGFyYW1ldGVycy5qc1wiO2ltcG9ydHtoYXNEZXZlbG9wZXJCYXNlbWFwTGF5ZXIgYXMgXyxmaW5kU3BhdGlhbFJlZmVyZW5jZSBhcyB2LGlzRGV2ZWxvcGVyQmFzZW1hcExheWVyIGFzIFJ9ZnJvbVwiLi4vc3VwcG9ydC9iYXNlbWFwVXRpbHMuanNcIjtpbXBvcnR7dmFsaWRhdGVTYXZlQVBJS2V5IGFzIFV9ZnJvbVwiLi9zYXZlQVBJS2V5VXRpbHMuanNcIjtpbXBvcnR7YmVmb3JlU2F2ZSBhcyBQLHNhdmVSZXNvdXJjZXMgYXMgV31mcm9tXCIuL3N1cHBvcnQvc2F2ZVV0aWxzLmpzXCI7Y29uc3QgST1bXCJOYXRHZW9fV29ybGRfTWFwXCIsXCJPY2Vhbl9CYXNlbWFwXCIsXCJVU0FfVG9wb19NYXBzXCIsXCJXb3JsZF9JbWFnZXJ5XCIsXCJXb3JsZF9TdHJlZXRfTWFwXCIsXCJXb3JsZF9UZXJyYWluX0Jhc2VcIixcIldvcmxkX1RvcG9fTWFwXCIsXCJXb3JsZF9IaWxsc2hhZGVcIixcIkNhbnZhcy9Xb3JsZF9MaWdodF9HcmF5X0Jhc2VcIixcIkNhbnZhcy9Xb3JsZF9MaWdodF9HcmF5X1JlZmVyZW5jZVwiLFwiQ2FudmFzL1dvcmxkX0RhcmtfR3JheV9CYXNlXCIsXCJDYW52YXMvV29ybGRfRGFya19HcmF5X1JlZmVyZW5jZVwiLFwiT2NlYW4vV29ybGRfT2NlYW5fQmFzZVwiLFwiT2NlYW4vV29ybGRfT2NlYW5fUmVmZXJlbmNlXCIsXCJSZWZlcmVuY2UvV29ybGRfQm91bmRhcmllc19hbmRfUGxhY2VzXCIsXCJSZWZlcmVuY2UvV29ybGRfUmVmZXJlbmNlX092ZXJsYXlcIixcIlJlZmVyZW5jZS9Xb3JsZF9UcmFuc3BvcnRhdGlvblwiXS5tYXAoKGU9PmUudG9Mb3dlckNhc2UoKSkpO2FzeW5jIGZ1bmN0aW9uIGooZSx0LGEpe2E/Pz17fSxTKGUsdCksYXdhaXQgcigoKCk9PiF0LnVwZGF0aW5nRnJvbVZpZXcpKSxhd2FpdCB0LmxvYWQoKSxhd2FpdCBrKHQpLGF3YWl0IFAodCksYXdhaXQgVChlLHQpO2NvbnN0IGk9dC5wb3J0YWxJdGVtLG49byhpLml0ZW1VcmwpLHM9e29yaWdpbjpcIndlYi1tYXBcIixtZXNzYWdlczpbXSx3cml0dGVuUHJvcGVydGllczpbXSx1cmw6bixwb3J0YWw6aS5wb3J0YWx8fG0uZ2V0RGVmYXVsdCgpLHBvcnRhbEl0ZW06aSx2ZXJpZnlJdGVtUmVsYXRpdmVVcmxzOm4/e3Jvb3RQYXRoOm4ucGF0aCx3cml0dGVuVXJsczpbXX06bnVsbCxibG9ja2VkUmVsYXRpdmVVcmxzOltdLHJlc291cmNlczp7dG9BZGQ6W10sdG9VcGRhdGU6W10sdG9LZWVwOltdLHBlbmRpbmdPcGVyYXRpb25zOltdfX0sbD10LndyaXRlKHt9LHMpO3JldHVybiBhd2FpdCBQcm9taXNlLmFsbChzLnJlc291cmNlcy5wZW5kaW5nT3BlcmF0aW9ucyksRChlLHMsYSksYXdhaXQgRSh0LGkpLGF3YWl0IHVlKGUsdCxpLGwscyksYXdhaXQgUHJvbWlzZS5hbGwoW3QudXBkYXRlSXRlbVRodW1ibmFpbCgpLFcodC5yZXNvdXJjZVJlZmVyZW5jZXMscyxudWxsKV0pLGl9YXN5bmMgZnVuY3Rpb24gQShlLHQsbyxhKXthPz89e307Y29uc3QgaT1NKGUsbyk7YXdhaXQgcigoKCk9PiF0LnVwZGF0aW5nRnJvbVZpZXcpKSxhd2FpdCB0LmxvYWQoKSxhd2FpdCBrKHQpLGF3YWl0IFAodCksYXdhaXQgVChlLHQpO2NvbnN0IG49e29yaWdpbjpcIndlYi1tYXBcIixtZXNzYWdlczpbXSx3cml0dGVuUHJvcGVydGllczpbXSx1cmw6bnVsbCxwb3J0YWw6aS5wb3J0YWwscG9ydGFsSXRlbTppLGJsb2NrZWRSZWxhdGl2ZVVybHM6W10scmVzb3VyY2VzOnt0b0FkZDpbXSx0b1VwZGF0ZTpbXSx0b0tlZXA6W10scGVuZGluZ09wZXJhdGlvbnM6W119fSxzPXQud3JpdGUoe30sbik7YXdhaXQgUHJvbWlzZS5hbGwobi5yZXNvdXJjZXMucGVuZGluZ09wZXJhdGlvbnMpLEQoZSxuLGEpLGF3YWl0IHoodCxpKTtjb25zdCBsPXQuZ2V0VGh1bWJuYWlsU3RhdGUoKTtyZXR1cm4gYXdhaXQgbWUoZSx0LGkscyxuLGEpJiYodC5yZXNvdXJjZVJlZmVyZW5jZXMucG9ydGFsSXRlbT1pKSx0LnJlc3RvcmVUaHVtYm5haWxGcm9tU3RhdGUobCksYXdhaXQgUHJvbWlzZS5hbGwoW3QudXBkYXRlSXRlbVRodW1ibmFpbCgpLFcodC5yZXNvdXJjZVJlZmVyZW5jZXMsbixudWxsKV0pLGl9ZnVuY3Rpb24gUyh0LHIpe2lmKCFyLnBvcnRhbEl0ZW0pdGhyb3cgbmV3IGUoYCR7dC5uYW1lfTpwb3J0YWwtaXRlbS1ub3Qtc2V0YCxcIlBvcnRhbCBpdGVtIHRvIHNhdmUgdG8gaGFzIG5vdCBiZWVuIHNldCBvbiB0aGUgV2ViTWFwXCIpO1Uoci5wb3J0YWxJdGVtKSxPKHQsci5wb3J0YWxJdGVtKX1mdW5jdGlvbiBPKHQscil7aWYoci50eXBlIT09dC5pdGVtVHlwZSl0aHJvdyBuZXcgZShgJHt0Lm5hbWV9OnBvcnRhbC1pdGVtLXdyb25nLXR5cGVgLGBQb3J0YWwgaXRlbSBuZWVkcyB0byBoYXZlIHR5cGUgXCIke3QuaXRlbVR5cGV9XCJgKX1hc3luYyBmdW5jdGlvbiBUKHQsbyl7aWYoIW8uYmFzZW1hcD8uYmFzZUxheWVycy5sZW5ndGgpdGhyb3cgbmV3IGUoYCR7dC5uYW1lfTpzYXZlYCxcIk1hcCBkb2VzIG5vdCBoYXZlIGEgdmFsaWQgYmFzZW1hcCB3aXRoIGEgYmFzZSBsYXllci5cIik7bGV0IGE9bnVsbDtpZihhd2FpdCByKCgoKT0+e2NvbnN0IGU9dihvLmluaXRpYWxWaWV3UHJvcGVydGllcyxvLmJhc2VtYXApO3JldHVybiBhPWUuc3BhdGlhbFJlZmVyZW5jZSwhZS51cGRhdGluZ30pKSwhcyhhLG8uaW5pdGlhbFZpZXdQcm9wZXJ0aWVzLnNwYXRpYWxSZWZlcmVuY2UpKXRocm93IG5ldyBlKGAke3QubmFtZX06c2F2ZWAsXCJUaGUgc3BhdGlhbCByZWZlcmVuY2Ugb2YgdGhlIGJhc2VtYXAgaXMgbm90IGNvbXBhdGlibGUgd2l0aCB0aGUgb25lIGZyb20gdGhlIG1hcC5cIix7ZXhwZWN0ZWQ6by5pbml0aWFsVmlld1Byb3BlcnRpZXMuc3BhdGlhbFJlZmVyZW5jZSxhY3R1YWw6YX0pfWZ1bmN0aW9uIE0oZSx0KXtsZXQgcj1kLmZyb20odCk7cmV0dXJuIHIuaWQmJihyPXIuY2xvbmUoKSxyLmlkPW51bGwpLHIudHlwZXx8KHIudHlwZT1lLml0ZW1UeXBlKSxyLnBvcnRhbHx8KHIucG9ydGFsPW0uZ2V0RGVmYXVsdCgpKSxVKHIpLE8oZSxyKSxyfWZ1bmN0aW9uIGsoZSl7Y29uc3QgdD1bXTtyZXR1cm4gZS5iYXNlbWFwJiZ0LnB1c2goZS5iYXNlbWFwLmxvYWQoKSksZS5ncm91bmQmJnQucHVzaChlLmdyb3VuZC5sb2FkKCkpLFByb21pc2UuYWxsU2V0dGxlZCh0KS50aGVuKCgoKT0+e30pKX1mdW5jdGlvbiBEKHQscixvKXtsZXQgYT0oci5tZXNzYWdlcz8/W10pLmZpbHRlcigoZT0+XCJlcnJvclwiPT09ZS50eXBlKSkubWFwKCh0PT5uZXcgZSh0Lm5hbWUsdC5tZXNzYWdlLHQuZGV0YWlscykpKTtpZihyLmJsb2NrZWRSZWxhdGl2ZVVybHMmJihhPWEuY29uY2F0KHIuYmxvY2tlZFJlbGF0aXZlVXJscy5tYXAoKHQ9Pm5ldyBlKFwidXJsOnVuc3VwcG9ydGVkXCIsYFJlbGF0aXZlIHVybCAnJHt0fScgaXMgbm90IHN1cHBvcnRlZCBpbiBXZWIgTWFwYCkpKSkpLG8uaWdub3JlVW5zdXBwb3J0ZWQmJihhPWEuZmlsdGVyKChlPT5cImxheWVyOnVuc3VwcG9ydGVkXCIhPT1lLm5hbWUmJlwic3ltYm9sOnVuc3VwcG9ydGVkXCIhPT1lLm5hbWUmJlwic3ltYm9sLWxheWVyOnVuc3VwcG9ydGVkXCIhPT1lLm5hbWUmJlwicHJvcGVydHk6dW5zdXBwb3J0ZWRcIiE9PWUubmFtZSYmXCJ1cmw6dW5zdXBwb3J0ZWRcIiE9PWUubmFtZSkpKSxhLmxlbmd0aD4wKXRocm93IG5ldyBlKGAke3QubmFtZX06c2F2ZWAsXCJGYWlsZWQgdG8gc2F2ZSB3ZWJtYXAgZHVlIHRvIHVuc3VwcG9ydGVkIG9yIGludmFsaWQgY29udGVudC4gU2VlICdkZXRhaWxzLmVycm9ycycgZm9yIG1vcmUgZGV0YWlsZWQgaW5mb3JtYXRpb25cIix7ZXJyb3JzOmF9KX1hc3luYyBmdW5jdGlvbiBFKGUsdCl7dC5leHRlbnQ9YXdhaXQgbmUoZS5wb3J0YWxJdGVtLGUuaW5pdGlhbFZpZXdQcm9wZXJ0aWVzLnZpZXdwb2ludC50YXJnZXRHZW9tZXRyeSksYXdhaXQgUShlLHQpfWNvbnN0IFY9Zi5KU0FQSSxDPVwiQ29sbGVjdG9yRGlzYWJsZWRcIixHPVwiQ29sbGVjdG9yXCIsTD1cIkRhdGEgRWRpdGluZ1wiLCQ9XCJPZmZsaW5lRGlzYWJsZWRcIixCPVwiT2ZmbGluZVwiLEs9XCJXb3JrZm9yY2UgUHJvamVjdFwiLHg9XCJXb3JrZm9yY2UgV29ya2VyXCIsRj1cIldvcmtmb3JjZSBEaXNwYXRjaGVyXCIsTj1cIk9mZmxpbmUgTWFwIEFyZWFzXCIsSD1cIkZpZWxkTWFwc0Rpc2FibGVkXCIsSj1mLkRFVkVMT1BFUl9CQVNFTUFQLHE9XCJVdGlsaXR5TmV0d29ya1wiO2FzeW5jIGZ1bmN0aW9uIHooZSx0KXt3KHQsQyksdyh0LEgpLHcodCxmLk1FVEFEQVRBKSx3KHQsJCksdyh0LE4pLHcodCxGKSx3KHQsSyksdyh0LHgpLGF3YWl0IEUoZSx0KX1hc3luYyBmdW5jdGlvbiBRKGUsdCl7eSh0LFYpLGF3YWl0IFgoZSksdGUoZSx0KSxyZShlLHQpLG9lKGUsdCksYWUoZSx0KSxpZShlLHQpLHQudHlwZUtleXdvcmRzJiYodC50eXBlS2V5d29yZHM9dC50eXBlS2V5d29yZHMuZmlsdGVyKCgoZSx0LHIpPT5yLmluZGV4T2YoZSk9PT10KSkpfWZ1bmN0aW9uIFgoZSl7Y29uc3QgdD1ZKGUpLm1hcCgoZT0+ZS5sb2FkKCkpKS50b0FycmF5KCk7cmV0dXJuIFByb21pc2UuYWxsU2V0dGxlZCh0KS50aGVuKCgoKT0+e30pKX1mdW5jdGlvbiBZKGUpe3JldHVybiBlLmFsbExheWVycy5jb25jYXQoZS5hbGxUYWJsZXMpfWZ1bmN0aW9uIFooZSl7cmV0dXJuIFkoZSkuc29tZSgoZT0+ZS5sb2FkZWQmJmMoZSkmJmUuY2FwYWJpbGl0aWVzLm9wZXJhdGlvbnMuc3VwcG9ydHNFZGl0aW5nJiZlLmVkaXRpbmdFbmFibGVkJiYoXCJzdWJ0eXBlLWdyb3VwXCIhPT1lLnR5cGV8fGUuc3VibGF5ZXJzLnNvbWUoKGU9PmUuZWRpdGluZ0VuYWJsZWQpKSkpKX1mdW5jdGlvbiBlZShlKXtyZXR1cm4gWShlKS5maWx0ZXIoKGU9PlwiZ3JvdXBcIiE9PWUudHlwZSkpLmV2ZXJ5KCh0PT50LmxvYWRlZCYmcGUoZSx0KSkpfWZ1bmN0aW9uIHRlKGUsdCl7Zyh0LEMpfHxnKHQsSyl8fGcodCx4KXx8Zyh0LEYpfHwhWihlKT93KHQsRyk6eSh0LEcpfWZ1bmN0aW9uIHJlKGUsdCl7WihlKT95KHQsTCk6dyh0LEwpfWZ1bmN0aW9uIG9lKGUsdCl7IWcodCwkKSYmZWUoZSk/eSh0LEIpOncodCxCKX1mdW5jdGlvbiBhZShlLHQpe18oZS5iYXNlbWFwKT95KHQsSik6dyh0LEopfWZ1bmN0aW9uIGllKGUsdCl7ZS51dGlsaXR5TmV0d29ya3M/Lmxlbmd0aD95KHQscSk6dyh0LHEpfWFzeW5jIGZ1bmN0aW9uIG5lKGUsdCl7Y29uc3Qgcj10LmNsb25lKCkubm9ybWFsaXplKCk7bGV0IG87aWYoci5sZW5ndGg+MSlmb3IoY29uc3QgYSBvZiByKW8/YS53aWR0aD5vLndpZHRoJiYobz1hKTpvPWE7ZWxzZSBvPXJbMF07cmV0dXJuIHNlKGUsbyl9YXN5bmMgZnVuY3Rpb24gc2UoZSx0KXtjb25zdCByPXQuc3BhdGlhbFJlZmVyZW5jZTtpZihyLmlzV0dTODQpcmV0dXJuIHQuY2xvbmUoKTtpZihyLmlzV2ViTWVyY2F0b3IpcmV0dXJuIGwodCk7Y29uc3R7Z2V0R2VvbWV0cnlTZXJ2aWNlVVJMOm99PWF3YWl0IGltcG9ydChcIi4uL3BvcnRhbC9zdXBwb3J0L2dlb21ldHJ5U2VydmljZVV0aWxzLmpzXCIpLGE9YXdhaXQgbyhlKSxpPW5ldyBiO2kuZ2VvbWV0cmllcz1bdF0saS5vdXRTcGF0aWFsUmVmZXJlbmNlPW4uV0dTODQ7cmV0dXJuKGF3YWl0IGgoYSxpKSlbMF19ZnVuY3Rpb24gbGUoZSl7cmV0dXJuIHUoZSl8fFwibWFwLW5vdGVzXCI9PT1lLnR5cGV8fFwicm91dGVcIj09PWUudHlwZX1mdW5jdGlvbiBwZShlLHQpe3JldHVybiBjKHQpJiZ0LmNhcGFiaWxpdGllcy5vcGVyYXRpb25zLnN1cHBvcnRzU3luY3x8bGUodCkmJiF0LnBvcnRhbEl0ZW18fChcInRpbGVcIj09PXQudHlwZXx8XCJ2ZWN0b3ItdGlsZVwiPT09dC50eXBlKSYmKHQuY2FwYWJpbGl0aWVzLm9wZXJhdGlvbnMuc3VwcG9ydHNFeHBvcnRUaWxlc3x8Y2UodCl8fFIodCkpJiZ0LnNwYXRpYWxSZWZlcmVuY2UuZXF1YWxzKGUuaW5pdGlhbFZpZXdQcm9wZXJ0aWVzLnNwYXRpYWxSZWZlcmVuY2UpfWZ1bmN0aW9uIGNlKGUpe3JldHVyblwidGlsZVwiPT09ZS50eXBlJiYocChlLnVybCkmJkkuc29tZSgodD0+ZS51cmw/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCIvXCIrdCtcIi9cIikpKSl9YXN5bmMgZnVuY3Rpb24gdWUoZSx0LHIsbyxhKXthd2FpdCByLnVwZGF0ZSh7ZGF0YTpvfSksd2UoZSx0LHIsbyxhKX1hc3luYyBmdW5jdGlvbiBtZSh0LHIsbyxhLGksbil7Y29uc3Qgcz1yLnBvcnRhbEl0ZW0sbD17aXRlbTpzLGF1dGhlbnRpY2F0ZWQ6ISghcz8uaWR8fCFzLnBvcnRhbC51c2VyKX0scD1vLnBvcnRhbDthd2FpdCBwLnNpZ25JbigpO2NvbnN0e2NvcHlBbGxvd2VkOmMsaXRlbVJlbG9hZGVkOnV9PWF3YWl0IGRlKGwscCk7aWYobC5hdXRoZW50aWNhdGVkfHw9dSwhYyl0aHJvdyBuZXcgZShgJHt0Lm5hbWV9OnNhdmUtYXMtY29weS1ub3QtYWxsb3dlZGAsXCJPd25lciBvZiB0aGlzIG1hcCBkb2VzIG5vdCBhbGxvdyBvdGhlcnMgdG8gc2F2ZSBhIGNvcHlcIik7Y29uc3QgbT1hd2FpdCBmZShvLGwsYSxuKTtyZXR1cm4gci5wb3J0YWxJdGVtPW8sd2UodCxyLG8sYSxpKSxtfWFzeW5jIGZ1bmN0aW9uIGRlKGUsdCl7Y29uc3R7aXRlbTpyLGF1dGhlbnRpY2F0ZWQ6b309ZTtyZXR1cm4gcj8uaWQmJnIudHlwZUtleXdvcmRzPy5pbmNsdWRlcyhcInVzZU9ubHlcIik/ci5wb3J0YWwucG9ydGFsSG9zdG5hbWUhPT10LnBvcnRhbEhvc3RuYW1lP3tjb3B5QWxsb3dlZDohMSxpdGVtUmVsb2FkZWQ6ITF9OihvfHxhd2FpdCByLnJlbG9hZCgpLHtjb3B5QWxsb3dlZDpcImFkbWluXCI9PT1yLml0ZW1Db250cm9sfHxcInVwZGF0ZVwiPT09ci5pdGVtQ29udHJvbCxpdGVtUmVsb2FkZWQ6ITB9KTp7Y29weUFsbG93ZWQ6ITAsaXRlbVJlbG9hZGVkOiExfX1hc3luYyBmdW5jdGlvbiBmZShlLHQscixvKXtjb25zdCBpPWUucG9ydGFsLHtpdGVtOm59PXQse2ZvbGRlcjpzLGNvcHlBbGxSZXNvdXJjZXM6bH09bztsZXQgcD0hMTtpZihsJiZuPy5pZCYmYShuLnBvcnRhbC51cmwsaS51cmwpJiZwYXJzZUludChuLnBvcnRhbC5jdXJyZW50VmVyc2lvbiwxMCk+PTIwMjMpe2NvbnN0e3RvdGFsOmV9PWF3YWl0IG4uZmV0Y2hSZXNvdXJjZXMoKTtwPSEhZX1pZihwKXtjb25zdCB0PWF3YWl0IG4uY29weSh7Y29weVJlc291cmNlczpcImFsbFwiLGZvbGRlcjpzfSk7ZS5pZD10LmlkLGUucG9ydGFsPXQucG9ydGFsO2NvbnN0IG89ZS50b0pTT04oKTthd2FpdCBlLmxvYWQoKSxlLnJlYWQobyksYXdhaXQgZS51cGRhdGUoe2RhdGE6cn0pfWVsc2UgYXdhaXQoaS51c2VyPy5hZGRJdGVtKHtpdGVtOmUsZm9sZGVyOnMsZGF0YTpyfSkpO3JldHVybiBwfWZ1bmN0aW9uIHdlKGUscixhLG4scyl7dC5wcm90b3R5cGUucmVhZC5jYWxsKHIse3ZlcnNpb246bi52ZXJzaW9uLGF1dGhvcmluZ0FwcDpuLmF1dGhvcmluZ0FwcCxhdXRob3JpbmdBcHBWZXJzaW9uOm4uYXV0aG9yaW5nQXBwVmVyc2lvbn0se29yaWdpbjplLm9yaWdpbixpZ25vcmVEZWZhdWx0czohMCx1cmw6YS5pdGVtVXJsP28oYS5pdGVtVXJsKTp2b2lkIDB9KSxpKHMpLHIucmVzb3VyY2VJbmZvPW59ZXhwb3J0e2ogYXMgc2F2ZSxBIGFzIHNhdmVBc307XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=